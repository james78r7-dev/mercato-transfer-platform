<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒØ§Ù…Ù„ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%);
            color: #f8fafc;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ffd700, #ffed4e, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .test-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .test-card {
            background: rgba(16, 185, 129, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .test-result {
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            font-weight: 600;
        }

        .success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
            color: #10b981;
        }

        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #ef4444;
        }

        .warning {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.5);
            color: #f59e0b;
        }

        .info {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.5);
            color: #3b82f6;
        }

        .btn {
            background: linear-gradient(45deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .logo-preview {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(255, 215, 0, 0.3);
            margin-left: 1rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table th {
            background: rgba(255, 215, 0, 0.1);
            font-weight: 700;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 0.5rem;
        }

        .status-success { background: #10b981; }
        .status-error { background: #ef4444; }
        .status-warning { background: #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒØ§Ù…Ù„ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª</h1>
            <p>ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„ØªÙƒØ§Ù…Ù„ Ø¨ÙŠÙ† transfermarkt-top-spenders-2025.html Ùˆ transfermarkt-live-display.html</p>
        </div>

        <div class="test-section">
            <h2 class="section-title">
                <i class="fas fa-database"></i>
                ÙØ­Øµ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>localStorage Keys</h3>
                    <div id="storageKeysResults"></div>
                </div>
                <div class="test-card">
                    <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                    <div id="dataStatsResults"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">
                <i class="fas fa-images"></i>
                Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª
            </h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                    <div id="logoTestResults"></div>
                </div>
                <div class="test-card">
                    <h3>Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø©</h3>
                    <div id="systemComparisonResults"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">
                <i class="fas fa-sync-alt"></i>
                Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ²Ø§Ù…Ù†
            </h2>
            <div id="syncTestResults"></div>
        </div>

        <div class="test-section">
            <h2 class="section-title">
                <i class="fas fa-tools"></i>
                Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
            </h2>
            <button class="btn" onclick="runFullTest()">
                <i class="fas fa-play"></i> ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„
            </button>
            <button class="btn" onclick="testSpecificClub()">
                <i class="fas fa-search"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¯ÙŠ Ù…Ø­Ø¯Ø¯
            </button>
            <button class="btn" onclick="simulateDataUpdate()">
                <i class="fas fa-refresh"></i> Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <button class="btn" onclick="exportTestResults()">
                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            </button>
        </div>

        <div class="test-section">
            <h2 class="section-title">
                <i class="fas fa-chart-bar"></i>
                ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
            </h2>
            <div id="detailedReport"></div>
        </div>
    </div>

    <script>
        // Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        const testClubs = [
            'Liverpool FC',
            'Chelsea FC', 
            'Manchester United',
            'Manchester City',
            'Arsenal FC',
            'Real Madrid',
            'FC Barcelona',
            'Bayern Munich',
            'Juventus FC',
            'Paris Saint-Germain'
        ];

        // Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        let testResults = {
            storageKeys: {},
            dataStats: {},
            logoTests: {},
            systemComparison: {},
            syncTests: {},
            timestamp: new Date().toISOString()
        };

        // ÙØ­Øµ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function checkDataSources() {
            const sources = ['clubManagerData', 'clubsData', 'verifiedClubs'];
            const results = {};

            sources.forEach(key => {
                const data = localStorage.getItem(key);
                if (data) {
                    try {
                        const parsed = JSON.parse(data);
                        results[key] = {
                            exists: true,
                            count: parsed.length,
                            hasLogos: parsed.filter(club => club.logo || club.logoUrl).length,
                            status: 'success'
                        };
                    } catch (error) {
                        results[key] = {
                            exists: true,
                            error: error.message,
                            status: 'error'
                        };
                    }
                } else {
                    results[key] = {
                        exists: false,
                        status: 'warning'
                    };
                }
            });

            testResults.storageKeys = results;
            displayStorageResults(results);
        }

        // Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ®Ø²ÙŠÙ†
        function displayStorageResults(results) {
            const container = document.getElementById('storageKeysResults');
            let html = '';

            Object.entries(results).forEach(([key, result]) => {
                const statusClass = result.status;
                const statusIcon = result.status === 'success' ? 'âœ…' : 
                                 result.status === 'error' ? 'âŒ' : 'âš ï¸';
                
                html += `
                    <div class="test-result ${statusClass}">
                        ${statusIcon} ${key}: 
                        ${result.exists ? 
                            (result.count ? `${result.count} Ø¹Ù†ØµØ± (${result.hasLogos || 0} Ø´Ø¹Ø§Ø±)` : 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª') : 
                            'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'
                        }
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª
        function testLogos() {
            const results = {};

            testClubs.forEach(clubName => {
                // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¸Ø§Ù… transfermarkt-top-spenders
                const topSpendersLogo = getLogoFromTopSpenders(clubName);
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¸Ø§Ù… transfermarkt-live-display  
                const liveDisplayLogo = getLogoFromLiveDisplay(clubName);

                results[clubName] = {
                    topSpenders: topSpendersLogo,
                    liveDisplay: liveDisplayLogo,
                    match: topSpendersLogo === liveDisplayLogo,
                    status: topSpendersLogo === liveDisplayLogo ? 'success' : 'warning'
                };
            });

            testResults.logoTests = results;
            displayLogoResults(results);
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø± Ù…Ù† Ù†Ø¸Ø§Ù… top-spenders
        function getLogoFromTopSpenders(clubName) {
            // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¸Ø§Ù… ClubLogoManager
            const sources = ['clubManagerData', 'clubsData', 'verifiedClubs'];
            
            for (const sourceKey of sources) {
                const data = localStorage.getItem(sourceKey);
                if (data) {
                    try {
                        const clubs = JSON.parse(data);
                        const club = clubs.find(c => 
                            c.englishName === clubName || 
                            c.arabicName === clubName ||
                            (c.englishName && c.englishName.replace(' FC', '') === clubName.replace(' FC', ''))
                        );
                        if (club && (club.logo || club.logoUrl)) {
                            return club.logo || club.logoUrl;
                        }
                    } catch (error) {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ ${sourceKey}:`, error);
                    }
                }
            }
            return null;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø± Ù…Ù† Ù†Ø¸Ø§Ù… live-display
        function getLogoFromLiveDisplay(clubName) {
            return getLogoFromTopSpenders(clubName); // Ù†ÙØ³ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù†
        }

        // Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª
        function displayLogoResults(results) {
            const container = document.getElementById('logoTestResults');
            let html = '<table class="data-table"><thead><tr><th>Ø§Ù„Ù†Ø§Ø¯ÙŠ</th><th>Ø§Ù„ØªØ·Ø§Ø¨Ù‚</th><th>Ø§Ù„Ø´Ø¹Ø§Ø±</th></tr></thead><tbody>';

            Object.entries(results).forEach(([clubName, result]) => {
                const statusIcon = result.match ? 'âœ…' : 'âš ï¸';
                const logoUrl = result.topSpenders || result.liveDisplay || 'https://via.placeholder.com/50x50/1a1a2e/ffd700?text=' + clubName.charAt(0);
                
                html += `
                    <tr>
                        <td>${clubName}</td>
                        <td>${statusIcon} ${result.match ? 'Ù…ØªØ·Ø§Ø¨Ù‚' : 'ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚'}</td>
                        <td><img src="${logoUrl}" class="logo-preview" onerror="this.src='https://via.placeholder.com/50x50/1a1a2e/ffd700?text=${clubName.charAt(0)}'"></td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„
        function runFullTest() {
            console.log('ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„...');
            
            checkDataSources();
            testLogos();
            generateDetailedReport();
            
            console.log('âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„');
        }

        // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
        function generateDetailedReport() {
            const container = document.getElementById('detailedReport');
            const totalClubs = testClubs.length;
            const matchingLogos = Object.values(testResults.logoTests).filter(r => r.match).length;
            const successRate = ((matchingLogos / totalClubs) * 100).toFixed(1);

            const html = `
                <div class="test-result info">
                    ğŸ“Š <strong>Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</strong><br>
                    â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø©: ${totalClubs}<br>
                    â€¢ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ·Ø§Ø¨Ù‚Ø©: ${matchingLogos}<br>
                    â€¢ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%<br>
                    â€¢ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©: ${Object.values(testResults.storageKeys).filter(r => r.exists).length}/3<br>
                    â€¢ ÙˆÙ‚Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${new Date().toLocaleString('ar-SA')}
                </div>
            `;

            container.innerHTML = html;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¯ÙŠ Ù…Ø­Ø¯Ø¯
        function testSpecificClub() {
            const clubName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:');
            if (clubName) {
                const topSpendersLogo = getLogoFromTopSpenders(clubName);
                const liveDisplayLogo = getLogoFromLiveDisplay(clubName);
                
                alert(`
Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± ${clubName}:
â€¢ Ù†Ø¸Ø§Ù… Top Spenders: ${topSpendersLogo || 'Ù„Ù… ÙŠÙˆØ¬Ø¯'}
â€¢ Ù†Ø¸Ø§Ù… Live Display: ${liveDisplayLogo || 'Ù„Ù… ÙŠÙˆØ¬Ø¯'}
â€¢ Ø§Ù„ØªØ·Ø§Ø¨Ù‚: ${topSpendersLogo === liveDisplayLogo ? 'Ù†Ø¹Ù… âœ…' : 'Ù„Ø§ âš ï¸'}
                `);
            }
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function simulateDataUpdate() {
            const testData = [{
                id: Date.now(),
                englishName: 'Test Club FC',
                arabicName: 'Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
                logo: 'https://via.placeholder.com/100x100/10b981/ffffff?text=TEST',
                league: 'Test League'
            }];

            localStorage.setItem('clubManagerData', JSON.stringify(testData));
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø­Ø¯Ø« ØªØ­Ø¯ÙŠØ«
            window.dispatchEvent(new StorageEvent('storage', {
                key: 'clubManagerData',
                newValue: JSON.stringify(testData)
            }));

            alert('ØªÙ… Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª! ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬.');
            runFullTest();
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function exportTestResults() {
            const results = {
                ...testResults,
                summary: {
                    totalClubs: testClubs.length,
                    matchingLogos: Object.values(testResults.logoTests).filter(r => r.match).length,
                    availableSources: Object.values(testResults.storageKeys).filter(r => r.exists).length
                }
            };

            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `logo-integration-test-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ§ª ØªÙ‡ÙŠØ¦Ø© Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª...');
            runFullTest();
        });
    </script>
</body>
</html>
