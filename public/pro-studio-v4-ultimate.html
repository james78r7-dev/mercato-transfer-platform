<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒŸ Ultimate Studio V4 - World-Class Creative Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800;900&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        :root {
            /* Ultimate Color Palette */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --cosmic-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --holographic-gradient: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5, #ffbe0b, #fb5607);
            
            /* Advanced Colors */
            --dark-space: #0a0a0f;
            --deep-purple: #1a0b2e;
            --electric-blue: #00d4ff;
            --neon-green: #39ff14;
            --cyber-pink: #ff0080;
            --quantum-gold: #ffd700;
            --plasma-orange: #ff4500;
            
            /* Glass Morphism */
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.12);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            
            /* Typography */
            --font-primary: 'Cairo', sans-serif;
            --font-tech: 'Orbitron', monospace;
            
            /* Shadows */
            --shadow-glow: 0 0 20px rgba(102, 126, 234, 0.4);
            --shadow-intense: 0 20px 60px rgba(0, 0, 0, 0.5);
            --shadow-neon: 0 0 30px currentColor;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--dark-space);
            font-family: var(--font-primary);
            color: white;
            overflow: hidden;
            position: relative;
            min-height: 100vh;
        }

        /* Ultimate Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(102, 126, 234, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(240, 147, 251, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 60% 70%, rgba(57, 255, 20, 0.08) 0%, transparent 50%);
            animation: cosmicFlow 20s ease-in-out infinite;
            z-index: -2;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            animation: gridMove 30s linear infinite;
            z-index: -1;
        }

        @keyframes cosmicFlow {
            0%, 100% { 
                transform: translateX(0) translateY(0) rotate(0deg) scale(1);
                filter: hue-rotate(0deg);
            }
            25% { 
                transform: translateX(-20px) translateY(-10px) rotate(90deg) scale(1.1);
                filter: hue-rotate(90deg);
            }
            50% { 
                transform: translateX(20px) translateY(10px) rotate(180deg) scale(0.9);
                filter: hue-rotate(180deg);
            }
            75% { 
                transform: translateX(-10px) translateY(20px) rotate(270deg) scale(1.05);
                filter: hue-rotate(270deg);
            }
        }

        @keyframes gridMove {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(10px) translateY(10px); }
        }

        /* Ultimate Container Layout */
        .ultimate-container {
            display: grid;
            grid-template-columns: 1fr 500px;
            height: 100vh;
            gap: 0;
            position: relative;
        }

        /* Cosmic Preview Section */
        .cosmic-preview {
            background: linear-gradient(135deg, var(--deep-purple), var(--dark-space));
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .cosmic-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--holographic-gradient);
            opacity: 0.05;
            animation: holographicShift 15s ease-in-out infinite;
        }

        @keyframes holographicShift {
            0%, 100% { transform: translateX(-100%) skewX(-15deg); }
            50% { transform: translateX(100%) skewX(15deg); }
        }

        /* Ultimate Header */
        .ultimate-header {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--glass-border);
            padding: 25px 35px;
            position: relative;
            z-index: 10;
            overflow: hidden;
        }

        .ultimate-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: headerShimmer 3s infinite;
        }

        @keyframes headerShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .ultimate-header h1 {
            background: var(--holographic-gradient);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: holographicText 4s ease-in-out infinite;
            font-weight: 900;
            font-size: 2.2rem;
            margin: 0;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }

        @keyframes holographicText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* ðŸŽ¬ Overlay Integration Styles */
        .overlay-status-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .overlay-connection-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .overlay-status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff4444;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.3);
        }

        .overlay-status-indicator.connected {
            background: #44ff44;
            box-shadow: 0 0 15px rgba(68, 255, 68, 0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .url-display-container {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .url-input, .token-input {
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .url-copy-btn {
            background: var(--electric-blue);
            border: none;
            border-radius: 8px;
            padding: 10px 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .url-copy-btn:hover {
            background: var(--neon-cyan);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.3);
        }

        .overlay-control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .overlay-quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .ultimate-btn-small {
            padding: 8px 16px;
            font-size: 0.85rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .ultimate-checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .ultimate-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--electric-blue);
        }

        /* ðŸŽ¬ Enhanced Streaming System Styles */
        .simple-stream-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .simple-stream-status:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.06));
            border-color: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }

        .stream-info-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stream-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6b7280, #4b5563);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px rgba(107, 114, 128, 0.4);
            position: relative;
        }

        .stream-indicator::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 50%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: indicatorShimmer 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stream-indicator.live {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow:
                0 0 20px rgba(239, 68, 68, 0.8),
                0 0 40px rgba(239, 68, 68, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            animation: simpleLivePulse 1.5s infinite;
        }

        .stream-indicator.live::before {
            opacity: 1;
        }

        @keyframes simpleLivePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow:
                    0 0 20px rgba(239, 68, 68, 0.8),
                    0 0 40px rgba(239, 68, 68, 0.4);
            }
            50% {
                transform: scale(1.3);
                box-shadow:
                    0 0 30px rgba(239, 68, 68, 1),
                    0 0 60px rgba(239, 68, 68, 0.6),
                    0 0 80px rgba(239, 68, 68, 0.3);
            }
        }

        @keyframes indicatorShimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ðŸŽ¬ Integrated Streaming System Styles */
        .streaming-status-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .streaming-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .streaming-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff4444;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.3);
        }

        .streaming-indicator.live {
            background: #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
            animation: livePulse 1.5s infinite;
        }

        @keyframes livePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
            }
            50% {
                transform: scale(1.2);
                box-shadow: 0 0 25px rgba(255, 0, 0, 0.8), 0 0 35px rgba(255, 0, 0, 0.4);
            }
        }

        .stream-control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .stream-quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-secondary-ultimate {
            background: var(--glass-bg);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary-ultimate:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Stream Overlay Container */
        .stream-overlay-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 10000;
            display: none;
            overflow: hidden;
        }

        .stream-overlay-container.active {
            display: block;
        }

        .stream-content {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stream-player-card {
            position: absolute;
            bottom: 100px;
            right: 100px;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            opacity: 0;
            z-index: 10;
        }

        .stream-player-card.visible {
            transform: scale(1);
            opacity: 1;
        }

        .stream-lower-third {
            position: absolute;
            bottom: 50px;
            left: 50px;
            background: linear-gradient(135deg, rgba(0, 102, 255, 0.95), rgba(0, 153, 255, 0.95));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 20px 30px;
            color: white;
            transform: translateX(-100%);
            transition: transform 0.5s ease;
            max-width: 500px;
            z-index: 10;
        }

        .stream-lower-third.visible {
            transform: translateX(0);
        }

        .stream-lower-third h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .stream-lower-third p {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .stream-ticker {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(90deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.8));
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            overflow: hidden;
            transform: translateY(-100%);
            transition: transform 0.5s ease;
            z-index: 10;
        }

        .stream-ticker.visible {
            transform: translateY(0);
        }

        .ticker-content {
            white-space: nowrap;
            animation: tickerScroll 30s linear infinite;
            color: white;
            font-size: 18px;
            font-weight: 600;
            padding: 0 20px;
        }

        @keyframes tickerScroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* Stream FIFA Card Styles */
        .stream-overlay-container .fifa-card-container {
            max-width: 400px;
        }

        .stream-overlay-container .fifa-card {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            border: 3px solid #00d4ff;
            border-radius: 20px;
            padding: 25px;
            color: white;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .stream-overlay-container .fifa-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .stream-overlay-container .card-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .stream-overlay-container .player-name {
            font-size: 24px;
            font-weight: bold;
            margin: 0 0 15px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .stream-overlay-container .clubs-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 16px;
        }

        .stream-overlay-container .transfer-arrow {
            color: #00d4ff;
            font-size: 18px;
            animation: pulse 2s infinite;
        }

        .stream-overlay-container .probability-section {
            text-align: center;
            margin: 20px 0;
        }

        .stream-overlay-container .probability-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .stream-overlay-container .probability-text {
            font-size: 20px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .stream-overlay-container .transfer-fee {
            font-size: 16px;
            font-weight: 600;
            color: #00d4ff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .stream-overlay-container .card-footer {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 12px;
            opacity: 0.8;
        }

        .ultimate-header::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--holographic-gradient);
            animation: holographicFlow 3s linear infinite;
        }

        @keyframes holographicFlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 20px;
            font-family: var(--font-tech);
            font-size: 1.8rem;
            font-weight: 900;
            background: var(--holographic-gradient);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: holographicText 4s ease-in-out infinite;
        }

        @keyframes holographicText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .header-icon {
            font-size: 2.2rem;
            color: var(--electric-blue);
            animation: iconPulse 2s ease-in-out infinite;
            filter: drop-shadow(var(--shadow-neon));
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
        }

        .status-display {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            backdrop-filter: blur(20px);
        }

        .quantum-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--neon-green);
            animation: quantumPulse 1.5s ease-in-out infinite;
            box-shadow: 0 0 20px var(--neon-green);
        }

        @keyframes quantumPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 20px var(--neon-green);
            }
            50% { 
                transform: scale(1.5);
                box-shadow: 0 0 40px var(--neon-green), 0 0 60px var(--neon-green);
            }
        }

        /* Ultimate Preview Content - Enhanced */
        .preview-content {
            flex: 1;
            background:
                radial-gradient(circle at 30% 70%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(240, 147, 251, 0.08) 0%, transparent 50%),
                #000;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 0 0 20px 0;
        }

        .preview-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 49%, rgba(255, 255, 255, 0.02) 50%, transparent 51%);
            animation: previewShimmer 8s linear infinite;
        }

        @keyframes previewShimmer {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }

        .preview-placeholder {
            text-align: center;
            z-index: 5;
            position: relative;
        }

        .placeholder-icon {
            font-size: 5rem;
            color: var(--electric-blue);
            margin-bottom: 30px;
            animation: floatingIcon 3s ease-in-out infinite;
            filter: drop-shadow(0 0 30px var(--electric-blue));
        }

        @keyframes floatingIcon {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .placeholder-title {
            font-size: 2.8rem;
            font-weight: 900;
            font-family: var(--font-tech);
            background: var(--cosmic-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }

        .placeholder-subtitle {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 400;
        }

        /* Ultimate Control Panel */
        .control-panel {
            background: linear-gradient(180deg, var(--deep-purple), var(--dark-space));
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--glass-border);
            position: relative;
        }

        .control-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(255, 0, 128, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Ultimate Control Header */
        .control-header {
            background: var(--cosmic-gradient);
            padding: 35px 30px;
            text-align: center;
            position: relative;
            z-index: 1;
            box-shadow: var(--shadow-intense);
        }

        .control-title {
            font-size: 1.8rem;
            font-weight: 900;
            font-family: var(--font-tech);
            color: white;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .control-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Ultimate Control Body */
        .control-body {
            flex: 1;
            padding: 30px;
            position: relative;
            z-index: 1;
        }

        /* Ultimate Control Sections */
        .ultimate-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow: var(--glass-shadow);
        }

        .ultimate-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--holographic-gradient);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .ultimate-section:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-intense);
            border-color: var(--electric-blue);
        }

        .ultimate-section:hover::before {
            transform: scaleX(1);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: white;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-family: var(--font-tech);
        }

        .section-icon {
            font-size: 1.5rem;
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 10px rgba(79, 172, 254, 0.5));
        }

        /* Ultimate Form Controls */
        .ultimate-input-group {
            position: relative;
            margin-bottom: 20px;
        }

        /* Smart Club Input Enhancements */
        .smart-club-input {
            position: relative;
        }

        .club-suggestions-container {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.98));
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            margin-top: 5px;
        }

        .club-suggestions-container.show {
            display: block;
            animation: suggestionsFadeIn 0.3s ease-out;
        }

        @keyframes suggestionsFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .club-suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s ease;
        }

        .club-suggestion-item:hover {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2));
            transform: translateX(5px);
        }

        .club-suggestion-item:last-child {
            border-bottom: none;
        }

        .club-suggestion-logo {
            width: 32px;
            height: 32px;
            object-fit: contain;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px;
        }

        .club-suggestion-info {
            flex: 1;
        }

        .club-suggestion-name {
            color: white;
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 2px;
        }

        .club-suggestion-details {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }

        .club-logo-preview {
            position: absolute;
            top: 50%;
            right: 45px;
            transform: translateY(-50%);
            width: 28px;
            height: 28px;
            display: none;
            z-index: 10;
        }

        .club-logo-preview.show {
            display: block;
            animation: logoPreviewFadeIn 0.3s ease-out;
        }

        @keyframes logoPreviewFadeIn {
            from {
                opacity: 0;
                scale: 0.8;
            }
            to {
                opacity: 1;
                scale: 1;
            }
        }

        .club-logo-preview img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 4px;
            filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.5));
        }

        .club-input-verified {
            border-color: #10b981 !important;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }

        .club-input-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }

        .club-suggestions-header {
            padding: 12px 16px;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1), rgba(147, 51, 234, 0.1));
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .club-suggestions-footer {
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.75rem;
            text-align: center;
        }

        /* Multi-Player Club Suggestions */
        .multi-club-suggestions {
            z-index: 1001 !important;
        }

        .multi-club-logo-preview {
            z-index: 1002 !important;
        }

        .multi-player-input .club-suggestions-container {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1001;
        }

        .multi-player-input .club-logo-preview {
            position: absolute;
            top: 50%;
            right: 45px;
            transform: translateY(-50%);
            z-index: 1002;
        }

        .ultimate-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.15);
            color: white;
            border-radius: 15px;
            padding: 18px 55px 18px 20px;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            font-family: var(--font-primary);
        }

        .ultimate-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
            font-weight: 400;
        }

        .ultimate-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.12);
            border-color: var(--electric-blue);
            box-shadow:
                0 0 0 4px rgba(0, 212, 255, 0.2),
                0 8px 25px rgba(0, 212, 255, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .ultimate-input:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }

        .input-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: var(--electric-blue);
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .ultimate-input:focus + .input-icon {
            color: var(--neon-green);
            transform: translateY(-50%) scale(1.2);
        }

        /* Ultimate Buttons */
        .ultimate-btn {
            width: 100%;
            border: none;
            border-radius: 15px;
            padding: 18px 25px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: var(--font-tech);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .ultimate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .ultimate-btn:hover::before {
            left: 100%;
        }

        .ultimate-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-intense);
            filter: brightness(1.1);
        }

        .ultimate-btn:active {
            transform: translateY(-1px) scale(0.98);
            transition: all 0.1s ease;
        }

        .ultimate-btn:focus {
            outline: none;
            box-shadow: var(--shadow-intense), 0 0 0 3px rgba(102, 126, 234, 0.3);
        }

        .btn-primary-ultimate {
            background: var(--cosmic-gradient);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-primary-ultimate:hover {
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .btn-success-ultimate {
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }

        .btn-warning-ultimate {
            background: var(--warning-gradient);
            color: white;
            box-shadow: 0 8px 25px rgba(67, 233, 123, 0.4);
        }

        .btn-info-ultimate {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.4);
        }

        .btn-info-ultimate:hover {
            background: linear-gradient(135deg, #0891b2, #0e7490);
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(6, 182, 212, 0.6);
        }

        /* Ultimate Select */
        .ultimate-select {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.15);
            color: white;
            border-radius: 15px;
            padding: 18px 20px;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
            cursor: pointer;
        }

        .ultimate-select:focus {
            outline: none;
            border-color: var(--electric-blue);
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.2);
        }

        .ultimate-select option {
            background: var(--deep-purple);
            color: white;
            padding: 10px;
        }

        /* ðŸš€ MODERN 2024: Only Transform + Opacity for 60fps */
        .fifa-card, .financial-card {
            position: relative;
            z-index: 10;
            width: 400px;
            height: 600px;
            opacity: 1;
            visibility: visible;

            /* ðŸŽ¯ ONLY animate transform and opacity for hardware acceleration */
            transform: translateZ(0);

            /* ðŸš€ Modern Performance Optimizations */
            will-change: auto; /* Only set when needed */
            transform-style: preserve-3d;
            backface-visibility: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;

            /* ðŸŒŸ Modern smooth easing - shorter duration */
            transition:
                opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ðŸš€ MODERN 2024: Fast and Smooth Animation States */
        .card-entering, .card-exiting {
            will-change: transform, opacity; /* Only what we animate */
            transform-style: preserve-3d;
            backface-visibility: hidden;
        }

        .card-entering {
            animation-fill-mode: both;
            animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1); /* Material Design easing */
        }

        .card-exiting {
            animation-fill-mode: both;
            animation-timing-function: cubic-bezier(0.4, 0, 1, 1); /* Sharp exit */
        }

        /* ðŸŒŸ Professional Entrance States */
        .card-entering {
            animation-fill-mode: both;
            animation-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .card-exiting {
            animation-fill-mode: both;
            animation-timing-function: cubic-bezier(0.55, 0.055, 0.675, 0.19);
        }

        /* ðŸŽ­ Modern Cinematic Transitions */
        /* ðŸš€ MODERN 2024: Simple and Fast Animations (Transform + Opacity Only) */
        @keyframes modernFadeIn {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.95) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1) translateZ(0);
            }
        }

        @keyframes modernSlideUp {
            0% {
                opacity: 0;
                transform: translateY(40px) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) translateZ(0);
            }
        }

        @keyframes modernSlideDown {
            0% {
                opacity: 0;
                transform: translateY(-40px) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) translateZ(0);
            }
        }

        @keyframes modernSlideLeft {
            0% {
                opacity: 0;
                transform: translateX(-40px) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateX(0) translateZ(0);
            }
        }

        @keyframes modernSlideRight {
            0% {
                opacity: 0;
                transform: translateX(40px) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateX(0) translateZ(0);
            }
        }

        @keyframes modernScale {
            0% {
                opacity: 0;
                transform: scale(0.8) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateZ(0);
            }
        }

        @keyframes modernFlip {
            0% {
                opacity: 0;
                transform: perspective(1000px) rotateY(-90deg) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: perspective(1000px) rotateY(0deg) translateZ(0);
            }
        }

        @keyframes modernBounce {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9) translateZ(0);
            }
            60% {
                opacity: 0.8;
                transform: translateY(-10px) scale(1.05) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1) translateZ(0);
            }
        }

        @keyframes cinematicSlideUp {
            0% {
                opacity: 0;
                transform: translateY(100%) scale(0.9) rotateX(15deg);
                filter: blur(10px);
                clip-path: inset(100% 0 0 0);
            }
            30% {
                opacity: 0.6;
                transform: translateY(20%) scale(0.95) rotateX(5deg);
                filter: blur(5px);
                clip-path: inset(20% 0 0 0);
            }
            70% {
                opacity: 0.9;
                transform: translateY(-10%) scale(1.02) rotateX(-2deg);
                filter: blur(1px);
                clip-path: inset(0% 0 0 0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1) rotateX(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
        }

        /* ðŸš€ MODERN 2024: Exit Animations (Transform + Opacity Only) */
        @keyframes modernFadeOut {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateY(20px) scale(0.95) translateZ(0);
            }
        }

        @keyframes modernSlideOutDown {
            0% {
                opacity: 1;
                transform: translateY(0) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateY(40px) translateZ(0);
            }
        }

        @keyframes modernSlideOutUp {
            0% {
                opacity: 1;
                transform: translateY(0) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-40px) translateZ(0);
            }
        }

        @keyframes modernSlideOutLeft {
            0% {
                opacity: 1;
                transform: translateX(0) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-40px) translateZ(0);
            }
        }

        @keyframes modernSlideOutRight {
            0% {
                opacity: 1;
                transform: translateX(0) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateX(40px) translateZ(0);
            }
        }

        @keyframes modernScaleOut {
            0% {
                opacity: 1;
                transform: scale(1) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: scale(0.8) translateZ(0);
            }
        }

        @keyframes modernFlipOut {
            0% {
                opacity: 1;
                transform: perspective(1000px) rotateY(0deg) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: perspective(1000px) rotateY(90deg) translateZ(0);
            }
        }

        @keyframes modernBounceOut {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) translateZ(0);
            }
            40% {
                opacity: 0.8;
                transform: translateY(-10px) scale(1.05) translateZ(0);
            }
            100% {
                opacity: 0;
                transform: translateY(30px) scale(0.9) translateZ(0);
            }
        }

        @keyframes cinematicSlideLeft {
            0% {
                opacity: 0;
                transform: translateX(-100%) scale(0.9) rotateY(15deg);
                filter: blur(10px);
                clip-path: inset(0 100% 0 0);
            }
            30% {
                opacity: 0.6;
                transform: translateX(-20%) scale(0.95) rotateY(5deg);
                filter: blur(5px);
                clip-path: inset(0 20% 0 0);
            }
            70% {
                opacity: 0.9;
                transform: translateX(10%) scale(1.02) rotateY(-2deg);
                filter: blur(1px);
                clip-path: inset(0% 0 0 0);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1) rotateY(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
        }

        @keyframes cinematicSlideRight {
            0% {
                opacity: 0;
                transform: translateX(100%) scale(0.9) rotateY(-15deg);
                filter: blur(10px);
                clip-path: inset(0 0 0 100%);
            }
            30% {
                opacity: 0.6;
                transform: translateX(20%) scale(0.95) rotateY(-5deg);
                filter: blur(5px);
                clip-path: inset(0 0 0 20%);
            }
            70% {
                opacity: 0.9;
                transform: translateX(-10%) scale(1.02) rotateY(2deg);
                filter: blur(1px);
                clip-path: inset(0% 0 0 0);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1) rotateY(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
        }

        @keyframes cinematicIrisWipe {
            0% {
                opacity: 0;
                clip-path: circle(0% at 50% 50%);
                transform: scale(0.8) rotate(-5deg);
                filter: blur(15px) brightness(0.5);
            }
            25% {
                opacity: 0.4;
                clip-path: circle(25% at 50% 50%);
                transform: scale(0.9) rotate(-2deg);
                filter: blur(8px) brightness(0.8);
            }
            50% {
                opacity: 0.7;
                clip-path: circle(50% at 50% 50%);
                transform: scale(1.05) rotate(1deg);
                filter: blur(4px) brightness(1.1);
            }
            75% {
                opacity: 0.9;
                clip-path: circle(75% at 50% 50%);
                transform: scale(1.02) rotate(0.5deg);
                filter: blur(2px) brightness(1.05);
            }
            100% {
                opacity: 1;
                clip-path: circle(100% at 50% 50%);
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
            }
        }

        @keyframes cinematicFlipVertical {
            0% {
                opacity: 0;
                transform: perspective(1000px) rotateX(-90deg) scale(0.8);
                filter: blur(10px);
                transform-origin: center bottom;
            }
            25% {
                opacity: 0.3;
                transform: perspective(1000px) rotateX(-45deg) scale(0.9);
                filter: blur(6px);
            }
            50% {
                opacity: 0.7;
                transform: perspective(1000px) rotateX(-10deg) scale(1.05);
                filter: blur(3px);
            }
            75% {
                opacity: 0.9;
                transform: perspective(1000px) rotateX(5deg) scale(1.02);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: perspective(1000px) rotateX(0deg) scale(1);
                filter: blur(0px);
            }
        }

        @keyframes cinematicFlipHorizontal {
            0% {
                opacity: 0;
                transform: perspective(1000px) rotateY(-90deg) scale(0.8);
                filter: blur(10px);
                transform-origin: center left;
            }
            25% {
                opacity: 0.3;
                transform: perspective(1000px) rotateY(-45deg) scale(0.9);
                filter: blur(6px);
            }
            50% {
                opacity: 0.7;
                transform: perspective(1000px) rotateY(-10deg) scale(1.05);
                filter: blur(3px);
            }
            75% {
                opacity: 0.9;
                transform: perspective(1000px) rotateY(5deg) scale(1.02);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: perspective(1000px) rotateY(0deg) scale(1);
                filter: blur(0px);
            }
        }

        @keyframes cinematicExpandIn {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-180deg);
                filter: blur(20px) brightness(0.3);
                clip-path: circle(0% at 50% 50%);
            }
            20% {
                opacity: 0.2;
                transform: scale(0.3) rotate(-90deg);
                filter: blur(15px) brightness(0.5);
                clip-path: circle(20% at 50% 50%);
            }
            40% {
                opacity: 0.5;
                transform: scale(0.7) rotate(-30deg);
                filter: blur(8px) brightness(0.8);
                clip-path: circle(50% at 50% 50%);
            }
            70% {
                opacity: 0.8;
                transform: scale(1.1) rotate(10deg);
                filter: blur(3px) brightness(1.1);
                clip-path: circle(80% at 50% 50%);
            }
            85% {
                opacity: 0.95;
                transform: scale(1.05) rotate(5deg);
                filter: blur(1px) brightness(1.05);
                clip-path: circle(95% at 50% 50%);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
                clip-path: circle(100% at 50% 50%);
            }
        }

        @keyframes cinematicBounceExpand {
            0% {
                opacity: 0;
                transform: scale(0) translateY(100px) rotate(-10deg);
                filter: blur(15px);
            }
            15% {
                opacity: 0.3;
                transform: scale(0.4) translateY(50px) rotate(-5deg);
                filter: blur(10px);
            }
            30% {
                opacity: 0.6;
                transform: scale(0.8) translateY(10px) rotate(2deg);
                filter: blur(5px);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2) translateY(-20px) rotate(-1deg);
                filter: blur(2px);
            }
            70% {
                opacity: 0.95;
                transform: scale(0.95) translateY(5px) rotate(0.5deg);
                filter: blur(1px);
            }
            85% {
                opacity: 1;
                transform: scale(1.05) translateY(-5px) rotate(0deg);
                filter: blur(0px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0) rotate(0deg);
                filter: blur(0px);
            }
        }

        /* ðŸš€ ULTRA-SMOOTH: Advanced Exit Animations */
        @keyframes ultraSmoothFadeOut {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0) translateZ(0);
                filter: blur(0px) brightness(1) saturate(1);
            }
            15% {
                opacity: 0.9;
                transform: scale(1.02) translateY(-5px) translateZ(0);
                filter: blur(1px) brightness(1.1) saturate(1.1);
            }
            35% {
                opacity: 0.7;
                transform: scale(1.05) translateY(-8px) translateZ(0);
                filter: blur(3px) brightness(1.15) saturate(1.05);
            }
            55% {
                opacity: 0.5;
                transform: scale(1.03) translateY(5px) translateZ(0);
                filter: blur(6px) brightness(1.1) saturate(0.9);
            }
            75% {
                opacity: 0.25;
                transform: scale(0.95) translateY(15px) translateZ(0);
                filter: blur(10px) brightness(0.8) saturate(0.7);
            }
            90% {
                opacity: 0.1;
                transform: scale(0.9) translateY(25px) translateZ(0);
                filter: blur(15px) brightness(0.6) saturate(0.5);
            }
            100% {
                opacity: 0;
                transform: scale(0.85) translateY(35px) translateZ(0);
                filter: blur(20px) brightness(0.4) saturate(0.3);
            }
        }

        @keyframes ultraSmoothSlideOutDown {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotateX(0deg) translateZ(0);
                filter: blur(0px) brightness(1);
                clip-path: inset(0% 0 0 0);
            }
            15% {
                opacity: 0.9;
                transform: translateY(15%) scale(0.98) rotateX(3deg) translateZ(0);
                filter: blur(2px) brightness(1.05);
                clip-path: inset(0% 0 5% 0);
            }
            35% {
                opacity: 0.7;
                transform: translateY(35%) scale(0.94) rotateX(8deg) translateZ(0);
                filter: blur(5px) brightness(0.95);
                clip-path: inset(0% 0 25% 0);
            }
            55% {
                opacity: 0.5;
                transform: translateY(60%) scale(0.9) rotateX(12deg) translateZ(0);
                filter: blur(8px) brightness(0.8);
                clip-path: inset(0% 0 50% 0);
            }
            75% {
                opacity: 0.25;
                transform: translateY(85%) scale(0.85) rotateX(16deg) translateZ(0);
                filter: blur(12px) brightness(0.6);
                clip-path: inset(0% 0 75% 0);
            }
            90% {
                opacity: 0.1;
                transform: translateY(95%) scale(0.8) rotateX(18deg) translateZ(0);
                filter: blur(16px) brightness(0.4);
                clip-path: inset(0% 0 90% 0);
            }
            100% {
                opacity: 0;
                transform: translateY(120%) scale(0.75) rotateX(20deg) translateZ(0);
                filter: blur(20px) brightness(0.3);
                clip-path: inset(0% 0 100% 0);
            }
        }

        @keyframes cinematicSlideOutDown {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotateX(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
            30% {
                opacity: 0.8;
                transform: translateY(20%) scale(0.98) rotateX(5deg);
                filter: blur(2px);
                clip-path: inset(0% 0 10% 0);
            }
            70% {
                opacity: 0.4;
                transform: translateY(60%) scale(0.9) rotateX(10deg);
                filter: blur(6px);
                clip-path: inset(0% 0 50% 0);
            }
            100% {
                opacity: 0;
                transform: translateY(100%) scale(0.8) rotateX(15deg);
                filter: blur(12px);
                clip-path: inset(0% 0 100% 0);
            }
        }

        @keyframes cinematicSlideOutUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotateX(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
            30% {
                opacity: 0.8;
                transform: translateY(-20%) scale(0.98) rotateX(-5deg);
                filter: blur(2px);
                clip-path: inset(10% 0 0% 0);
            }
            70% {
                opacity: 0.4;
                transform: translateY(-60%) scale(0.9) rotateX(-10deg);
                filter: blur(6px);
                clip-path: inset(50% 0 0% 0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100%) scale(0.8) rotateX(-15deg);
                filter: blur(12px);
                clip-path: inset(100% 0 0% 0);
            }
        }

        @keyframes cinematicSlideOutLeft {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1) rotateY(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
            30% {
                opacity: 0.8;
                transform: translateX(-20%) scale(0.98) rotateY(-5deg);
                filter: blur(2px);
                clip-path: inset(0% 0 0% 10%);
            }
            70% {
                opacity: 0.4;
                transform: translateX(-60%) scale(0.9) rotateY(-10deg);
                filter: blur(6px);
                clip-path: inset(0% 0 0% 50%);
            }
            100% {
                opacity: 0;
                transform: translateX(-100%) scale(0.8) rotateY(-15deg);
                filter: blur(12px);
                clip-path: inset(0% 0 0% 100%);
            }
        }

        @keyframes cinematicSlideOutRight {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1) rotateY(0deg);
                filter: blur(0px);
                clip-path: inset(0% 0 0 0);
            }
            30% {
                opacity: 0.8;
                transform: translateX(20%) scale(0.98) rotateY(5deg);
                filter: blur(2px);
                clip-path: inset(0% 10% 0% 0);
            }
            70% {
                opacity: 0.4;
                transform: translateX(60%) scale(0.9) rotateY(10deg);
                filter: blur(6px);
                clip-path: inset(0% 50% 0% 0);
            }
            100% {
                opacity: 0;
                transform: translateX(100%) scale(0.8) rotateY(15deg);
                filter: blur(12px);
                clip-path: inset(0% 100% 0% 0);
            }
        }

        @keyframes cinematicIrisWipeOut {
            0% {
                opacity: 1;
                clip-path: circle(100% at 50% 50%);
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
            }
            25% {
                opacity: 0.8;
                clip-path: circle(75% at 50% 50%);
                transform: scale(1.02) rotate(2deg);
                filter: blur(2px) brightness(1.1);
            }
            50% {
                opacity: 0.6;
                clip-path: circle(50% at 50% 50%);
                transform: scale(0.95) rotate(-1deg);
                filter: blur(5px) brightness(0.9);
            }
            75% {
                opacity: 0.3;
                clip-path: circle(25% at 50% 50%);
                transform: scale(0.9) rotate(3deg);
                filter: blur(10px) brightness(0.6);
            }
            100% {
                opacity: 0;
                clip-path: circle(0% at 50% 50%);
                transform: scale(0.8) rotate(5deg);
                filter: blur(20px) brightness(0.3);
            }
        }

        @keyframes cinematicFlipVerticalOut {
            0% {
                opacity: 1;
                transform: perspective(1000px) rotateX(0deg) scale(1);
                filter: blur(0px);
                transform-origin: center bottom;
            }
            25% {
                opacity: 0.8;
                transform: perspective(1000px) rotateX(15deg) scale(1.02);
                filter: blur(2px);
            }
            50% {
                opacity: 0.6;
                transform: perspective(1000px) rotateX(45deg) scale(0.95);
                filter: blur(5px);
            }
            75% {
                opacity: 0.3;
                transform: perspective(1000px) rotateX(75deg) scale(0.9);
                filter: blur(8px);
            }
            100% {
                opacity: 0;
                transform: perspective(1000px) rotateX(90deg) scale(0.8);
                filter: blur(15px);
            }
        }

        @keyframes cinematicFlipHorizontalOut {
            0% {
                opacity: 1;
                transform: perspective(1000px) rotateY(0deg) scale(1);
                filter: blur(0px);
                transform-origin: center left;
            }
            25% {
                opacity: 0.8;
                transform: perspective(1000px) rotateY(15deg) scale(1.02);
                filter: blur(2px);
            }
            50% {
                opacity: 0.6;
                transform: perspective(1000px) rotateY(45deg) scale(0.95);
                filter: blur(5px);
            }
            75% {
                opacity: 0.3;
                transform: perspective(1000px) rotateY(75deg) scale(0.9);
                filter: blur(8px);
            }
            100% {
                opacity: 0;
                transform: perspective(1000px) rotateY(90deg) scale(0.8);
                filter: blur(15px);
            }
        }

        @keyframes cinematicExpandOut {
            0% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
                clip-path: circle(100% at 50% 50%);
            }
            20% {
                opacity: 0.9;
                transform: scale(1.1) rotate(10deg);
                filter: blur(2px) brightness(1.1);
                clip-path: circle(90% at 50% 50%);
            }
            40% {
                opacity: 0.7;
                transform: scale(0.8) rotate(45deg);
                filter: blur(5px) brightness(0.8);
                clip-path: circle(60% at 50% 50%);
            }
            70% {
                opacity: 0.4;
                transform: scale(0.4) rotate(120deg);
                filter: blur(10px) brightness(0.5);
                clip-path: circle(30% at 50% 50%);
            }
            100% {
                opacity: 0;
                transform: scale(0) rotate(180deg);
                filter: blur(20px) brightness(0.2);
                clip-path: circle(0% at 50% 50%);
            }
        }

        @keyframes cinematicBounceExpandOut {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0) rotate(0deg);
                filter: blur(0px);
            }
            20% {
                opacity: 0.9;
                transform: scale(1.1) translateY(-10px) rotate(5deg);
                filter: blur(1px);
            }
            40% {
                opacity: 0.7;
                transform: scale(0.9) translateY(20px) rotate(-10deg);
                filter: blur(3px);
            }
            60% {
                opacity: 0.5;
                transform: scale(0.6) translateY(50px) rotate(15deg);
                filter: blur(6px);
            }
            80% {
                opacity: 0.2;
                transform: scale(0.3) translateY(80px) rotate(-20deg);
                filter: blur(10px);
            }
            100% {
                opacity: 0;
                transform: scale(0) translateY(120px) rotate(25deg);
                filter: blur(15px);
            }
        }

        .card-transition-wipeLeft {
            animation: cardWipeLeft var(--transition-duration, 1s) ease-out forwards !important;
            opacity: 0 !important;
            clip-path: inset(0 100% 0 0) !important;
        }

        .card-transition-wipeRight {
            animation: cardWipeRight var(--transition-duration, 1s) ease-out forwards !important;
            opacity: 0 !important;
            clip-path: inset(0 0 0 100%) !important;
        }

        .card-transition-irisWipe {
            animation: cardIrisWipe var(--transition-duration, 1s) ease-out forwards !important;
            opacity: 0 !important;
            clip-path: circle(0% at 50% 50%) !important;
        }

        .card-transition-slideFromBelow {
            animation: cardSlideFromBelow var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateY(100%) !important;
        }

        .card-transition-slideFromAbove {
            animation: cardSlideFromAbove var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateY(-100%) !important;
        }

        .card-transition-slideFromLeft {
            animation: cardSlideFromLeft var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateX(-100%) !important;
        }

        .card-transition-slideFromRight {
            animation: cardSlideFromRight var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateX(100%) !important;
        }

        .card-transition-slideFadeBelow {
            animation: cardSlideFadeBelow var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateY(50%) scale(0.8) !important;
        }

        .card-transition-slideFadeAbove {
            animation: cardSlideFadeAbove var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateY(-50%) scale(0.8) !important;
        }

        .card-transition-slideFadeLeft {
            animation: cardSlideFadeLeft var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateX(-50%) scale(0.8) !important;
        }

        .card-transition-slideFadeRight {
            animation: cardSlideFadeRight var(--transition-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards !important;
            opacity: 0 !important;
            transform: translateX(50%) scale(0.8) !important;
        }

        .card-transition-flipVertical {
            animation: cardFlipVertical var(--transition-duration, 1s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards !important;
            opacity: 0 !important;
            transform: rotateX(-90deg) !important;
        }

        .card-transition-flipHorizontal {
            animation: cardFlipHorizontal var(--transition-duration, 1s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards !important;
            opacity: 0 !important;
            transform: rotateY(-90deg) !important;
        }

        .card-transition-expandIn {
            animation: cardExpandIn var(--transition-duration, 1s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards !important;
            opacity: 0 !important;
            transform: scale(0) !important;
        }

        .card-transition-bounceExpand {
            animation: cardBounceExpand var(--transition-duration, 1s) cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards !important;
            opacity: 0 !important;
            transform: scale(0) !important;
        }

        /* Card Exit Animations */
        .card-exit-fadeIn {
            animation: cardFadeOut var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
        }

        .card-exit-wipeUp {
            animation: cardWipeOutUp var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
            clip-path: inset(0 0 0 0) !important;
        }

        .card-exit-wipeDown {
            animation: cardWipeOutDown var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
            clip-path: inset(0 0 0 0) !important;
        }

        .card-exit-wipeLeft {
            animation: cardWipeOutLeft var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
            clip-path: inset(0 0 0 0) !important;
        }

        .card-exit-wipeRight {
            animation: cardWipeOutRight var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
            clip-path: inset(0 0 0 0) !important;
        }

        .card-exit-irisWipe {
            animation: cardIrisWipeOut var(--transition-duration, 1s) ease-in forwards !important;
            opacity: 1 !important;
            clip-path: circle(100% at 50% 50%) !important;
        }

        .card-exit-slideFromBelow {
            animation: cardSlideToBelow var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateY(0) !important;
        }

        .card-exit-slideFromAbove {
            animation: cardSlideToAbove var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateY(0) !important;
        }

        .card-exit-slideFromLeft {
            animation: cardSlideToLeft var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateX(0) !important;
        }

        .card-exit-slideFromRight {
            animation: cardSlideToRight var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateX(0) !important;
        }

        .card-exit-slideFadeBelow {
            animation: cardSlideFadeToBelow var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateY(0) scale(1) !important;
        }

        .card-exit-slideFadeAbove {
            animation: cardSlideFadeToAbove var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateY(0) scale(1) !important;
        }

        .card-exit-slideFadeLeft {
            animation: cardSlideFadeToLeft var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateX(0) scale(1) !important;
        }

        .card-exit-slideFadeRight {
            animation: cardSlideFadeToRight var(--transition-duration, 1s) cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards !important;
            opacity: 1 !important;
            transform: translateX(0) scale(1) !important;
        }

        .card-exit-flipVertical {
            animation: cardFlipVerticalOut var(--transition-duration, 1s) cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards !important;
            opacity: 1 !important;
            transform: rotateX(0deg) !important;
        }

        .card-exit-flipHorizontal {
            animation: cardFlipHorizontalOut var(--transition-duration, 1s) cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards !important;
            opacity: 1 !important;
            transform: rotateY(0deg) !important;
        }

        .card-exit-expandIn {
            animation: cardExpandOut var(--transition-duration, 1s) cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards !important;
            opacity: 1 !important;
            transform: scale(1) !important;
        }

        .card-exit-bounceExpand {
            animation: cardBounceExpandOut var(--transition-duration, 1s) cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards !important;
            opacity: 1 !important;
            transform: scale(1) !important;
        }

        /* ðŸŽ¬ Card Transition Keyframes - Entry Animations */
        @keyframes cardFadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes cardWipeUp {
            0% {
                opacity: 0;
                clip-path: inset(100% 0 0 0);
            }
            100% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes cardWipeDown {
            0% {
                opacity: 0;
                clip-path: inset(0 0 100% 0);
            }
            100% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes cardWipeLeft {
            0% {
                opacity: 0;
                clip-path: inset(0 100% 0 0);
            }
            100% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes cardWipeRight {
            0% {
                opacity: 0;
                clip-path: inset(0 0 0 100%);
            }
            100% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes cardIrisWipe {
            0% {
                opacity: 0;
                clip-path: circle(0% at 50% 50%);
            }
            100% {
                opacity: 1;
                clip-path: circle(100% at 50% 50%);
            }
        }

        @keyframes cardSlideFromBelow {
            0% {
                opacity: 0;
                transform: translateY(100%);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes cardSlideFromAbove {
            0% {
                opacity: 0;
                transform: translateY(-100%);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes cardSlideFromLeft {
            0% {
                opacity: 0;
                transform: translateX(-100%);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes cardSlideFromRight {
            0% {
                opacity: 0;
                transform: translateX(100%);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes cardSlideFadeBelow {
            0% {
                opacity: 0;
                transform: translateY(50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes cardSlideFadeAbove {
            0% {
                opacity: 0;
                transform: translateY(-50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes cardSlideFadeLeft {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        @keyframes cardSlideFadeRight {
            0% {
                opacity: 0;
                transform: translateX(50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        @keyframes cardFlipVertical {
            0% {
                opacity: 0;
                transform: rotateX(-90deg);
            }
            100% {
                opacity: 1;
                transform: rotateX(0deg);
            }
        }

        @keyframes cardFlipHorizontal {
            0% {
                opacity: 0;
                transform: rotateY(-90deg);
            }
            100% {
                opacity: 1;
                transform: rotateY(0deg);
            }
        }

        @keyframes cardExpandIn {
            0% {
                opacity: 0;
                transform: scale(0);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes cardBounceExpand {
            0% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* ðŸŽ¬ Card Transition Keyframes - Exit Animations */
        @keyframes cardFadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        @keyframes cardWipeOutUp {
            0% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
            100% {
                opacity: 0;
                clip-path: inset(0 0 100% 0);
            }
        }

        @keyframes cardWipeOutDown {
            0% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
            100% {
                opacity: 0;
                clip-path: inset(100% 0 0 0);
            }
        }

        @keyframes cardWipeOutLeft {
            0% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
            100% {
                opacity: 0;
                clip-path: inset(0 0 0 100%);
            }
        }

        @keyframes cardWipeOutRight {
            0% {
                opacity: 1;
                clip-path: inset(0 0 0 0);
            }
            100% {
                opacity: 0;
                clip-path: inset(0 100% 0 0);
            }
        }

        @keyframes cardIrisWipeOut {
            0% {
                opacity: 1;
                clip-path: circle(100% at 50% 50%);
            }
            100% {
                opacity: 0;
                clip-path: circle(0% at 50% 50%);
            }
        }

        @keyframes cardSlideToBelow {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(100%);
            }
        }

        @keyframes cardSlideToAbove {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100%);
            }
        }

        @keyframes cardSlideToLeft {
            0% {
                opacity: 1;
                transform: translateX(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-100%);
            }
        }

        @keyframes cardSlideToRight {
            0% {
                opacity: 1;
                transform: translateX(0);
            }
            100% {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        @keyframes cardSlideFadeToBelow {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(50%) scale(0.8);
            }
        }

        @keyframes cardSlideFadeToAbove {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-50%) scale(0.8);
            }
        }

        @keyframes cardSlideFadeToLeft {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }
        }

        @keyframes cardSlideFadeToRight {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateX(50%) scale(0.8);
            }
        }

        @keyframes cardFlipVerticalOut {
            0% {
                opacity: 1;
                transform: rotateX(0deg);
            }
            100% {
                opacity: 0;
                transform: rotateX(90deg);
            }
        }

        @keyframes cardFlipHorizontalOut {
            0% {
                opacity: 1;
                transform: rotateY(0deg);
            }
            100% {
                opacity: 0;
                transform: rotateY(90deg);
            }
        }

        @keyframes cardExpandOut {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0);
            }
        }

        @keyframes cardBounceExpandOut {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2);
            }
            100% {
                opacity: 0;
                transform: scale(0);
            }
        }

        /* Multi Player Styles */
        .multi-player-input {
            margin-bottom: 15px;
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            0% {
                opacity: 0;
                transform: translateX(30px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes cardEntrance {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes progressFill {
            0% { width: 0%; }
            100% { width: var(--target-width, 0%); }
        }

        /* Theme Variations */
        .theme-neon {
            --primary-gradient: linear-gradient(135deg, #ff0080 0%, #00d4ff 100%);
            --secondary-gradient: linear-gradient(135deg, #39ff14 0%, #ff4500 100%);
        }

        .theme-holographic {
            --primary-gradient: linear-gradient(135deg, #ff006e 0%, #8338ec 50%, #3a86ff 100%);
            --secondary-gradient: linear-gradient(135deg, #06ffa5 0%, #ffbe0b 50%, #fb5607 100%);
        }

        .theme-quantum {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .theme-futuristic {
            --primary-gradient: linear-gradient(135deg, #00c9ff 0%, #92fe9d 100%);
            --secondary-gradient: linear-gradient(135deg, #fc00ff 0%, #00dbde 100%);
        }

        /* Animation Speed Variables */
        :root {
            --animation-duration: 1s;
        }

        /* Enhanced Particle Effects */
        .enhanced-particles {
            filter: brightness(1.5) contrast(1.2);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .ultimate-container {
                grid-template-columns: 1fr 450px;
            }
        }

        @media (max-width: 768px) {
            .ultimate-container {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
            }

            .control-panel {
                max-height: 60vh;
                border-left: none;
                border-top: 1px solid var(--glass-border);
            }

            .header-title {
                font-size: 1.4rem;
            }

            .placeholder-title {
                font-size: 2rem;
            }

            /* Multi-player responsive */
            .multi-visualization {
                padding: 10px !important;
            }

            .multi-visualization > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
            }
        }

        /* Enhanced Multi-Player Animations */
        @keyframes slideOutLeft {
            0% {
                opacity: 1;
                transform: translateX(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50px);
            }
        }

        /* Enhanced Club Logo Animations */
        @keyframes targetGlow {
            0%, 100% {
                box-shadow: 0 6px 20px rgba(var(--probability-color), 0.3);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 8px 30px rgba(var(--probability-color), 0.6);
                transform: scale(1.05);
            }
        }

        @keyframes logoFloat {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            50% {
                transform: translateY(-3px) rotate(2deg);
            }
        }

        @keyframes logoShine {
            0% {
                background-position: -100% 0;
            }
            100% {
                background-position: 100% 0;
            }
        }

        /* Beautiful Modern Arrow Animations */
        @keyframes arrowContainerGlow {
            0%, 100% {
                box-shadow:
                    0 8px 25px rgba(0, 0, 0, 0.3),
                    0 0 20px var(--probability-color, #667eea),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
                transform: scale(1);
            }
            50% {
                box-shadow:
                    0 12px 35px rgba(0, 0, 0, 0.4),
                    0 0 30px var(--probability-color, #667eea),
                    0 0 40px var(--probability-color, #667eea),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
                transform: scale(1.05);
            }
        }

        @keyframes arrowDraw {
            0% {
                stroke-dasharray: 0 100;
                opacity: 0.6;
            }
            50% {
                stroke-dasharray: 50 100;
                opacity: 1;
            }
            100% {
                stroke-dasharray: 100 100;
                opacity: 0.8;
            }
        }

        @keyframes sparkle1 {
            0%, 100% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1.5);
            }
        }

        @keyframes sparkle2 {
            0%, 100% {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            60% {
                opacity: 1;
                transform: scale(1.2) rotate(180deg);
            }
        }

        /* Channel Rights Animation */
        @keyframes rightsGlow {
            0%, 100% {
                box-shadow:
                    0 10px 30px rgba(0, 0, 0, 0.4),
                    0 0 20px rgba(102, 126, 234, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
            }
            50% {
                box-shadow:
                    0 15px 40px rgba(0, 0, 0, 0.5),
                    0 0 30px rgba(102, 126, 234, 0.5),
                    0 0 40px rgba(102, 126, 234, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
        }

        /* Enhanced Card Animations */
        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0.8;
            }
            33% {
                transform: translateY(-10px) rotate(120deg);
                opacity: 1;
            }
            66% {
                transform: translateY(5px) rotate(240deg);
                opacity: 0.9;
            }
        }

        @keyframes patternShift {
            0% {
                background-position: 0px 0px, 0px 0px;
            }
            100% {
                background-position: 30px 30px, -30px -30px;
            }
        }

        /* New Card Design Animations */
        @keyframes modernCardEntrance {
            0% {
                opacity: 0;
                transform: translateY(50px) rotateX(15deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateX(0deg);
            }
        }

        @keyframes minimalistCardEntrance {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Glassmorphism Animations */
        @keyframes glassCardEntrance {
            0% {
                opacity: 0;
                transform: translateY(40px) rotateX(20deg);
                backdrop-filter: blur(0px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateX(0deg);
                backdrop-filter: blur(20px);
            }
        }

        @keyframes glassReflection {
            0%, 100% {
                transform: translateX(-100%) skewX(-15deg);
            }
            50% {
                transform: translateX(100%) skewX(-15deg);
            }
        }

        @keyframes glowRing {
            0% {
                transform: rotate(0deg);
                opacity: 0.5;
            }
            100% {
                transform: rotate(360deg);
                opacity: 0.8;
            }
        }

        @keyframes glassArrowPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 10px var(--probability-color, #667eea);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 20px var(--probability-color, #667eea);
            }
        }

        /* Cyberpunk Animations */
        @keyframes cyberpunkEntrance {
            0% {
                opacity: 0;
                transform: translateY(50px) scale(0.8);
                box-shadow: 0 0 0 transparent;
            }
            50% {
                opacity: 0.8;
                transform: translateY(-10px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                box-shadow:
                    0 0 30px var(--probability-color, #667eea),
                    0 0 60px var(--probability-color, #667eea);
            }
        }

        @keyframes gridPulse {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.7;
            }
        }

        @keyframes glitchScan {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        @keyframes textGlitch {
            0%, 90%, 100% {
                text-shadow: 0 0 5px currentColor;
            }
            95% {
                text-shadow:
                    2px 0 0 #ff0080,
                    -2px 0 0 #00ffff,
                    0 0 10px currentColor;
            }
        }

        @keyframes probabilityGlow {
            0% {
                text-shadow: 0 0 20px currentColor;
            }
            100% {
                text-shadow:
                    0 0 30px currentColor,
                    0 0 40px currentColor;
            }
        }

        @keyframes hologramFlicker {
            0%, 100% {
                opacity: 1;
                filter: brightness(1.2) contrast(1.3) hue-rotate(0deg);
            }
            50% {
                opacity: 0.8;
                filter: brightness(1.4) contrast(1.5) hue-rotate(5deg);
            }
        }

        @keyframes scanLines {
            0% {
                transform: translateY(-100%);
            }
            100% {
                transform: translateY(100%);
            }
        }

        @keyframes nameGlitch {
            0%, 90%, 100% {
                transform: translate(0);
            }
            92% {
                transform: translate(-2px, 2px);
            }
            94% {
                transform: translate(2px, -2px);
            }
            96% {
                transform: translate(-1px, 1px);
            }
        }

        /* Neon Animations */
        @keyframes neonPulse {
            0% {
                box-shadow:
                    0 0 20px var(--probability-color, #667eea),
                    0 0 40px var(--probability-color, #667eea),
                    0 0 80px var(--probability-color, #667eea);
            }
            100% {
                box-shadow:
                    0 0 30px var(--probability-color, #667eea),
                    0 0 60px var(--probability-color, #667eea),
                    0 0 120px var(--probability-color, #667eea);
            }
        }

        @keyframes neonRotate {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes neonFlicker {
            0%, 100% {
                opacity: 1;
                text-shadow:
                    0 0 10px currentColor,
                    0 0 20px currentColor,
                    0 0 30px currentColor;
            }
            50% {
                opacity: 0.8;
                text-shadow:
                    0 0 5px currentColor,
                    0 0 15px currentColor,
                    0 0 25px currentColor;
            }
        }

        /* Holographic Animations */
        @keyframes holoCardEntrance {
            0% {
                opacity: 0;
                transform: translateY(30px) rotateY(15deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0) rotateY(0deg);
            }
        }

        @keyframes holoBorder {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        @keyframes holoShimmer {
            0%, 100% {
                background-position: 0% 0%;
                opacity: 0.3;
            }
            50% {
                background-position: 100% 100%;
                opacity: 0.7;
            }
        }

        @keyframes holoText {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        /* Custom Range Slider Styling */
        .ultimate-range {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            outline: none;
            -webkit-appearance: none;
            margin-bottom: 20px;
        }

        .ultimate-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #667eea);
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.4);
            transition: all 0.3s ease;
        }

        .ultimate-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.6);
        }

        .ultimate-range::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #667eea);
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.4);
            transition: all 0.3s ease;
        }

        .ultimate-range::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.6);
        }

        /* Multi-Player Input Hover Effects */
        .multi-player-input:hover {
            border-color: rgba(0, 212, 255, 0.5) !important;
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.2);
            transform: translateY(-2px);
        }
    </style>

    <!-- Club Logo Integration Service -->
    <script src="/js/clubLogoIntegration.js"></script>

    <!-- Real-time Synchronization Service -->
    <script src="/js/realTimeSync.js"></script>

    <!-- System Tester -->
    <script src="/js/systemTester.js"></script>
</head>
<body>
    <div class="ultimate-container">
        <!-- Cosmic Preview Section -->
        <div class="cosmic-preview">
            <div class="ultimate-header">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="header-title">
                        <i class="fas fa-atom header-icon" style="
                            background: var(--holographic-gradient);
                            background-size: 400% 400%;
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            background-clip: text;
                            animation: holographicText 4s ease-in-out infinite;
                            margin-left: 10px;
                            font-size: 1.5rem;
                        "></i>
                        <h1 style="
                            background: var(--holographic-gradient);
                            background-size: 400% 400%;
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            background-clip: text;
                            animation: holographicText 4s ease-in-out infinite;
                            font-weight: 900;
                            font-size: 2.2rem;
                            margin: 0;
                            display: inline;
                        ">Ultimate Studio V4</h1>
                    </div>
                    <div class="status-display">
                        <div class="quantum-indicator"></div>
                        <span id="systemStatus">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¨Ø¯Ø§Ø¹</span>
                    </div>
                </div>
            </div>

            <div class="preview-content" id="previewContent">
                <div class="preview-placeholder" id="previewPlaceholder">
                    <i class="fas fa-rocket placeholder-icon"></i>
                    <h2 class="placeholder-title">Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹</h2>
                    <p class="placeholder-subtitle">Ø§Ø¨Ø¯Ø£ ØªØµÙˆØ±Ùƒ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª</p>
                </div>
            </div>
        </div>

        <!-- Ultimate Control Panel -->
        <div class="control-panel">
            <div class="control-header">
                <h3 class="control-title">
                    <i class="fas fa-magic me-3"></i>
                    Ultimate Creator V4
                </h3>
                <p class="control-subtitle">World-Class Transfer Visualization Platform</p>
            </div>

            <div class="control-body">
                <!-- Input Mode Selection -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-cogs section-icon"></i>
                        Ù†Ù…Ø· Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                    </div>

                    <select class="ultimate-select" id="inputMode" onchange="ultimateStudio.switchMode(this.value)">
                        <option value="manual">ðŸŽ¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ - Ù…ØªÙ‚Ø¯Ù…</option>
                        <option value="saved">ðŸ’¾ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ† - Ù…Ø­Ø³Ù†</option>
                        <option value="multi">âš¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ† - Ø¬Ø¯ÙŠØ¯</option>
                        <option value="extract">ðŸ”— Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ - Ø¹ØµØ±ÙŠ</option>
                        <option value="ai">ðŸ¤– Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - ØªØ¬Ø±ÙŠØ¨ÙŠ</option>
                    </select>
                </div>

                <!-- Manual Input Section -->
                <div class="ultimate-section" id="manualInputSection">
                    <div class="section-title">
                        <i class="fas fa-user-astronaut section-icon"></i>
                        Player Configuration
                    </div>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input" id="playerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­)">
                        <i class="fas fa-user input-icon"></i>
                    </div>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input" id="currentClub"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù…Ø«Ø§Ù„: Ù„ÙŠÙØ±Ø¨ÙˆÙ„)"
                               autocomplete="off"
                               oninput="ultimateStudio.handleClubInput(this, 'current')"
                               onfocus="ultimateStudio.showClubSuggestions(this, 'current')"
                               onblur="ultimateStudio.hideClubSuggestions(this, 'current')">
                        <i class="fas fa-shield-alt input-icon"></i>
                        <div class="club-suggestions-container" id="currentClubSuggestions"></div>
                        <div class="club-logo-preview" id="currentClubLogoPreview"></div>
                    </div>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input" id="targetClub"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ù…Ø«Ø§Ù„: Ø§Ù„Ù‡Ù„Ø§Ù„)"
                               autocomplete="off"
                               oninput="ultimateStudio.handleClubInput(this, 'target')"
                               onfocus="ultimateStudio.showClubSuggestions(this, 'target')"
                               onblur="ultimateStudio.hideClubSuggestions(this, 'target')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container" id="targetClubSuggestions"></div>
                        <div class="club-logo-preview" id="targetClubLogoPreview"></div>
                    </div>

                    <div class="ultimate-input-group">
                        <input type="url" class="ultimate-input" id="playerImage" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                        <i class="fas fa-image input-icon"></i>
                    </div>

                    <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.createVisualization()">
                        <i class="fas fa-rocket me-2"></i>
                        Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„ØªØµÙˆØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
                    </button>
                </div>

                <!-- Saved Players Section -->
                <div class="ultimate-section" id="savedPlayersSection" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-database section-icon"></i>
                        Saved Players Database
                    </div>

                    <select class="ultimate-select" id="savedPlayersList">
                        <option value="">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</option>
                    </select>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input" id="savedPlayerTargetClub"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
                               autocomplete="off"
                               oninput="ultimateStudio.handleClubInput(this, 'savedTarget')"
                               onfocus="ultimateStudio.showClubSuggestions(this, 'savedTarget')"
                               onblur="ultimateStudio.hideClubSuggestions(this, 'savedTarget')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container" id="savedTargetClubSuggestions"></div>
                        <div class="club-logo-preview" id="savedTargetClubLogoPreview"></div>
                    </div>

                    <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.loadSavedPlayer()">
                        <i class="fas fa-download me-2"></i>
                        ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </div>

                <!-- Multi Players Section -->
                <div class="ultimate-section" id="multiSection" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-users section-icon"></i>
                        Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ†
                    </div>

                    <!-- Multi-Player Input Mode Selection -->
                    <div class="ultimate-input-group">
                        <div class="section-subtitle">
                            <i class="fas fa-users"></i>
                            Ù†Ù…Ø· Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ†
                        </div>
                        <div style="
                            background: rgba(0, 212, 255, 0.1);
                            border: 2px solid rgba(0, 212, 255, 0.3);
                            border-radius: 15px;
                            padding: 15px;
                            text-align: center;
                            color: #00d4ff;
                            font-weight: 600;
                        ">
                            <i class="fas fa-check-circle" style="margin-left: 8px;"></i>
                            ðŸ”„ Ù†Ù…Ø· Ù…Ø®ØªÙ„Ø· - ÙŠØ¯ÙˆÙŠ ÙˆÙ…Ø­ÙÙˆØ¸
                        </div>
                    </div>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input" id="multiTargetClub"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†"
                               autocomplete="off"
                               oninput="ultimateStudio.handleClubInput(this, 'multiTarget')"
                               onfocus="ultimateStudio.showClubSuggestions(this, 'multiTarget')"
                               onblur="ultimateStudio.hideClubSuggestions(this, 'multiTarget')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container" id="multiTargetClubSuggestions"></div>
                        <div class="club-logo-preview" id="multiTargetClubLogoPreview"></div>
                    </div>

                    <div id="multiPlayersContainer">
                        <div class="multi-player-input" style="
                            background: rgba(255, 255, 255, 0.05);
                            border: 2px solid rgba(255, 255, 255, 0.1);
                            border-radius: 15px;
                            padding: 20px;
                            margin-bottom: 15px;
                            transition: all 0.3s ease;
                        ">
                            <div class="player-header" style="
                                display: flex;
                                align-items: center;
                                margin-bottom: 15px;
                                color: #00d4ff;
                                font-weight: 600;
                            ">
                                <i class="fas fa-user-circle" style="margin-left: 10px; font-size: 1.2rem;"></i>
                                Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„
                            </div>

                            <!-- Player Name -->
                            <div class="ultimate-input-group">
                                <input type="text" class="ultimate-input multi-player-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
                                <i class="fas fa-user input-icon"></i>
                            </div>

                            <!-- Current Club -->
                            <div class="ultimate-input-group">
                                <input type="text" class="ultimate-input smart-club-input multi-player-current-club"
                                       placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
                                       autocomplete="off"
                                       oninput="ultimateStudio.handleMultiClubInput(this, 'current')"
                                       onfocus="ultimateStudio.showMultiClubSuggestions(this, 'current')"
                                       onblur="ultimateStudio.hideMultiClubSuggestions(this, 'current')">
                                <i class="fas fa-shield-alt input-icon"></i>
                                <div class="club-suggestions-container multi-club-suggestions"></div>
                                <div class="club-logo-preview multi-club-logo-preview"></div>
                            </div>

                            <!-- Target Club -->
                            <div class="ultimate-input-group">
                                <input type="text" class="ultimate-input smart-club-input multi-player-target-club"
                                       placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
                                       autocomplete="off"
                                       oninput="ultimateStudio.handleMultiClubInput(this, 'target')"
                                       onfocus="ultimateStudio.showMultiClubSuggestions(this, 'target')"
                                       onblur="ultimateStudio.hideMultiClubSuggestions(this, 'target')">
                                <i class="fas fa-bullseye input-icon"></i>
                                <div class="club-suggestions-container multi-club-suggestions"></div>
                                <div class="club-logo-preview multi-club-logo-preview"></div>
                            </div>

                            <!-- Player Image URL -->
                            <div class="ultimate-input-group">
                                <input type="url" class="ultimate-input multi-player-image" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                                <i class="fas fa-image input-icon"></i>
                            </div>
                        </div>
                    </div>

                    <div class="row g-2 mb-3">
                        <div class="col-4">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.addManualMultiPlayer()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-plus"></i> Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.addSavedMultiPlayer()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-database"></i> Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.removeMultiPlayer()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-minus"></i> Ø­Ø°Ù
                            </button>
                        </div>
                    </div>

                    <!-- Quick Export/Import Controls -->
                    <div class="row g-2 mb-3">
                        <div class="col-6">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.exportPlayerData()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-secondary-ultimate" onclick="ultimateStudio.importPlayerData()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
                            </button>
                        </div>
                    </div>

                    <!-- Display Mode Selection -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="multiDisplayMode" onchange="ultimateStudio.toggleSequenceSettings(this.value)">
                            <option value="all">ðŸŽ¬ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø¹Ø§Ù‹</option>
                            <option value="sequence">â±ï¸ Ø¹Ø±Ø¶ Ù…ØªØªØ§Ù„ÙŠ (Ù„Ø§Ø¹Ø¨ Ø¨Ø¹Ø¯ Ù„Ø§Ø¹Ø¨)</option>
                        </select>
                    </div>

                    <!-- Sequence Settings -->
                    <div id="sequenceSettings" style="display: none;">
                        <div class="ultimate-input-group">
                            <input type="number" class="ultimate-input" id="sequenceInterval" value="3" min="1" max="10" placeholder="Ø§Ù„ÙØªØ±Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ">
                            <i class="fas fa-clock input-icon"></i>
                        </div>
                    </div>

                    <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.createMultiVisualization()">
                        <i class="fas fa-rocket me-2"></i>
                        Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
                    </button>
                </div>

                <!-- Player Data Extraction Section -->
                <div class="ultimate-section" id="extractSection" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-link section-icon"></i>
                        Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† ØµÙØ­ØªÙ‡
                    </div>

                    <div class="extraction-info" style="
                        background: rgba(59, 130, 246, 0.1);
                        border: 1px solid rgba(59, 130, 246, 0.3);
                        border-radius: 12px;
                        padding: 15px;
                        margin-bottom: 20px;
                    ">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <i class="fas fa-info-circle" style="color: #3b82f6; margin-left: 10px;"></i>
                            <strong style="color: #3b82f6;">Ù…ÙŠØ²Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ¹ØµØ±ÙŠØ©!</strong>
                        </div>
                        <p style="font-size: 0.9rem; opacity: 0.9; margin: 0;">
                            Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Transfermarkt Ø£Ùˆ Ù…ÙˆØ§Ù‚Ø¹ Ø£Ø®Ø±Ù‰ØŒ ÙˆØ³ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                        </p>
                    </div>

                    <!-- Player Page URL -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-label">Ø±Ø§Ø¨Ø· ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨:</label>
                        <input type="url" class="ultimate-input" id="playerPageUrl"
                               placeholder="https://www.transfermarkt.com/player/profil/spieler/123456">
                        <i class="fas fa-link input-icon"></i>
                    </div>

                    <!-- Target Club -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-label">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡:</label>
                        <input type="text" class="ultimate-input smart-club-input" id="extractTargetClub"
                               placeholder="Ù…Ø«Ø§Ù„: Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯ØŒ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©ØŒ Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ"
                               autocomplete="off"
                               oninput="ultimateStudio.handleClubInput(this, 'extractTarget')"
                               onfocus="ultimateStudio.showClubSuggestions(this, 'extractTarget')"
                               onblur="ultimateStudio.hideClubSuggestions(this, 'extractTarget')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container" id="extractTargetClubSuggestions"></div>
                        <div class="club-logo-preview" id="extractTargetClubLogoPreview"></div>
                    </div>

                    <!-- Supported Sites -->
                    <div class="supported-sites" style="
                        background: rgba(16, 185, 129, 0.1);
                        border: 1px solid rgba(16, 185, 129, 0.3);
                        border-radius: 12px;
                        padding: 15px;
                        margin: 15px 0;
                    ">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <i class="fas fa-check-circle" style="color: #10b981; margin-left: 10px;"></i>
                            <strong style="color: #10b981;">Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©:</strong>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85rem;">
                            <div>â€¢ Transfermarkt.com</div>
                            <div>â€¢ SoFIFA.com</div>
                            <div>â€¢ FUTBin.com</div>
                            <div>â€¢ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹...</div>
                        </div>
                    </div>

                    <!-- Extract Button -->
                    <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.extractPlayerData()" id="extractBtn">
                        <i class="fas fa-download"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                    </button>

                    <!-- Extraction Results -->
                    <div id="extractionResults" style="
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(0, 0, 0, 0.3);
                        border-radius: 12px;
                        display: none;
                    ">
                        <div class="extraction-header" style="
                            display: flex;
                            align-items: center;
                            margin-bottom: 15px;
                            color: #10b981;
                            font-weight: 600;
                        ">
                            <i class="fas fa-check-circle" style="margin-left: 10px;"></i>
                            ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!
                        </div>
                        <div id="extractedData" style="font-size: 0.9rem;"></div>

                        <div class="extraction-actions" style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.useExtractedData()" style="font-size: 0.9rem;">
                                <i class="fas fa-check"></i> Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.editExtractedData()" style="font-size: 0.9rem;">
                                <i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                    </div>

                    <!-- Quick Examples -->
                    <div class="quick-examples" style="margin-top: 20px;">
                        <div style="
                            color: rgba(255, 255, 255, 0.8);
                            font-size: 0.9rem;
                            margin-bottom: 10px;
                            font-weight: 600;
                        ">
                            <i class="fas fa-lightbulb" style="margin-left: 8px; color: #fbbf24;"></i>
                            Ø£Ù…Ø«Ù„Ø© Ø³Ø±ÙŠØ¹Ø©:
                        </div>
                        <div class="examples-grid" style="display: grid; gap: 8px;">
                            <button class="example-btn" onclick="ultimateStudio.loadExample('salah')" style="
                                background: rgba(255, 255, 255, 0.05);
                                border: 1px solid rgba(255, 255, 255, 0.1);
                                border-radius: 8px;
                                padding: 8px 12px;
                                color: white;
                                font-size: 0.8rem;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                text-align: right;
                            " onmouseover="this.style.background='rgba(255, 255, 255, 0.1)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.05)'">
                                <i class="fas fa-star" style="margin-left: 5px; color: #fbbf24;"></i>
                                Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­ â† Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯
                            </button>
                            <button class="example-btn" onclick="ultimateStudio.loadExample('mbappe')" style="
                                background: rgba(255, 255, 255, 0.05);
                                border: 1px solid rgba(255, 255, 255, 0.1);
                                border-radius: 8px;
                                padding: 8px 12px;
                                color: white;
                                font-size: 0.8rem;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                text-align: right;
                            " onmouseover="this.style.background='rgba(255, 255, 255, 0.1)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.05)'">
                                <i class="fas fa-fire" style="margin-left: 5px; color: #ef4444;"></i>
                                Ù…Ø¨Ø§Ø¨ÙŠ â† Ù„ÙŠÙØ±Ø¨ÙˆÙ„
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI Section -->
                <div class="ultimate-section" id="aiSection" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-brain section-icon"></i>
                        Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
                    </div>

                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input" id="aiPrompt" placeholder="Ø§ÙˆØµÙ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„...">
                        <i class="fas fa-magic input-icon"></i>
                    </div>

                    <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.generateWithAI()">
                        <i class="fas fa-brain me-2"></i>
                        Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                    </button>
                </div>

                <!-- Card Style Settings -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-id-card section-icon"></i>
                        Ù†Ù…Ø· Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨
                    </div>

                    <!-- Card Design Template -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-label">ðŸŽ¨ Ù‚Ø§Ù„Ø¨ Ø§Ù„ØªØµÙ…ÙŠÙ…</label>
                        <select class="ultimate-select" id="cardDesignSelect" onchange="ultimateStudio.setCardDesignAndPreview(this.value)">
                            <option value="financial">ðŸ’° Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø§Ù„ÙŠ (Ø§Ù„Ø­Ø§Ù„ÙŠ)</option>
                            <option value="modern">ðŸ† Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø­Ø¯ÙŠØ« (FIFA Style)</option>
                            <option value="minimalist">âœ¨ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø³ÙŠØ·</option>
                            <option value="glassmorphism">ðŸ”® Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ</option>
                            <option value="cyberpunk">ðŸ¤– Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø³Ø§ÙŠØ¨Ø±Ø¨Ø§Ù†Ùƒ</option>
                            <option value="neon">âš¡ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†ÙŠÙˆÙ†</option>
                            <option value="holographic">ðŸŒˆ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙˆÙ„ÙˆØ¬Ø±Ø§ÙÙŠ</option>
                        </select>

                        <!-- Quick Preview Button -->
                        <button class="ultimate-btn btn-info-ultimate mt-2" onclick="ultimateStudio.generateInstantPreview()" style="width: 100%; font-size: 0.9rem;">
                            <i class="fas fa-eye"></i> Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ù‚Ø§Ù„Ø¨
                        </button>
                    </div>

                    <!-- Card Style (Legacy) -->
                    <div class="ultimate-input-group" style="display: none;">
                        <select class="ultimate-select" id="cardStyle" onchange="ultimateStudio.changeCardStyle(this.value)">
                            <option value="fifa26">ðŸŽ® ÙÙŠÙØ§ 26 - Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…Ø­Ø³Ù†</option>
                        </select>
                    </div>

                    <!-- Card Transition Type -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-magic" style="margin-left: 8px;"></i>
                            Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (In/Out)
                        </label>
                        <select class="ultimate-select" id="cardTransition" onchange="ultimateStudio.changeCardTransition(this.value)">
                            <option value="fadeIn">ðŸŒŸ Fade In - ØªÙ„Ø§Ø´ÙŠ ØªØ¯Ø±ÙŠØ¬ÙŠ</option>
                            <option value="wipeUp">â¬†ï¸ Linear Wipe Up - Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
                            <option value="wipeDown">â¬‡ï¸ Linear Wipe Down - Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„Ø£Ø³ÙÙ„</option>
                            <option value="wipeLeft">â¬…ï¸ Linear Wipe Left - Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„ÙŠØ³Ø§Ø±</option>
                            <option value="wipeRight">âž¡ï¸ Linear Wipe Right - Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„ÙŠÙ…ÙŠÙ†</option>
                            <option value="irisWipe">ðŸŽ¯ Iris Wipe In - Ù…Ø³Ø­ Ø¯Ø§Ø¦Ø±ÙŠ</option>
                            <option value="slideFromBelow">â¬†ï¸ Slide From Below - Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„</option>
                            <option value="slideFromAbove">â¬‡ï¸ Slide From Above - Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
                            <option value="slideFromLeft">âž¡ï¸ Slide From Left - Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø±</option>
                            <option value="slideFromRight">â¬…ï¸ Slide From Right - Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†</option>
                            <option value="slideFadeBelow">ðŸŒŸâ¬†ï¸ Slide & Fade From Below - Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„</option>
                            <option value="slideFadeAbove">ðŸŒŸâ¬‡ï¸ Slide & Fade From Above - Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
                            <option value="slideFadeLeft">ðŸŒŸâž¡ï¸ Slide & Fade From Left - Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø±</option>
                            <option value="slideFadeRight">ðŸŒŸâ¬…ï¸ Slide & Fade From Right - Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†</option>
                            <option value="flipVertical">ðŸ”„ Flip Vertically - Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ</option>
                            <option value="flipHorizontal">ðŸ”ƒ Flip Horizontally - Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ</option>
                            <option value="expandIn">ðŸ“ˆ Expand In - ØªÙˆØ³Ø¹ ØªØ¯Ø±ÙŠØ¬ÙŠ</option>
                            <option value="bounceExpand">ðŸŽ¾ Bounce + Expand - Ø§Ø±ØªØ¯Ø§Ø¯ ÙˆØªÙˆØ³Ø¹</option>
                        </select>
                    </div>

                    <!-- Transition Duration -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-clock" style="margin-left: 8px;"></i>
                            Ù…Ø¯Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„: <span id="transitionDurationValue">1.0</span> Ø«Ø§Ù†ÙŠØ©
                        </label>
                        <input type="range" class="ultimate-range" id="transitionDuration"
                               min="0.3" max="3.0" value="1.0" step="0.1"
                               onchange="ultimateStudio.updateTransitionDuration(this.value)"
                               style="
                                   width: 100%;
                                   height: 8px;
                                   border-radius: 5px;
                                   background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
                                   outline: none;
                                   -webkit-appearance: none;
                               ">
                    </div>

                    <!-- Card Show/Hide Controls -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-play-circle" style="margin-left: 8px;"></i>
                            ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </label>
                        <div class="row g-2">
                            <div class="col-6">
                                <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.showCard()" style="
                                    font-size: 0.9rem;
                                    padding: 12px;
                                    width: 100%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    gap: 8px;
                                ">
                                    <i class="fas fa-eye"></i>
                                    Ø¥Ø¸Ù‡Ø§Ø± (In)
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="ultimate-btn btn-danger-ultimate" onclick="ultimateStudio.hideCard()" style="
                                    font-size: 0.9rem;
                                    padding: 12px;
                                    width: 100%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    gap: 8px;
                                    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
                                    border: none;
                                    border-radius: 12px;
                                    color: white;
                                    font-weight: 600;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(239, 68, 68, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(239, 68, 68, 0.3)'">
                                    <i class="fas fa-eye-slash"></i>
                                    Ø¥Ø®ÙØ§Ø¡ (Out)
                                </button>
                            </div>
                        </div>
                        <!-- Test Transition Button -->
                        <div class="row g-2 mt-2">
                            <div class="col-12">
                                <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.testCurrentTransition()" style="
                                    font-size: 0.8rem;
                                    padding: 10px;
                                    width: 100%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    gap: 8px;
                                    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
                                    border: none;
                                    border-radius: 12px;
                                    color: white;
                                    font-weight: 600;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(139, 92, 246, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(139, 92, 246, 0.3)'">
                                    <i class="fas fa-magic"></i>
                                    Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Background Settings -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-palette section-icon"></i>
                        Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                    </div>

                    <!-- Background Theme -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="visualTheme" onchange="ultimateStudio.changeTheme(this.value)">
                            <option value="cosmic">ðŸŒŒ ÙƒÙˆÙ†ÙŠ Ø¹ØµØ±ÙŠ - Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
                            <option value="neon">âš¡ Ù†ÙŠÙˆÙ† Ø³Ø§ÙŠØ¨Ø± Ù…ØªØ­Ø±Ùƒ</option>
                            <option value="holographic">ðŸŒˆ Ù‡ÙˆÙ„ÙˆØ¬Ø±Ø§ÙÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯</option>
                            <option value="quantum">âš›ï¸ ÙƒÙ…ÙŠ Ù…ØªÙ‚Ø¯Ù… Ù†Ø§Ø¨Ø¶</option>
                            <option value="futuristic">ðŸš€ Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ 2025 Ù…ØªØ¯ÙÙ‚</option>
                            <option value="financial">ðŸ’° Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯</option>
                            <option value="matrix">ðŸ”¢ Ù…Ø§ØªØ±ÙŠÙƒØ³ Ø±Ù‚Ù…ÙŠ Ù…ØªØ­Ø±Ùƒ</option>
                            <option value="cyberpunk">ðŸŒƒ Ø³Ø§ÙŠØ¨Ø± Ø¨Ø§Ù†Ùƒ 2077</option>
                        </select>
                    </div>


                </div>

                <!-- Advanced Settings 2025 -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-sliders-h section-icon"></i>
                        Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
                    </div>

                    <!-- Animation Speed -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="animationSpeed">
                            <option value="slow">ðŸŒ Ø¨Ø·ÙŠØ¡ - Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ</option>
                            <option value="normal" selected>âš¡ Ø¹Ø§Ø¯ÙŠ - Ù…ØªÙˆØ§Ø²Ù†</option>
                            <option value="fast">ðŸš€ Ø³Ø±ÙŠØ¹ - Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ</option>
                            <option value="instant">âš¡ ÙÙˆØ±ÙŠ - Ù…Ø¨Ø§Ø´Ø±</option>
                        </select>
                    </div>

                    <!-- Particle Effects -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="particleEffects">
                            <option value="enabled" selected>âœ¨ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª - Ù…ÙØ¹Ù„Ø©</option>
                            <option value="disabled">ðŸš« ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª - Ù…Ø¹Ø·Ù„Ø©</option>
                            <option value="enhanced">ðŸŒŸ ØªØ£Ø«ÙŠØ±Ø§Øª Ù…Ø­Ø³Ù†Ø© - Ù‚ÙˆÙŠØ©</option>
                        </select>
                    </div>

                    <!-- Sound Effects -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="soundEffects">
                            <option value="enabled" selected>ðŸ”Š Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© - Ù…ÙØ¹Ù„Ø©</option>
                            <option value="disabled">ðŸ”‡ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© - Ù…Ø¹Ø·Ù„Ø©</option>
                            <option value="enhanced">ðŸŽµ ØµÙˆØª Ù…Ø­Ø³Ù† - Ø³ØªÙŠØ±ÙŠÙˆ</option>
                        </select>
                    </div>

                    <!-- Player Image Size -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-expand-arrows-alt" style="margin-left: 8px;"></i>
                            Ø­Ø¬Ù… ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨: <span id="imageSizeValue">150</span>px
                        </label>
                        <input type="range" class="ultimate-range" id="playerImageSize"
                               min="100" max="300" value="150" step="10"
                               onchange="ultimateStudio.updateImageSizeDisplay(this.value)"
                               style="
                                   width: 100%;
                                   height: 8px;
                                   border-radius: 5px;
                                   background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
                                   outline: none;
                                   -webkit-appearance: none;
                               ">
                    </div>

                    <!-- Unified Club Logo Size -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-shield-alt" style="margin-left: 8px;"></i>
                            Ø­Ø¬Ù… Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ©: <span id="logoSizeValue">32</span>px
                        </label>
                        <input type="range" class="ultimate-range" id="clubLogoSize"
                               min="20" max="60" value="32" step="4"
                               onchange="ultimateStudio.updateUnifiedLogoSize(this.value)"
                               style="
                                   width: 100%;
                                   height: 8px;
                                   border-radius: 5px;
                                   background: linear-gradient(90deg, #10b981 0%, #059669 100%);
                                   outline: none;
                                   -webkit-appearance: none;
                               ">
                        <div style="display: flex; justify-content: space-between; color: rgba(255, 255, 255, 0.6); font-size: 0.8rem; margin-top: 4px;">
                            <span>ØµØºÙŠØ± (20px)</span>
                            <span>Ù…ØªÙˆØ³Ø· (40px)</span>
                            <span>ÙƒØ¨ÙŠØ± (60px)</span>
                        </div>
                    </div>

                    <!-- LM Studio Configuration -->
                    <div class="ultimate-input-group">
                        <label style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 8px; display: block;">
                            <i class="fas fa-robot" style="margin-left: 8px;"></i>
                            Ø±Ø§Ø¨Ø· LM Studio
                        </label>
                        <input type="text" class="ultimate-input" id="lmStudioURL"
                               placeholder="http://localhost:1234"
                               value="http://localhost:1234"
                               onchange="ultimateStudio.updateLMStudioURL(this.value)"
                               style="
                                   background: rgba(255, 255, 255, 0.05);
                                   border: 2px solid rgba(255, 255, 255, 0.1);
                                   border-radius: 12px;
                                   padding: 15px 20px;
                                   color: white;
                                   font-size: 0.95rem;
                                   transition: all 0.3s ease;
                                   width: 100%;
                               ">
                        <div class="row g-2 mt-2">
                            <div class="col-6">
                                <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.testLMStudioConnection()" style="font-size: 0.8rem; padding: 8px;">
                                    <i class="fas fa-wifi"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.autoDetectLMStudio()" style="font-size: 0.8rem; padding: 8px;">
                                    <i class="fas fa-search"></i> Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                                </button>
                            </div>
                        </div>
                        <div id="lmStudioStatus" style="
                            margin-top: 10px;
                            padding: 8px 12px;
                            border-radius: 8px;
                            font-size: 0.8rem;
                            text-align: center;
                            display: none;
                        "></div>
                    </div>

                    <!-- Auto-save -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select" id="autoSave">
                            <option value="enabled" selected>ðŸ’¾ Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ - Ù…ÙØ¹Ù„</option>
                            <option value="disabled">ðŸš« Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ - Ù…Ø¹Ø·Ù„</option>
                        </select>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-bolt section-icon"></i>
                        Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
                    </div>

                    <div class="row g-2">
                        <div class="col-6">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.randomPlayer()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-dice"></i> Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.exportCreation()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±
                            </button>
                        </div>
                    </div>

                    <div class="row g-2 mt-2">
                        <div class="col-6">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.resetSettings()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-undo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.saveSettings()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                            </button>
                        </div>
                    </div>

                    <div class="row g-2 mt-2">
                        <div class="col-6">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.testClubLogos()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.createTestPlayer()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-user-plus"></i> Ù„Ø§Ø¹Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ
                            </button>
                        </div>
                    </div>

                    <!-- Integration Controls -->
                    <div class="row g-2 mt-2">
                        <div class="col-6">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.showIntegrationStats()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-chart-bar"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.forceSyncWithExtractor()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-sync-alt"></i> Ù…Ø²Ø§Ù…Ù†Ø© Ù‚Ø³Ø±ÙŠØ©
                            </button>
                        </div>
                    </div>

                    <!-- Smart Club System Controls -->
                    <div class="row g-2 mt-2">
                        <div class="col-6">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.refreshClubsDatabase()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-database"></i> ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ù†Ø¯ÙŠØ©
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.showClubsDatabaseStats()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-chart-pie"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ©
                            </button>
                        </div>
                    </div>

                    <!-- Favorite Clubs Management -->
                    <div class="row g-2 mt-2">
                        <div class="col-4">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.showFavoriteClubs()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-star"></i> Ø§Ù„Ù…ÙØ¶Ù„Ø©
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.showRecentClubs()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-history"></i> Ø§Ù„Ø­Ø¯ÙŠØ«Ø©
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-secondary-ultimate" onclick="ultimateStudio.clearRecentClubs()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-trash"></i> Ù…Ø³Ø­
                            </button>
                        </div>
                    </div>

                    <!-- Advanced Favorite Management -->
                    <div class="row g-2 mt-1">
                        <div class="col-6">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.promptAddFavoriteClub()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-danger-ultimate" onclick="ultimateStudio.promptRemoveFavoriteClub()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-minus"></i> Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©
                            </button>
                        </div>
                    </div>

                    <!-- Real-time Sync Controls -->
                    <div class="row g-2 mt-2">
                        <div class="col-4">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.showRealTimeSyncStats()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-tachometer-alt"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙˆØ±ÙŠØ©
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.toggleRealTimeMonitoring()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-play-pause"></i> ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
                            </button>
                        </div>
                        <div class="col-4">
                            <button class="ultimate-btn btn-secondary-ultimate" onclick="ultimateStudio.forceRealTimeSync()" style="font-size: 0.8rem; padding: 10px;">
                                <i class="fas fa-bolt"></i> Ù…Ø²Ø§Ù…Ù†Ø© ÙÙˆØ±ÙŠØ©
                            </button>
                        </div>
                    </div>

                    <!-- Logo Management -->
                    <div class="row g-2 mt-2">
                        <div class="col-12">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="window.open('/club-logo-manager.html', '_blank')" style="font-size: 0.9rem; padding: 12px; width: 100%;">
                                <i class="fas fa-cogs"></i> Ø¥Ø¯Ø§Ø±Ø© Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ©
                            </button>
                        </div>
                    </div>

                    <!-- Data Management Controls -->
                    <div class="row g-2 mt-3">
                        <div class="col-6">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.exportPlayerData()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.importPlayerData()" style="font-size: 0.9rem; padding: 12px;">
                                <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                    </div>

                    <!-- Custom Title and Rights Controls -->
                    <div class="ultimate-section mt-3">
                        <div class="section-title">
                            <i class="fas fa-edit section-icon"></i>
                            ØªØ®ØµÙŠØµ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ§Ù„Ø­Ù‚ÙˆÙ‚
                        </div>

                        <div class="ultimate-input-group">
                            <label class="ultimate-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø®ØµØµ</label>
                            <input type="text" class="ultimate-input" id="customTitleInput"
                                   placeholder="Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ - Ultimate Studio V4"
                                   value="">
                            <button class="ultimate-btn btn-primary-ultimate mt-2" onclick="ultimateStudio.setCustomTitle(document.getElementById('customTitleInput').value)" style="width: 100%;">
                                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
                            </button>
                        </div>

                        <div class="ultimate-input-group">
                            <label class="ultimate-label">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù‚Ù†Ø§Ø©</label>
                            <input type="text" class="ultimate-input" id="channelRightsInput"
                                   placeholder="Â© Ultimate Studio V4 - Professional Broadcasting"
                                   value="">
                            <button class="ultimate-btn btn-primary-ultimate mt-2" onclick="ultimateStudio.setChannelRights(document.getElementById('channelRightsInput').value)" style="width: 100%;">
                                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø­Ù‚ÙˆÙ‚
                            </button>
                        </div>


                    </div>

                    <!-- System Testing -->
                    <div class="row g-2 mt-2">
                        <div class="col-3">
                            <button class="ultimate-btn btn-success-ultimate" onclick="ultimateStudio.runQuickTest()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-bolt"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹
                            </button>
                        </div>
                        <div class="col-3">
                            <button class="ultimate-btn btn-warning-ultimate" onclick="ultimateStudio.runComprehensiveTests()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„
                            </button>
                        </div>
                        <div class="col-3">
                            <button class="ultimate-btn btn-info-ultimate" onclick="ultimateStudio.showSystemHealthStatus()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-heartbeat"></i> ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                            </button>
                        </div>
                        <div class="col-3">
                            <button class="ultimate-btn btn-primary-ultimate" onclick="ultimateStudio.testDirectConnection()" style="font-size: 0.7rem; padding: 8px;">
                                <i class="fas fa-link"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø¨Ø·
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ðŸŽ¬ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¯Ù…Ø¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <div class="ultimate-section">
                    <div class="section-title">
                        <i class="fas fa-video section-icon"></i>
                        Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¯Ù…Ø¬ - Professional
                    </div>

                    <!-- Stream Status -->
                    <div class="simple-stream-status">
                        <div class="stream-info-display">
                            <div class="stream-indicator live" id="newStreamStatus"></div>
                            <span id="newStreamText">Ø§Ù„Ø¨Ø« Ù†Ø´Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ðŸ”´</span>
                        </div>
                        <div style="
                            background: rgba(34, 197, 94, 0.1);
                            border: 1px solid rgba(34, 197, 94, 0.3);
                            border-radius: 10px;
                            padding: 12px;
                            color: #22c55e;
                            text-align: center;
                            font-size: 0.9rem;
                        ">
                            <i class="fas fa-check-circle" style="margin-left: 8px;"></i>
                            Ø§Ù„Ø¨Ø« ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø¨Ø¯Ø¡ ÙŠØ¯ÙˆÙŠ
                        </div>
                    </div>

                    <!-- Stream URL -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-label">Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù€ OBS:</label>
                        <div class="url-display-container">
                            <input type="text" id="directStreamUrl" readonly class="ultimate-input url-input"
                                   value="http://localhost:8201/stream-clean">
                            <button class="url-copy-btn" onclick="window.copyDirectStreamUrl ? window.copyDirectStreamUrl() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <small style="color: #888; margin-top: 5px; display: block;">
                            ðŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ OBS ÙƒÙ…ØµØ¯Ø± Browser Source
                        </small>
                    </div>

                    <!-- Stream Controls -->
                    <div class="stream-control-buttons">
                        <button class="ultimate-btn btn-primary-ultimate" onclick="window.sendToDirectStream ? window.sendToDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-broadcast-tower"></i> Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                        </button>
                        <button class="ultimate-btn btn-success-ultimate" onclick="window.sendCurrentToOBS ? window.sendCurrentToOBS() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')" title="Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ OBS File System">
                            <i class="fas fa-file-alt"></i> Ø¥Ø±Ø³Ø§Ù„ Ù„Ù€ OBS
                        </button>
                        <button class="ultimate-btn btn-warning-ultimate" onclick="window.hideFromDirectStream ? window.hideFromDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-eye-slash"></i> Ø¥Ø®ÙØ§Ø¡ Ù…Ù† Ø§Ù„Ø¨Ø«
                        </button>
                        <button class="ultimate-btn btn-info-ultimate" onclick="window.openDirectStream ? window.openDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-external-link-alt"></i> ÙØªØ­ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                        </button>
                        <button class="ultimate-btn btn-secondary-ultimate" onclick="window.open('/obs-file-system.html', '_blank')" title="ÙØªØ­ OBS File System">
                            <i class="fas fa-desktop"></i> ÙØªØ­ OBS
                        </button>
                    </div>

                    <!-- Auto Stream -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-checkbox-label">
                            <input type="checkbox" id="autoSendToDirectStream" class="ultimate-checkbox" checked>
                            <span class="checkmark"></span>
                            Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </label>
                    </div>

                    <!-- Auto OBS File System -->
                    <div class="ultimate-input-group">
                        <label class="ultimate-checkbox-label">
                            <input type="checkbox" id="autoSendToOBSFileSystem" class="ultimate-checkbox" checked>
                            <span class="checkmark"></span>
                            Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù€ OBS File System Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </label>
                    </div>

                    <!-- Quick Actions -->
                    <div class="stream-quick-actions">
                        <button class="ultimate-btn-small btn-info-ultimate" onclick="window.openDirectStream ? window.openDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-external-link-alt"></i> ÙØªØ­ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                        </button>
                        <button class="ultimate-btn-small btn-secondary-ultimate" onclick="window.clearDirectStream ? window.clearDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø§Ù„Ø¨Ø«
                        </button>
                        <button class="ultimate-btn-small btn-warning-ultimate" onclick="window.testDirectStream ? window.testDirectStream() : alert('Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© Ø¨Ø¹Ø¯')">
                            <i class="fas fa-vial"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø±
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ðŸŽ¬ Integrated Stream Overlay -->
    <div id="streamOverlay" class="stream-overlay-container">
        <div class="stream-content">
            <!-- Stream Player Card -->
            <div id="streamPlayerCard" class="stream-player-card"></div>

            <!-- Stream Lower Third -->
            <div id="streamLowerThird" class="stream-lower-third">
                <h3 id="streamLowerTitle">Ø¹Ø§Ø¬Ù„: ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <p id="streamLowerText">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„...</p>
            </div>

            <!-- Stream Ticker -->
            <div id="streamTicker" class="stream-ticker">
                <div class="ticker-content" id="streamTickerContent">
                    ðŸ”¥ Ø¢Ø®Ø± Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª â€¢ âš½ Ù…ÙŠØ³ÙŠ ÙŠÙ†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù†Ø§Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯ â€¢ ðŸ’° ØµÙÙ‚Ø© Ø¨Ù‚ÙŠÙ…Ø© 100 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ â€¢ ðŸ† ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø³ØªÙ…Ø±Ø©
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        console.log('ðŸš€ Ultimate Studio V4 - Initializing Quantum Systems...');

        // ðŸŽ¬ DIRECT STREAM SYSTEM - Load functions FIRST
        console.log('ðŸš€ Loading Direct Stream System Functions...');

        // Global variables for direct stream
        window.directStreamActive = false;
        window.directStreamUrl = 'http://localhost:8201/stream-clean';

        // Toggle direct stream
        window.toggleDirectStream = function() {
            console.log('ðŸŽ¬ toggleDirectStream called');

            window.directStreamActive = !window.directStreamActive;

            // Store state in localStorage
            localStorage.setItem('directStreamActive', window.directStreamActive.toString());
            localStorage.setItem('directStreamStateChanged', Date.now().toString());

            // Send to server API for OBS compatibility
            fetch('/api/stream-data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    active: window.directStreamActive
                })
            }).then(response => response.json())
              .then(data => console.log('ðŸ“¡ Stream state sent to server:', data))
              .catch(error => console.error('âŒ Error sending stream state:', error));

            // Update UI
            window.updateDirectStreamUI();

            // Show notification
            const message = window.directStreamActive ? 'ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±';
            alert(message);

            console.log('âœ… Direct stream state:', window.directStreamActive);
        };

        // Apply current size settings to content for stream synchronization
        window.applyCurrentSizesToContent = function(htmlContent) {
            console.log('ðŸ”§ Applying current size settings to content for stream sync');

            // Get current settings
            const playerImageSize = document.getElementById('playerImageSize')?.value || 150;
            const clubLogoSize = document.getElementById('clubLogoSize')?.value || 32;

            console.log(`ðŸ“ Current sizes - Player: ${playerImageSize}px, Logo: ${clubLogoSize}px`);

            // Create a temporary container to manipulate the HTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;

            // Update player images
            const playerImages = tempDiv.querySelectorAll('img[alt*="ØµÙˆØ±Ø©"], img[src*="player"], .player-image img, .player-photo img');
            playerImages.forEach(img => {
                img.style.width = playerImageSize + 'px';
                img.style.height = playerImageSize + 'px';
                console.log(`ðŸ–¼ï¸ Updated player image size to ${playerImageSize}px`);
            });

            // Update club logos with intelligent sizing
            const baseSize = parseInt(clubLogoSize);
            const smallSize = Math.max(16, baseSize - 8);
            const mediumSize = baseSize;
            const largeSize = Math.min(80, baseSize + 20);

            const clubLogos = tempDiv.querySelectorAll('img[src*="logo"], img[src*="crest"], img[alt*="Ø§Ù„Ù†Ø§Ø¯ÙŠ"], img[alt*="Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"]');
            clubLogos.forEach(img => {
                let targetSize = mediumSize;

                // Determine context and apply appropriate size
                if (img.closest('.target-club-logo-large')) {
                    targetSize = largeSize;
                } else if (img.classList.contains('club-logo-small') || img.closest('.card-footer')) {
                    targetSize = smallSize;
                } else if (img.classList.contains('target-club-logo') || img.alt?.includes('Ø§Ù„Ù…Ø·Ù„ÙˆØ¨')) {
                    targetSize = mediumSize + 4;
                }

                img.style.width = targetSize + 'px';
                img.style.height = targetSize + 'px';
                console.log(`ðŸ† Updated club logo size to ${targetSize}px`);
            });

            console.log('âœ… Size settings applied to content for stream sync');
            return tempDiv.innerHTML;
        };

        // Send current content to direct stream - ENHANCED ULTIMATE VERSION
        window.sendToDirectStream = function() {
            console.log('ðŸŽ¬ sendToDirectStream called - ENHANCED VERSION');

            // Auto-enable streaming if not active
            if (!window.directStreamActive) {
                console.log('ðŸ”„ Auto-enabling direct stream...');
                window.directStreamActive = true;
                localStorage.setItem('directStreamActive', 'true');
            }

            // Get current content from previewContent
            const previewContent = document.getElementById('previewContent');
            if (!previewContent || !previewContent.innerHTML.trim()) {
                console.log('âš ï¸ No content to send');
                alert('âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡. ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            // Apply current size settings to content before sending
            let contentHtml = previewContent.innerHTML;
            contentHtml = window.applyCurrentSizesToContent(contentHtml);

            // Prepare content data with enhanced metadata
            const contentData = {
                html: contentHtml,
                timestamp: Date.now(),
                source: 'Ultimate Studio V4',
                id: 'content_' + Date.now(),
                version: '2.0'
            };

            console.log('ðŸ“¦ Preparing to send content:', {
                size: contentData.html.length,
                timestamp: contentData.timestamp,
                id: contentData.id
            });

            // Store content for direct stream (localStorage for browser compatibility)
            localStorage.setItem('directStreamActive', 'true');
            localStorage.setItem('directStreamContent', JSON.stringify(contentData));
            localStorage.setItem('directStreamContentChanged', Date.now().toString());
            localStorage.setItem('directStreamLastUpdate', Date.now().toString());

            // ðŸ“ NEW: Send to OBS File System as well
            window.sendToOBSFileSystem(contentData);

            console.log('ðŸ’¾ Content stored in localStorage successfully');

            // Send to server API for OBS compatibility - ENHANCED
            const sendToServer = async () => {
                try {
                    console.log('ðŸ“¡ Sending to server...');
                    const response = await fetch('/api/stream-data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Cache-Control': 'no-cache'
                        },
                        body: JSON.stringify({
                            active: true,
                            content: contentData
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    console.log('ðŸ“¡ Content sent to server successfully:', data);

                    // Show success message silently
                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­');
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    }

                    return true;
                } catch (error) {
                    console.error('âŒ Error sending content to server:', error);
                    console.log('ðŸ“± Using localStorage fallback mode');
                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (ÙˆØ¶Ø¹ Ù…Ø­Ù„ÙŠ)');
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'success');
                    }
                    return false;
                }
            };

            // Execute server send
            sendToServer();

            // Trigger multiple events for cross-tab communication
            setTimeout(() => {
                console.log('ðŸ”„ Triggering storage events...');

                // Trigger storage event
                window.dispatchEvent(new StorageEvent('storage', {
                    key: 'directStreamContent',
                    newValue: JSON.stringify(contentData),
                    storageArea: localStorage
                }));

                // Trigger custom event
                window.dispatchEvent(new CustomEvent('directStreamUpdate', {
                    detail: contentData
                }));

                // Force update localStorage again to ensure it's saved
                localStorage.setItem('directStreamContent', JSON.stringify(contentData));
                localStorage.setItem('directStreamContentChanged', Date.now().toString());

                console.log('âœ… All events triggered successfully');
            }, 100);

            console.log('âœ… Content sent to direct stream:', contentData);
        };

        // Hide content from direct stream
        window.hideFromDirectStream = function() {
            console.log('ðŸŽ¬ hideFromDirectStream called');

            localStorage.removeItem('directStreamContent');
            localStorage.setItem('directStreamContentChanged', Date.now().toString());

            alert('âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ù† Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            console.log('âœ… Content hidden from direct stream');
        };

        // Open direct stream window
        window.openDirectStream = function() {
            window.open(window.directStreamUrl, 'DirectStreamView', 'width=1920,height=1080,scrollbars=no,resizable=yes');
            console.log('âœ… Direct stream window opened');
        };

        // Copy direct stream URL
        window.copyDirectStreamUrl = function() {
            navigator.clipboard.writeText(window.directStreamUrl).then(() => {
                alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            }).catch(() => {
                prompt('Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:', window.directStreamUrl);
            });
        };

        // ðŸ“ NEW: Send to OBS File System
        window.sendToOBSFileSystem = async function(contentData) {
            try {
                console.log('ðŸ“ Sending to OBS File System...');

                const obsData = {
                    active: true,
                    html: contentData.html,
                    timestamp: contentData.timestamp,
                    id: contentData.id,
                    source: 'Pro Studio V4 Ultimate'
                };

                const response = await fetch('/api/update-stream', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(obsData)
                });

                if (response.ok) {
                    console.log('âœ… Content sent to OBS File System successfully');
                } else {
                    console.error('âŒ Failed to send to OBS File System:', response.status);
                }

            } catch (error) {
                console.error('âŒ Error sending to OBS File System:', error);
            }
        };

        // Clear direct stream
        window.clearDirectStream = function() {
            localStorage.removeItem('directStreamContent');
            localStorage.removeItem('directStreamActive');
            localStorage.setItem('directStreamCleared', Date.now().toString());

            window.directStreamActive = false;
            window.updateDirectStreamUI();

            // ðŸ“ NEW: Clear OBS File System as well
            window.clearOBSFileSystem();

            alert('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            console.log('âœ… Direct stream cleared');
        };

        // ðŸ“ NEW: Clear OBS File System
        window.clearOBSFileSystem = async function() {
            try {
                const clearData = {
                    active: false,
                    html: '',
                    timestamp: Date.now(),
                    id: 'clear_' + Date.now(),
                    source: 'Pro Studio V4 Clear'
                };

                await fetch('/api/update-stream', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(clearData)
                });

                console.log('âœ… OBS File System cleared');
            } catch (error) {
                console.error('âŒ Error clearing OBS File System:', error);
            }
        };

        // ðŸ“ NEW: Send current content to OBS File System
        window.sendCurrentToOBS = function() {
            console.log('ðŸ“ Sending current content to OBS File System...');

            const previewContent = document.getElementById('previewContent');
            if (!previewContent || !previewContent.innerHTML.trim()) {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡! Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ù„Ø§Ø¹Ø¨ Ø£ÙˆÙ„Ø§Ù‹.');
                return;
            }

            // Get current content with size adjustments
            const currentHTML = window.applyCurrentSizesToContent ?
                window.applyCurrentSizesToContent(previewContent.innerHTML) :
                previewContent.innerHTML;

            const contentData = {
                html: currentHTML,
                timestamp: Date.now(),
                id: 'obs_manual_' + Date.now(),
                source: 'Pro Studio V4 Manual'
            };

            // Send to OBS File System
            window.sendToOBSFileSystem(contentData);

            // Show success message
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ù„Ù‰ OBS File System', 'success');
            } else {
                console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ù„Ù‰ OBS File System');
            }
        };

        // Test direct stream
        window.testDirectStream = function() {
            console.log('ðŸ§ª Testing direct stream system...');

            // Start stream
            window.directStreamActive = true;
            localStorage.setItem('directStreamActive', 'true');
            window.updateDirectStreamUI();

            // Create test content
            const testContent = {
                html: `
                    <div class="fifa-card" style="
                        background: linear-gradient(135deg, #1e3c72, #2a5298);
                        border: 3px solid transparent;
                        border-radius: 25px;
                        padding: 40px;
                        color: white;
                        text-align: center;
                        width: 450px;
                        min-height: 550px;
                    ">
                        <h2 style="font-size: 36px; margin-bottom: 20px;">Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­</h2>
                        <div style="margin: 30px 0;">
                            <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">Ù„ÙŠÙØ±Ø¨ÙˆÙ„</div>
                                <div style="font-size: 24px;">â†</div>
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯</div>
                            </div>
                        </div>
                        <div style="margin: 40px 0;">
                            <div style="font-size: 48px; font-weight: bold; color: #10b981;">85%</div>
                            <div style="font-size: 18px; opacity: 0.8;">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</div>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin-top: 20px;">
                            Ø±Ø³ÙˆÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„: 100 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ
                        </div>
                    </div>
                `,
                timestamp: Date.now(),
                source: 'Test Data'
            };

            localStorage.setItem('directStreamContent', JSON.stringify(testContent));
            localStorage.setItem('directStreamContentChanged', Date.now().toString());

            alert('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            console.log('âœ… Direct stream test completed');
        };

        // Update direct stream UI
        window.updateDirectStreamUI = function() {
            const indicator = document.getElementById('newStreamStatus');
            const text = document.getElementById('newStreamText');
            const button = document.getElementById('newStreamBtn');

            console.log('ðŸ”„ Updating UI - Elements found:', {
                indicator: !!indicator,
                text: !!text,
                button: !!button,
                active: window.directStreamActive
            });

            if (indicator && text && button) {
                if (window.directStreamActive) {
                    indicator.classList.add('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± <span style="color: #ff0000;">ðŸ”´</span>';
                    button.innerHTML = '<i class="fas fa-stop"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-danger-ultimate';
                } else {
                    indicator.classList.remove('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…ØªÙˆÙ‚Ù <span style="color: #888;">âš«</span>';
                    button.innerHTML = '<i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-success-ultimate';
                }
                console.log('âœ… UI updated successfully');
            } else {
                console.error('âŒ UI elements not found');
            }
        };

        // Auto-send to direct stream when creating card - ENHANCED VERSION
        window.checkAutoSendToDirectStream = function() {
            const autoSend = document.getElementById('autoSendToDirectStream');
            if (autoSend && autoSend.checked) {
                console.log('ðŸŽ¬ Auto-send to direct stream triggered');

                // Auto-enable streaming if not active
                if (!window.directStreamActive) {
                    console.log('ðŸ”„ Auto-enabling direct stream for auto-send...');
                    window.directStreamActive = true;
                    localStorage.setItem('directStreamActive', 'true');
                }

                setTimeout(() => {
                    if (typeof window.sendToDirectStream === 'function') {
                        window.sendToDirectStream();
                        console.log('âœ… Auto-send to direct stream completed');
                    } else {
                        console.warn('âš ï¸ sendToDirectStream function not available');
                    }
                }, 1000);
            } else if (autoSend && !autoSend.checked) {
                console.log('ðŸ“º Auto-send to direct stream disabled by user');
            } else {
                console.log('âš ï¸ Auto-send checkbox not found');
            }
        };

        // ðŸ“ NEW: Auto-send to OBS File System when creating card
        window.checkAutoSendToOBSFileSystem = function() {
            const autoSend = document.getElementById('autoSendToOBSFileSystem');
            if (autoSend && autoSend.checked) {
                console.log('ðŸ“ Auto-send to OBS File System triggered');

                setTimeout(() => {
                    if (typeof window.sendCurrentToOBS === 'function') {
                        window.sendCurrentToOBS();
                        console.log('âœ… Auto-send to OBS File System completed');
                    } else {
                        console.warn('âš ï¸ sendCurrentToOBS function not available');
                    }
                }, 1500); // Slightly delayed after direct stream
            } else if (autoSend && !autoSend.checked) {
                console.log('ðŸ“ Auto-send to OBS File System disabled');
            } else {
                console.warn('âš ï¸ Auto-send OBS checkbox not found');
            }
        };

        console.log('âœ… Direct Stream Functions Loaded Successfully!');
        console.log('ðŸŽ¬ Available functions:', Object.keys(window).filter(key => key.includes('DirectStream') || key.includes('directStream')));

        // Initialize UI immediately when DOM is ready
        function initializeStreamUI() {
            // Load saved state
            const savedState = localStorage.getItem('directStreamActive') === 'true';
            if (savedState) {
                window.directStreamActive = savedState;
                console.log('ðŸ“‚ Loaded saved state:', window.directStreamActive);
            }

            // Update UI
            setTimeout(() => {
                window.updateDirectStreamUI();
                console.log('ðŸ”„ UI initialized');
            }, 100);
        }

        // Initialize immediately if DOM is ready, otherwise wait
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeStreamUI);
        } else {
            initializeStreamUI();
        }

        // ðŸŒŸ Ultimate Studio V4 - World-Class Creative System
        class UltimateStudio {
            constructor() {
                this.currentPlayer = null;
                this.isProcessing = false;
                this.visualizationStyles = ['cosmic', 'holographic', 'neon', 'quantum', 'cyberpunk'];
                this.currentStyle = 'cosmic';
                this.currentCardStyle = 'fifa26'; // Default card style
                this.particleSystem = null;
                this.audioContext = null;
                this.multiPlayers = [];
                this.sequenceTimer = null;
                this.currentSequenceIndex = 0;
                this.settings = this.loadSettings();

                // ðŸ† Football API Configuration
                this.footballAPI = {
                    token: '3f1dd06d6fab4b44bff09bdd9552411b',
                    baseUrl: 'https://api.football-data.org/v4',
                    headers: {
                        'X-Auth-Token': '3f1dd06d6fab4b44bff09bdd9552411b'
                    }
                };

                // ðŸŒ Club Database - Arabic to English mapping
                this.clubDatabase = this.initializeClubDatabase();
                this.leagueDatabase = this.initializeLeagueDatabase();

                // ðŸŽ¯ Smart Club System
                this.clubSuggestions = [];
                this.clubsDatabase = [];
                this.favoriteClubs = this.loadFavoriteClubs();
                this.recentClubs = this.loadRecentClubs();
                this.loadClubsDatabase();

                this.init();
            }

            init() {
                console.log('ðŸŽ¨ Initializing Ultimate Creative Engine...');
                this.setupParticleSystem();
                this.setupAudioSystem();
                this.loadSavedPlayers();
                this.startQuantumAnimations();
                this.initializeSettings();
                this.loadCustomSettings();
                // Apply default modern background
                this.applyModernBackground('cosmic');
                console.log('âœ¨ Ultimate Studio V4 Ready!');
            }

            // Load custom settings on startup
            loadCustomSettings() {
                // Load custom title
                setTimeout(() => {
                    const titleInput = document.getElementById('customTitleInput');
                    if (titleInput) {
                        titleInput.value = this.getCustomTitle();
                    }

                    // Load channel rights
                    const rightsInput = document.getElementById('channelRightsInput');
                    if (rightsInput) {
                        rightsInput.value = this.getChannelRights();
                    }

                    // Load card design
                    const designSelect = document.getElementById('cardDesignSelect');
                    if (designSelect) {
                        designSelect.value = this.getSelectedCardDesign();
                        console.log(`ðŸŽ¨ Loaded card design: ${this.getSelectedCardDesign()}`);
                    }
                }, 1000);
            }

            // ðŸŽ¯ CUSTOM TITLE AND CHANNEL RIGHTS SYSTEM
            getCustomTitle() {
                const savedTitle = localStorage.getItem('customStreamTitle');
                return savedTitle || 'Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ - Ultimate Studio V4';
            }

            setCustomTitle(title) {
                localStorage.setItem('customStreamTitle', title);
                this.showNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµ', 'success');
                this.updateDisplayedTitle();
            }

            getChannelRights() {
                const savedRights = localStorage.getItem('channelRights');
                return savedRights || 'Â© Ultimate Studio V4 - Professional Broadcasting';
            }

            setChannelRights(rights) {
                localStorage.setItem('channelRights', rights);
                this.showNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù‚Ù†Ø§Ø©', 'success');
                this.updateDisplayedRights();
            }

            updateDisplayedTitle() {
                const titleElement = document.getElementById('customTitle');
                if (titleElement) {
                    titleElement.textContent = this.getCustomTitle();
                }
            }

            updateDisplayedRights() {
                const rightsElement = document.getElementById('channelRights');
                if (rightsElement) {
                    rightsElement.textContent = this.getChannelRights();
                }
            }

            // Card design system with instant preview
            setCardDesignAndPreview(design) {
                this.settings.cardDesign = design;
                this.saveSettings();
                this.showNotification(`âœ… ØªÙ… ØªØºÙŠÙŠØ± Ù‚Ø§Ù„Ø¨ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¥Ù„Ù‰: ${this.getCardDesignName(design)}`, 'success');

                // Update UI
                const select = document.getElementById('cardDesignSelect');
                if (select) {
                    select.value = design;
                }

                // Generate instant preview if we have player data
                this.generateInstantPreview();
            }

            // Legacy function for backward compatibility
            setCardDesign(design) {
                this.setCardDesignAndPreview(design);
            }

            // Generate instant preview with current or sample data
            generateInstantPreview() {
                try {
                    let playerData = null;

                    // Check if we have current player data
                    if (this.currentPlayer && (this.currentPlayer.arabicName || this.currentPlayer.name)) {
                        playerData = this.currentPlayer;
                    } else {
                        // Use sample data for preview
                        playerData = {
                            arabicName: 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­',
                            name: 'Mohamed Salah',
                            currentClub: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„',
                            targetClub: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯',
                            age: '31',
                            position: 'Ø¬Ù†Ø§Ø­ Ø£ÙŠÙ…Ù†',
                            playerImage: '', // No image for sample
                            currentClubLogo: '',
                            targetClubLogo: '',
                            // Set probability in the expected format
                            probability: { percentage: 75 },
                            // Also set individual fields for compatibility
                            transferProbability: 75,
                            marketValue: 80000000,
                            contractYears: 2
                        };
                    }

                    // Ensure probability is set
                    if (!playerData.probability || !playerData.probability.percentage) {
                        playerData.probability = { percentage: 75 }; // Default for preview
                    }

                    // Generate preview
                    const previewContent = document.getElementById('previewContent');
                    const placeholder = document.getElementById('previewPlaceholder');

                    if (previewContent) {
                        if (placeholder) {
                            placeholder.style.display = 'none';
                        }

                        const visualizationHTML = this.createPlayerCardHTML(playerData);
                        previewContent.innerHTML = visualizationHTML;

                        // Show preview message
                        const designName = this.getCardDesignName(this.getSelectedCardDesign());
                        this.showNotification(`ðŸŽ¨ Ù…Ø¹Ø§ÙŠÙ†Ø© ${designName}`, 'info');
                    }
                } catch (error) {
                    console.error('Error generating instant preview:', error);
                    this.showNotification('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©', 'warning');
                }
            }

            getCardDesignName(design) {
                const names = {
                    'financial': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø§Ù„ÙŠ',
                    'modern': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø­Ø¯ÙŠØ«',
                    'minimalist': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø³ÙŠØ·',
                    'glassmorphism': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ',
                    'cyberpunk': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø³Ø§ÙŠØ¨Ø±Ø¨Ø§Ù†Ùƒ',
                    'neon': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†ÙŠÙˆÙ†',
                    'holographic': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙˆÙ„ÙˆØ¬Ø±Ø§ÙÙŠ'
                };
                return names[design] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            }

            // ðŸŽ¯ SMART CLUB INPUT SYSTEM
            async loadClubsDatabase() {
                try {
                    // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage (Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬)
                    const verifiedClubs = localStorage.getItem('verifiedClubs');
                    const arabicMappings = localStorage.getItem('ARABIC_MAPPINGS');

                    if (verifiedClubs) {
                        const clubsData = JSON.parse(verifiedClubs);
                        this.clubsDatabase = clubsData.map(club => ({
                            id: club.id,
                            englishName: club.englishName,
                            arabicName: club.arabicName || club.englishName,
                            logoUrl: club.logoUrl,
                            league: club.league || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                            country: club.country || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                            searchTerms: this.generateSearchTerms(club.englishName, club.arabicName),
                            popularity: this.calculateClubPopularity(club)
                        }));

                        // Sort by popularity for faster suggestions
                        this.clubsDatabase.sort((a, b) => b.popularity - a.popularity);

                        // Create search index for instant search
                        this.createSearchIndex();

                        console.log(`ðŸŽ¯ Loaded ${this.clubsDatabase.length} clubs with modern search index`);
                    }

                    // Ø¥Ø¶Ø§ÙØ© ØªØ±Ø¬Ù…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                    if (arabicMappings) {
                        const mappings = JSON.parse(arabicMappings);
                        Object.entries(mappings).forEach(([english, arabic]) => {
                            const existingClub = this.clubsDatabase.find(club =>
                                club.englishName.toLowerCase() === english.toLowerCase()
                            );
                            if (existingClub && !existingClub.arabicName) {
                                existingClub.arabicName = arabic;
                                existingClub.searchTerms = this.generateSearchTerms(english, arabic);
                            }
                        });
                    }

                } catch (error) {
                    console.warn('âš ï¸ Could not load clubs database:', error);
                    this.clubsDatabase = this.getFallbackClubs();
                }
            }

            // Calculate club popularity for better sorting
            calculateClubPopularity(club) {
                let score = 0;

                // Popular leagues get higher scores
                const leagueScores = {
                    'Premier League': 100,
                    'La Liga': 95,
                    'Serie A': 90,
                    'Bundesliga': 85,
                    'Ligue 1': 80,
                    'Champions League': 100,
                    'Saudi Pro League': 75
                };

                score += leagueScores[club.league] || 50;

                // Popular clubs get bonus
                const popularClubs = [
                    'real madrid', 'barcelona', 'manchester united', 'liverpool',
                    'chelsea', 'arsenal', 'manchester city', 'juventus', 'ac milan',
                    'inter milan', 'bayern munich', 'psg', 'Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ù†ØµØ±', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯'
                ];

                if (popularClubs.some(popular =>
                    club.englishName.toLowerCase().includes(popular) ||
                    club.arabicName.toLowerCase().includes(popular)
                )) {
                    score += 50;
                }

                return score;
            }

            // Create modern search index for instant suggestions
            createSearchIndex() {
                this.searchIndex = new Map();

                this.clubsDatabase.forEach(club => {
                    // Index all search terms
                    club.searchTerms.forEach(term => {
                        const key = term.toLowerCase();
                        if (!this.searchIndex.has(key)) {
                            this.searchIndex.set(key, []);
                        }
                        this.searchIndex.get(key).push(club);
                    });

                    // Index partial matches (for autocomplete)
                    const allTerms = [club.englishName, club.arabicName, ...club.searchTerms];
                    allTerms.forEach(term => {
                        if (term) {
                            for (let i = 1; i <= term.length; i++) {
                                const partial = term.toLowerCase().substring(0, i);
                                if (!this.searchIndex.has(partial)) {
                                    this.searchIndex.set(partial, []);
                                }
                                if (!this.searchIndex.get(partial).includes(club)) {
                                    this.searchIndex.get(partial).push(club);
                                }
                            }
                        }
                    });
                });

                console.log(`ðŸ” Created search index with ${this.searchIndex.size} entries`);
            }

            generateSearchTerms(englishName, arabicName) {
                const terms = new Set();

                // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
                terms.add(englishName.toLowerCase());

                // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ
                if (arabicName && arabicName !== englishName) {
                    terms.add(arabicName.toLowerCase());
                }

                // ÙƒÙ„Ù…Ø§Øª Ù…Ù†ÙØµÙ„Ø©
                englishName.split(' ').forEach(word => {
                    if (word.length > 2) terms.add(word.toLowerCase());
                });

                if (arabicName) {
                    arabicName.split(' ').forEach(word => {
                        if (word.length > 1) terms.add(word.toLowerCase());
                    });
                }

                // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø´Ø§Ø¦Ø¹Ø©
                const abbreviations = {
                    'manchester united': ['man utd', 'united', 'man u'],
                    'manchester city': ['man city', 'city'],
                    'real madrid': ['real', 'madrid'],
                    'fc barcelona': ['barca', 'barcelona'],
                    'atletico madrid': ['atletico'],
                    'tottenham hotspur': ['spurs', 'tottenham'],
                    'west ham united': ['west ham'],
                    'newcastle united': ['newcastle'],
                    'aston villa': ['villa'],
                    'crystal palace': ['palace'],
                    'brighton & hove albion': ['brighton'],
                    'wolverhampton wanderers': ['wolves'],
                    'leicester city': ['leicester'],
                    'nottingham forest': ['forest']
                };

                const lowerEnglish = englishName.toLowerCase();
                if (abbreviations[lowerEnglish]) {
                    abbreviations[lowerEnglish].forEach(abbr => terms.add(abbr));
                }

                return Array.from(terms);
            }

            getFallbackClubs() {
                // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
                return [
                    { englishName: 'Arsenal', arabicName: 'Ø¢Ø±Ø³Ù†Ø§Ù„', logoUrl: '', league: 'Premier League', country: 'England' },
                    { englishName: 'Chelsea', arabicName: 'ØªØ´ÙŠÙ„Ø³ÙŠ', logoUrl: '', league: 'Premier League', country: 'England' },
                    { englishName: 'Liverpool', arabicName: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', logoUrl: '', league: 'Premier League', country: 'England' },
                    { englishName: 'Manchester City', arabicName: 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', logoUrl: '', league: 'Premier League', country: 'England' },
                    { englishName: 'Manchester United', arabicName: 'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯', logoUrl: '', league: 'Premier League', country: 'England' },
                    { englishName: 'Real Madrid', arabicName: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', logoUrl: '', league: 'La Liga', country: 'Spain' },
                    { englishName: 'FC Barcelona', arabicName: 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', logoUrl: '', league: 'La Liga', country: 'Spain' },
                    { englishName: 'Al Hilal', arabicName: 'Ø§Ù„Ù‡Ù„Ø§Ù„', logoUrl: '', league: 'Saudi Pro League', country: 'Saudi Arabia' },
                    { englishName: 'Al Nassr', arabicName: 'Ø§Ù„Ù†ØµØ±', logoUrl: '', league: 'Saudi Pro League', country: 'Saudi Arabia' }
                ].map(club => ({
                    ...club,
                    id: club.englishName.toLowerCase().replace(/\s+/g, '_'),
                    searchTerms: this.generateSearchTerms(club.englishName, club.arabicName)
                }));
            }

            // Modern fast club input handler
            handleClubInput(input, type) {
                const query = input.value.trim();

                if (query.length < 1) {
                    this.hideClubSuggestions(input, type);
                    this.hideClubLogoPreview(input, type);
                    this.removeInputValidation(input);
                    return;
                }

                // Use modern search index for instant results
                const suggestions = this.modernSearchClubs(query);

                if (suggestions.length > 0) {
                    this.showClubSuggestions(input, type, suggestions);

                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…ØŒ Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¹Ø§Ø±
                    const exactMatch = suggestions.find(club =>
                        club.englishName.toLowerCase() === query.toLowerCase() ||
                        club.arabicName.toLowerCase() === query.toLowerCase()
                    );

                    if (exactMatch) {
                        this.showClubLogoPreview(input, type, exactMatch);
                        this.setInputValidation(input, 'verified');
                    } else {
                        this.hideClubLogoPreview(input, type);
                        this.setInputValidation(input, 'partial');
                    }
                } else {
                    this.hideClubSuggestions(input, type);
                    this.hideClubLogoPreview(input, type);
                    this.setInputValidation(input, 'error');
                }
            }

            // Modern search using index for instant results
            modernSearchClubs(query) {
                if (!this.searchIndex) {
                    return this.searchClubs(query); // Fallback to old method
                }

                const searchKey = query.toLowerCase();
                const results = new Set();

                // Get exact matches first
                if (this.searchIndex.has(searchKey)) {
                    this.searchIndex.get(searchKey).forEach(club => results.add(club));
                }

                // Get partial matches
                for (let [key, clubs] of this.searchIndex.entries()) {
                    if (key.includes(searchKey) || searchKey.includes(key)) {
                        clubs.forEach(club => results.add(club));
                    }
                }

                // Convert to array and sort by popularity
                return Array.from(results)
                    .sort((a, b) => b.popularity - a.popularity)
                    .slice(0, 8); // Limit to 8 suggestions for performance
            }

            searchClubs(query) {
                const normalizedQuery = query.toLowerCase().trim();
                const results = [];

                this.clubsDatabase.forEach(club => {
                    let score = 0;

                    // ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…
                    if (club.englishName.toLowerCase() === normalizedQuery ||
                        club.arabicName.toLowerCase() === normalizedQuery) {
                        score = 100;
                    }
                    // ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
                    else if (club.englishName.toLowerCase().startsWith(normalizedQuery) ||
                             club.arabicName.toLowerCase().startsWith(normalizedQuery)) {
                        score = 90;
                    }
                    // ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
                    else if (club.englishName.toLowerCase().includes(normalizedQuery) ||
                             club.arabicName.toLowerCase().includes(normalizedQuery)) {
                        score = 80;
                    }
                    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª
                    else {
                        club.searchTerms.forEach(term => {
                            if (term.includes(normalizedQuery)) {
                                score = Math.max(score, 70);
                            } else if (term.startsWith(normalizedQuery)) {
                                score = Math.max(score, 75);
                            }
                        });
                    }

                    // ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø¥Ù…Ù„Ø§Ø¦ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
                    if (score === 0) {
                        const similarity = this.calculateSimilarity(normalizedQuery, club.englishName.toLowerCase());
                        const arabicSimilarity = club.arabicName ?
                            this.calculateSimilarity(normalizedQuery, club.arabicName.toLowerCase()) : 0;

                        if (similarity > 0.7 || arabicSimilarity > 0.7) {
                            score = 60;
                        }
                    }

                    if (score > 0) {
                        results.push({ ...club, score });
                    }
                });

                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·
                return results.sort((a, b) => b.score - a.score).slice(0, 8);
            }

            calculateSimilarity(str1, str2) {
                const longer = str1.length > str2.length ? str1 : str2;
                const shorter = str1.length > str2.length ? str2 : str1;

                if (longer.length === 0) return 1.0;

                const editDistance = this.levenshteinDistance(longer, shorter);
                return (longer.length - editDistance) / longer.length;
            }

            levenshteinDistance(str1, str2) {
                const matrix = [];

                for (let i = 0; i <= str2.length; i++) {
                    matrix[i] = [i];
                }

                for (let j = 0; j <= str1.length; j++) {
                    matrix[0][j] = j;
                }

                for (let i = 1; i <= str2.length; i++) {
                    for (let j = 1; j <= str1.length; j++) {
                        if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                            matrix[i][j] = matrix[i - 1][j - 1];
                        } else {
                            matrix[i][j] = Math.min(
                                matrix[i - 1][j - 1] + 1,
                                matrix[i][j - 1] + 1,
                                matrix[i - 1][j] + 1
                            );
                        }
                    }
                }

                return matrix[str2.length][str1.length];
            }

            showClubSuggestions(input, type, suggestions = null) {
                const containerId = type === 'current' ? 'currentClubSuggestions' : 'targetClubSuggestions';
                const container = document.getElementById(containerId);

                if (!container) return;

                if (!suggestions) {
                    const query = input.value.trim();
                    if (query.length < 2) {
                        container.classList.remove('show');
                        return;
                    }
                    suggestions = this.searchClubs(query);
                }

                if (suggestions.length === 0) {
                    container.classList.remove('show');
                    return;
                }

                let html = `
                    <div class="club-suggestions-header">
                        <i class="fas fa-search"></i> Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© (${suggestions.length})
                    </div>
                `;

                suggestions.forEach(club => {
                    const logoHtml = club.logoUrl ?
                        `<img src="${club.logoUrl}" alt="${club.englishName}" class="club-suggestion-logo" onerror="this.style.display='none'">` :
                        `<div class="club-suggestion-logo" style="background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8rem;">${club.englishName.charAt(0)}</div>`;

                    html += `
                        <div class="club-suggestion-item" onclick="ultimateStudio.selectClub('${input.id}', '${type}', '${club.englishName}', '${club.arabicName}', '${club.logoUrl || ''}')">
                            ${logoHtml}
                            <div class="club-suggestion-info">
                                <div class="club-suggestion-name">${club.arabicName || club.englishName}</div>
                                <div class="club-suggestion-details">${club.englishName} â€¢ ${club.league} â€¢ ${club.country}</div>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="club-suggestions-footer">
                        Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡
                    </div>
                `;

                container.innerHTML = html;
                container.classList.add('show');
            }

            hideClubSuggestions(input, type) {
                setTimeout(() => {
                    const containerId = type === 'current' ? 'currentClubSuggestions' : 'targetClubSuggestions';
                    const container = document.getElementById(containerId);
                    if (container) {
                        container.classList.remove('show');
                    }
                }, 200);
            }

            selectClub(inputId, type, englishName, arabicName, logoUrl) {
                const input = document.getElementById(inputId);
                if (!input) return;

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø©
                input.value = arabicName || englishName;

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                this.hideClubSuggestions(input, type);

                // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¹Ø§Ø±
                this.showClubLogoPreview(input, type, { englishName, arabicName, logoUrl });

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ­Ù‚Ù‚
                this.setInputValidation(input, 'verified');

                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.showNotification(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${arabicName || englishName}`, 'success');

                console.log(`ðŸŽ¯ Club selected: ${englishName} (${arabicName})`);
            }

            showClubLogoPreview(input, type, club) {
                const previewId = type === 'current' ? 'currentClubLogoPreview' : 'targetClubLogoPreview';
                const preview = document.getElementById(previewId);

                if (!preview || !club.logoUrl) return;

                preview.innerHTML = `<img src="${club.logoUrl}" alt="${club.englishName}" onerror="this.parentElement.style.display='none'">`;
                preview.classList.add('show');
            }

            hideClubLogoPreview(input, type) {
                const previewId = type === 'current' ? 'currentClubLogoPreview' : 'targetClubLogoPreview';
                const preview = document.getElementById(previewId);

                if (preview) {
                    preview.classList.remove('show');
                }
            }

            setInputValidation(input, status) {
                // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ ÙØ¦Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚
                input.classList.remove('club-input-verified', 'club-input-error', 'club-input-partial');

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                switch (status) {
                    case 'verified':
                        input.classList.add('club-input-verified');
                        break;
                    case 'error':
                        input.classList.add('club-input-error');
                        break;
                    case 'partial':
                        // Ù„Ø§ Ù†Ø¶ÙŠÙ ÙØ¦Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©
                        break;
                }
            }

            removeInputValidation(input) {
                input.classList.remove('club-input-verified', 'club-input-error', 'club-input-partial');
            }

            // ØªØ­Ø³ÙŠÙ† Ø¯Ø§Ù„Ø© getClubLogo Ù„ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            async getClubLogoEnhanced(clubName) {
                try {
                    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
                    const localClub = this.clubsDatabase.find(club =>
                        club.englishName.toLowerCase() === clubName.toLowerCase() ||
                        club.arabicName.toLowerCase() === clubName.toLowerCase()
                    );

                    if (localClub && localClub.logoUrl) {
                        console.log(`ðŸŽ¯ Found logo in local database: ${localClub.logoUrl}`);
                        return localClub.logoUrl;
                    }

                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ØµÙ„ÙŠ ÙƒØ§Ø­ØªÙŠØ§Ø·ÙŠ
                    return await this.getClubLogo(clubName);

                } catch (error) {
                    console.warn(`âš ï¸ Error getting enhanced club logo for ${clubName}:`, error);
                    return await this.getClubLogo(clubName);
                }
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            async refreshClubsDatabase() {
                console.log('ðŸ”„ Refreshing clubs database...');
                await this.loadClubsDatabase();
                this.showNotification(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© - ${this.clubsDatabase.length} Ù†Ø§Ø¯ÙŠ`, 'success');
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯
            addCustomClub(englishName, arabicName, logoUrl, league, country) {
                const newClub = {
                    id: englishName.toLowerCase().replace(/\s+/g, '_'),
                    englishName,
                    arabicName: arabicName || englishName,
                    logoUrl: logoUrl || '',
                    league: league || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    country: country || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    searchTerms: this.generateSearchTerms(englishName, arabicName)
                };

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù…Ø³Ø¨Ù‚Ø§Ù‹
                const exists = this.clubsDatabase.find(club =>
                    club.englishName.toLowerCase() === englishName.toLowerCase()
                );

                if (!exists) {
                    this.clubsDatabase.push(newClub);
                    console.log(`âœ… Added custom club: ${englishName} (${arabicName})`);
                    this.showNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø§Ø¯ÙŠ: ${arabicName || englishName}`, 'success');
                } else {
                    console.log(`âš ï¸ Club already exists: ${englishName}`);
                    this.showNotification(`âš ï¸ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹: ${arabicName || englishName}`, 'warning');
                }
            }

            // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            getClubsDatabaseStats() {
                const stats = {
                    totalClubs: this.clubsDatabase.length,
                    clubsWithLogos: this.clubsDatabase.filter(club => club.logoUrl).length,
                    clubsWithArabicNames: this.clubsDatabase.filter(club => club.arabicName && club.arabicName !== club.englishName).length,
                    leagues: [...new Set(this.clubsDatabase.map(club => club.league))].length,
                    countries: [...new Set(this.clubsDatabase.map(club => club.country))].length
                };

                console.log('ðŸ“Š Clubs Database Stats:', stats);
                return stats;
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            showClubsDatabaseStats() {
                const stats = this.getClubsDatabaseStats();

                const message = `ðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ©:\n\n` +
                              `ðŸ† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø¯ÙŠØ©: ${stats.totalClubs}\n` +
                              `ðŸŽ¨ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø´Ø¹Ø§Ø±Ø§Øª: ${stats.clubsWithLogos}\n` +
                              `ðŸŒ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø£Ø³Ù…Ø§Ø¡ Ø¹Ø±Ø¨ÙŠØ©: ${stats.clubsWithArabicNames}\n` +
                              `ðŸŸï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª: ${stats.leagues}\n` +
                              `ðŸŒŽ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù„Ø¯Ø§Ù†: ${stats.countries}\n\n` +
                              `ðŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª: ${Math.round((stats.clubsWithLogos / stats.totalClubs) * 100)}%\n` +
                              `ðŸ”¤ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: ${Math.round((stats.clubsWithArabicNames / stats.totalClubs) * 100)}%`;

                alert(message);
                this.showNotification('ðŸ“Š ØªÙ… Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'info');
            }

            // ØªØ­Ø³ÙŠÙ† Ø¯Ø§Ù„Ø© getClubLogo Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù„ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            async getClubLogo(clubName) {
                try {
                    console.log(`ðŸ” Getting club logo with enhanced system: "${clubName}"`);

                    if (!clubName || clubName.trim() === '') {
                        console.warn('âš ï¸ Empty club name provided');
                        return null;
                    }

                    // Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø©
                    const localClub = this.clubsDatabase.find(club =>
                        club.englishName.toLowerCase() === clubName.toLowerCase() ||
                        club.arabicName.toLowerCase() === clubName.toLowerCase() ||
                        club.searchTerms.some(term => term === clubName.toLowerCase())
                    );

                    if (localClub && localClub.logoUrl) {
                        console.log(`âœ… Enhanced system found logo: ${localClub.logoUrl}`);
                        return localClub.logoUrl;
                    }

                    // Ø«Ø§Ù†ÙŠØ§Ù‹ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„
                    if (window.clubLogoIntegration) {
                        console.log(`ðŸ”— Using integrated club logo service for: "${clubName}"`);
                        const integrationResult = await window.clubLogoIntegration.searchClubLogo(clubName);

                        if (integrationResult && integrationResult.logoUrl) {
                            console.log(`âœ… Integration service found logo: ${integrationResult.logoUrl} (${integrationResult.source})`);
                            return integrationResult.logoUrl;
                        }
                    }

                    // Ø«Ø§Ù„Ø«Ø§Ù‹ØŒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ Ù…Ø¹ ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ø§Ø³Ù…
                    const searchClubName = this.normalizeClubName(clubName);
                    if (searchClubName !== clubName) {
                        const normalizedClub = this.clubsDatabase.find(club =>
                            club.englishName.toLowerCase() === searchClubName.toLowerCase() ||
                            club.arabicName.toLowerCase() === searchClubName.toLowerCase()
                        );

                        if (normalizedClub && normalizedClub.logoUrl) {
                            console.log(`âœ… Found logo with normalized name: ${normalizedClub.logoUrl}`);
                            return normalizedClub.logoUrl;
                        }
                    }

                    // Ø±Ø§Ø¨Ø¹Ø§Ù‹ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… API Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ
                    const response = await fetch(`/api/get-club-logo?clubName=${encodeURIComponent(searchClubName)}`);

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success && data.data.logoUrl) {
                            console.log(`âœ… External API logo loaded: ${data.data.logoUrl}`);
                            return data.data.logoUrl;
                        }
                    }

                    // Ø®Ø§Ù…Ø³Ø§Ù‹ØŒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ØµÙ„ÙŠ
                    if (searchClubName !== clubName.trim()) {
                        console.log(`ðŸ”„ Trying with original name: "${clubName}"`);
                        const fallbackResponse = await fetch(`/api/get-club-logo?clubName=${encodeURIComponent(clubName.trim())}`);

                        if (fallbackResponse.ok) {
                            const fallbackResult = await fallbackResponse.json();
                            if (fallbackResult.success && fallbackResult.data.logoUrl) {
                                console.log(`âœ… Logo found with original name: ${fallbackResult.data.logoUrl}`);
                                return fallbackResult.data.logoUrl;
                            }
                        }
                    }

                    console.warn(`âŒ All enhanced logo services failed for: "${clubName}"`);
                    return null;

                } catch (error) {
                    console.error('ðŸš¨ Error fetching enhanced club logo:', error);
                    return null;
                }
            }

            normalizeClubName(clubName) {
                // ØªØ·Ø¨ÙŠØ¹ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø£ÙØ¶Ù„
                const normalizations = {
                    'Ù…Ø§Ù† Ø³ÙŠØªÙŠ': 'Manchester City',
                    'Ù…Ø§Ù† ÙŠÙˆÙ†Ø§ÙŠØªØ¯': 'Manchester United',
                    'Ù„ÙŠÙØ±Ø¨ÙˆÙ„': 'Liverpool',
                    'ØªØ´ÙŠÙ„Ø³ÙŠ': 'Chelsea',
                    'Ø¢Ø±Ø³Ù†Ø§Ù„': 'Arsenal',
                    'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯': 'Real Madrid',
                    'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©': 'FC Barcelona',
                    'Ø§Ù„Ù‡Ù„Ø§Ù„': 'Al Hilal',
                    'Ø§Ù„Ù†ØµØ±': 'Al Nassr',
                    'Ø§Ù„Ø§ØªØ­Ø§Ø¯': 'Al Ittihad',
                    'Ø§Ù„Ø£Ù‡Ù„ÙŠ': 'Al Ahly'
                };

                return normalizations[clubName] || clubName;
            }

            // ðŸŒŸ FAVORITE AND RECENT CLUBS SYSTEM
            loadFavoriteClubs() {
                try {
                    const saved = localStorage.getItem('ultimateStudio_favoriteClubs');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.warn('Error loading favorite clubs:', error);
                    return [];
                }
            }

            loadRecentClubs() {
                try {
                    const saved = localStorage.getItem('ultimateStudio_recentClubs');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.warn('Error loading recent clubs:', error);
                    return [];
                }
            }

            addToRecentClubs(clubName) {
                if (!clubName) return;

                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ Ù…Ø³Ø¨Ù‚Ø§Ù‹
                this.recentClubs = this.recentClubs.filter(club => club !== clubName);

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø§Ø¯ÙŠ ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©
                this.recentClubs.unshift(clubName);

                // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 10 Ø£Ù†Ø¯ÙŠØ© ÙÙ‚Ø·
                this.recentClubs = this.recentClubs.slice(0, 10);

                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('ultimateStudio_recentClubs', JSON.stringify(this.recentClubs));
            }

            addToFavoriteClubs(clubName) {
                if (!clubName || this.favoriteClubs.includes(clubName)) return;

                this.favoriteClubs.push(clubName);
                localStorage.setItem('ultimateStudio_favoriteClubs', JSON.stringify(this.favoriteClubs));

                this.showNotification(`â­ ØªÙ… Ø¥Ø¶Ø§ÙØ© ${clubName} Ù„Ù„Ù…ÙØ¶Ù„Ø©`, 'success');
            }

            removeFromFavoriteClubs(clubName) {
                this.favoriteClubs = this.favoriteClubs.filter(club => club !== clubName);
                localStorage.setItem('ultimateStudio_favoriteClubs', JSON.stringify(this.favoriteClubs));

                this.showNotification(`âŒ ØªÙ… Ø¥Ø²Ø§Ù„Ø© ${clubName} Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©`, 'info');
            }

            // ØªØ­Ø³ÙŠÙ† Ø¯Ø§Ù„Ø© selectClub Ù„ØªØ¶ÙŠÙ Ù„Ù„ØªØ§Ø±ÙŠØ®
            selectClub(inputId, type, englishName, arabicName, logoUrl) {
                const input = document.getElementById(inputId);
                if (!input) return;

                const displayName = arabicName || englishName;

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø©
                input.value = displayName;

                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªØ§Ø±ÙŠØ®
                this.addToRecentClubs(displayName);

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                this.hideClubSuggestions(input, type);

                // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¹Ø§Ø±
                this.showClubLogoPreview(input, type, { englishName, arabicName, logoUrl });

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ­Ù‚Ù‚
                this.setInputValidation(input, 'verified');

                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.showNotification(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${displayName}`, 'success');

                console.log(`ðŸŽ¯ Club selected: ${englishName} (${arabicName})`);
            }

            // ØªØ­Ø³ÙŠÙ† Ø¯Ø§Ù„Ø© showClubSuggestions Ù„ØªØ´Ù…Ù„ Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø©
            showClubSuggestions(input, type, suggestions = null) {
                const containerId = type === 'current' ? 'currentClubSuggestions' :
                                 type === 'target' ? 'targetClubSuggestions' :
                                 type === 'savedTarget' ? 'savedTargetClubSuggestions' :
                                 type === 'multiTarget' ? 'multiTargetClubSuggestions' :
                                 type === 'extractTarget' ? 'extractTargetClubSuggestions' : null;

                const container = document.getElementById(containerId);
                if (!container) return;

                if (!suggestions) {
                    const query = input.value.trim();
                    if (query.length < 2) {
                        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ø³ØªØ¹Ù„Ø§Ù…
                        suggestions = this.getFavoriteAndRecentSuggestions();
                    } else {
                        suggestions = this.searchClubs(query);
                    }
                }

                if (suggestions.length === 0) {
                    container.classList.remove('show');
                    return;
                }

                let html = `
                    <div class="club-suggestions-header">
                        <i class="fas fa-search"></i> ${input.value.trim().length < 2 ? 'Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø©' : `Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© (${suggestions.length})`}
                    </div>
                `;

                suggestions.forEach(club => {
                    const logoHtml = club.logoUrl ?
                        `<img src="${club.logoUrl}" alt="${club.englishName}" class="club-suggestion-logo" onerror="this.style.display='none'">` :
                        `<div class="club-suggestion-logo" style="background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8rem;">${club.englishName.charAt(0)}</div>`;

                    const isFavorite = this.favoriteClubs.includes(club.arabicName || club.englishName);
                    const isRecent = this.recentClubs.includes(club.arabicName || club.englishName);

                    const badges = [];
                    if (isFavorite) badges.push('<span style="color: #fbbf24;">â­</span>');
                    if (isRecent) badges.push('<span style="color: #10b981;">ðŸ•’</span>');

                    html += `
                        <div class="club-suggestion-item" onclick="ultimateStudio.selectClub('${input.id}', '${type}', '${club.englishName}', '${club.arabicName}', '${club.logoUrl || ''}')">
                            ${logoHtml}
                            <div class="club-suggestion-info">
                                <div class="club-suggestion-name">${club.arabicName || club.englishName} ${badges.join(' ')}</div>
                                <div class="club-suggestion-details">${club.englishName} â€¢ ${club.league} â€¢ ${club.country}</div>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="club-suggestions-footer">
                        Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡ â€¢ â­ Ù…ÙØ¶Ù„ â€¢ ðŸ•’ Ø­Ø¯ÙŠØ«
                    </div>
                `;

                container.innerHTML = html;
                container.classList.add('show');
            }

            getFavoriteAndRecentSuggestions() {
                const suggestions = [];

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©
                this.favoriteClubs.forEach(clubName => {
                    const club = this.findClubByName(clubName);
                    if (club) suggestions.push(club);
                });

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©
                this.recentClubs.forEach(clubName => {
                    const club = this.findClubByName(clubName);
                    if (club && !suggestions.find(s => s.englishName === club.englishName)) {
                        suggestions.push(club);
                    }
                });

                return suggestions.slice(0, 8);
            }

            findClubByName(clubName) {
                return this.clubsDatabase.find(club =>
                    club.englishName === clubName ||
                    club.arabicName === clubName
                );
            }

            // ðŸŽ¯ MULTI-PLAYER CLUB INPUT SYSTEM
            handleMultiClubInput(input, type) {
                const query = input.value.trim();

                if (query.length < 2) {
                    this.hideMultiClubSuggestions(input, type);
                    this.hideMultiClubLogoPreview(input, type);
                    this.removeInputValidation(input);
                    return;
                }

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                const suggestions = this.searchClubs(query);

                if (suggestions.length > 0) {
                    this.showMultiClubSuggestions(input, type, suggestions);

                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…ØŒ Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¹Ø§Ø±
                    const exactMatch = suggestions.find(club =>
                        club.englishName.toLowerCase() === query.toLowerCase() ||
                        club.arabicName.toLowerCase() === query.toLowerCase()
                    );

                    if (exactMatch) {
                        this.showMultiClubLogoPreview(input, type, exactMatch);
                        this.setInputValidation(input, 'verified');
                    } else {
                        this.hideMultiClubLogoPreview(input, type);
                        this.setInputValidation(input, 'partial');
                    }
                } else {
                    this.hideMultiClubSuggestions(input, type);
                    this.hideMultiClubLogoPreview(input, type);
                    this.setInputValidation(input, 'error');
                }
            }

            showMultiClubSuggestions(input, type, suggestions = null) {
                const container = input.parentElement.querySelector('.multi-club-suggestions');
                if (!container) return;

                if (!suggestions) {
                    const query = input.value.trim();
                    if (query.length < 2) {
                        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ø³ØªØ¹Ù„Ø§Ù…
                        suggestions = this.getFavoriteAndRecentSuggestions();
                    } else {
                        suggestions = this.searchClubs(query);
                    }
                }

                if (suggestions.length === 0) {
                    container.classList.remove('show');
                    return;
                }

                let html = `
                    <div class="club-suggestions-header">
                        <i class="fas fa-search"></i> ${input.value.trim().length < 2 ? 'Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø©' : `Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© (${suggestions.length})`}
                    </div>
                `;

                suggestions.forEach(club => {
                    const logoHtml = club.logoUrl ?
                        `<img src="${club.logoUrl}" alt="${club.englishName}" class="club-suggestion-logo" onerror="this.style.display='none'">` :
                        `<div class="club-suggestion-logo" style="background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8rem;">${club.englishName.charAt(0)}</div>`;

                    const isFavorite = this.favoriteClubs.includes(club.arabicName || club.englishName);
                    const isRecent = this.recentClubs.includes(club.arabicName || club.englishName);

                    const badges = [];
                    if (isFavorite) badges.push('<span style="color: #fbbf24;">â­</span>');
                    if (isRecent) badges.push('<span style="color: #10b981;">ðŸ•’</span>');

                    html += `
                        <div class="club-suggestion-item" onclick="ultimateStudio.selectMultiClub('${input.className}', '${type}', '${club.englishName}', '${club.arabicName}', '${club.logoUrl || ''}', this)">
                            ${logoHtml}
                            <div class="club-suggestion-info">
                                <div class="club-suggestion-name">${club.arabicName || club.englishName} ${badges.join(' ')}</div>
                                <div class="club-suggestion-details">${club.englishName} â€¢ ${club.league} â€¢ ${club.country}</div>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="club-suggestions-footer">
                        Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡ â€¢ â­ Ù…ÙØ¶Ù„ â€¢ ðŸ•’ Ø­Ø¯ÙŠØ«
                    </div>
                `;

                container.innerHTML = html;
                container.classList.add('show');
            }

            hideMultiClubSuggestions(input, type) {
                setTimeout(() => {
                    const container = input.parentElement.querySelector('.multi-club-suggestions');
                    if (container) {
                        container.classList.remove('show');
                    }
                }, 200);
            }

            selectMultiClub(inputClass, type, englishName, arabicName, logoUrl, element) {
                const input = element.closest('.ultimate-input-group').querySelector('input');
                if (!input) return;

                const displayName = arabicName || englishName;

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø©
                input.value = displayName;

                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØªØ§Ø±ÙŠØ®
                this.addToRecentClubs(displayName);

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
                this.hideMultiClubSuggestions(input, type);

                // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¹Ø§Ø±
                this.showMultiClubLogoPreview(input, type, { englishName, arabicName, logoUrl });

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ­Ù‚Ù‚
                this.setInputValidation(input, 'verified');

                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.showNotification(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${displayName}`, 'success');

                console.log(`ðŸŽ¯ Multi-club selected: ${englishName} (${arabicName})`);
            }

            showMultiClubLogoPreview(input, type, club) {
                const preview = input.parentElement.querySelector('.multi-club-logo-preview');

                if (!preview || !club.logoUrl) return;

                preview.innerHTML = `<img src="${club.logoUrl}" alt="${club.englishName}" onerror="this.parentElement.style.display='none'">`;
                preview.classList.add('show');
            }

            hideMultiClubLogoPreview(input, type) {
                const preview = input.parentElement.querySelector('.multi-club-logo-preview');

                if (preview) {
                    preview.classList.remove('show');
                }
            }

            // Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ«Ø©
            showFavoriteClubs() {
                if (this.favoriteClubs.length === 0) {
                    alert('ðŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ù…ÙØ¶Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹\n\nÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ù„Ù„Ù…ÙØ¶Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ù‡Ø§.');
                    return;
                }

                const message = `â­ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø© (${this.favoriteClubs.length}):\n\n` +
                              this.favoriteClubs.map((club, index) => `${index + 1}. ${club}`).join('\n') +
                              '\n\nÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ© Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© ÙÙŠ Ø£Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø­Ø«.';

                alert(message);
            }

            showRecentClubs() {
                if (this.recentClubs.length === 0) {
                    alert('ðŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ø¤Ø®Ø±Ø§Ù‹\n\nØ³ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØµØ§Ù…ÙŠÙ….');
                    return;
                }

                const message = `ðŸ•’ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ø¤Ø®Ø±Ø§Ù‹ (${this.recentClubs.length}):\n\n` +
                              this.recentClubs.map((club, index) => `${index + 1}. ${club}`).join('\n') +
                              '\n\nÙŠØªÙ… Ø­ÙØ¸ Ø¢Ø®Ø± 10 Ø£Ù†Ø¯ÙŠØ© ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§.';

                alert(message);
            }

            clearRecentClubs() {
                if (this.recentClubs.length === 0) {
                    this.showNotification('ðŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ø­Ø¯ÙŠØ«Ø© Ù„Ù…Ø³Ø­Ù‡Ø§', 'info');
                    return;
                }

                const confirmed = confirm(`ðŸ—‘ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©ØŸ\n\nØ³ÙŠØªÙ… Ù…Ø³Ø­ ${this.recentClubs.length} Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.`);

                if (confirmed) {
                    this.recentClubs = [];
                    localStorage.removeItem('ultimateStudio_recentClubs');
                    this.showNotification('âœ… ØªÙ… Ù…Ø³Ø­ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©', 'success');
                }
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ù„Ù„Ù…ÙØ¶Ù„Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            promptAddFavoriteClub() {
                const clubName = prompt('â­ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ù…ÙØ¶Ù„Ø©:');

                if (clubName && clubName.trim()) {
                    const trimmedName = clubName.trim();

                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Ø§Ø¯ÙŠ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    const club = this.findClubByName(trimmedName);

                    if (club) {
                        this.addToFavoriteClubs(club.arabicName || club.englishName);
                    } else {
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø­ØªÙ‰ Ù„Ùˆ Ù„Ù… ÙŠÙƒÙ† ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        this.addToFavoriteClubs(trimmedName);
                    }
                }
            }

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©
            promptRemoveFavoriteClub() {
                if (this.favoriteClubs.length === 0) {
                    this.showNotification('ðŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ù…ÙØ¶Ù„Ø© Ù„Ø¥Ø²Ø§Ù„ØªÙ‡Ø§', 'info');
                    return;
                }

                const clubsList = this.favoriteClubs.map((club, index) => `${index + 1}. ${club}`).join('\n');
                const clubName = prompt(`âŒ Ø§Ø®ØªØ± Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù„Ø¥Ø²Ø§Ù„ØªÙ‡ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©:\n\n${clubsList}\n\nØ£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ:`);

                if (clubName && clubName.trim()) {
                    const trimmedName = clubName.trim();

                    if (this.favoriteClubs.includes(trimmedName)) {
                        this.removeFromFavoriteClubs(trimmedName);
                    } else {
                        this.showNotification('âŒ Ø§Ù„Ù†Ø§Ø¯ÙŠ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'error');
                    }
                }
            }

            // ðŸŽ¬ AUTO SEND TO STREAM SYSTEM
            autoSendToStream() {
                try {
                    console.log('ðŸŽ¬ Auto-sending to stream...');

                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    if (!this.currentPlayer) {
                        console.warn('âš ï¸ No current player data for auto-send');
                        return;
                    }

                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                    const autoSendEnabled = document.getElementById('autoSendToDirectStream')?.checked;
                    const streamActive = window.directStreamActive || localStorage.getItem('directStreamActive') === 'true';

                    if (!autoSendEnabled && !streamActive) {
                        console.log('ðŸ“º Auto-send disabled or stream not active');
                        return;
                    }

                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                    const previewContent = document.getElementById('previewContent');
                    if (!previewContent || !previewContent.innerHTML.trim()) {
                        console.warn('âš ï¸ No preview content to send');
                        return;
                    }

                    // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
                    const streamData = {
                        content: previewContent.innerHTML,
                        player: this.currentPlayer,
                        timestamp: Date.now(),
                        autoSent: true,
                        settings: {
                            playerImageSize: this.settings.playerImageSize || 150,
                            clubLogoSize: this.settings.clubLogoSize || 32,
                            cardTransition: this.settings.cardTransition || 'fadeIn'
                        }
                    };

                    // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                    if (typeof window.sendToDirectStream === 'function') {
                        window.sendToDirectStream();
                        console.log('âœ… Auto-sent to direct stream');
                    }

                    // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯
                    if (typeof window.showPlayerInNewStream === 'function') {
                        window.showPlayerInNewStream(this.currentPlayer);
                        console.log('âœ… Auto-sent to new stream');
                    }

                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©
                    localStorage.setItem('directStreamContent', JSON.stringify(streamData));
                    localStorage.setItem('directStreamContentChanged', Date.now().toString());
                    localStorage.setItem('currentPlayer', JSON.stringify(this.currentPlayer));
                    localStorage.setItem('playerChanged', Date.now().toString());

                    // ðŸš€ INSTANT NOTIFICATION SYSTEM - Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙˆØ±ÙŠØ©
                    this.notifyStreamInstantly(streamData);

                    // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    this.showNotification('ðŸŽ¬ ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'success');

                    console.log('ðŸŽ¬ Auto-send completed successfully');

                } catch (error) {
                    console.error('âŒ Error in auto-send to stream:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨Ø«', 'error');
                }
            }

            // ðŸš€ INSTANT STREAM NOTIFICATION SYSTEM
            notifyStreamInstantly(streamData) {
                try {
                    console.log('ðŸš€ Sending instant notifications to stream...');

                    // 1. Custom Event Dispatch
                    window.dispatchEvent(new CustomEvent('directStreamUpdate', {
                        detail: {
                            type: 'PLAYER_CREATED',
                            data: streamData,
                            timestamp: Date.now(),
                            source: 'pro-studio-v4'
                        }
                    }));

                    // 2. Broadcast Channel (cross-tab communication)
                    if (typeof BroadcastChannel !== 'undefined') {
                        const streamChannel = new BroadcastChannel('stream-updates');
                        streamChannel.postMessage({
                            type: 'PLAYER_CREATED',
                            data: streamData,
                            timestamp: Date.now(),
                            source: 'pro-studio-v4'
                        });
                        streamChannel.close();
                    }

                    // 3. PostMessage to all windows (including stream-clean)
                    if (window.parent !== window) {
                        window.parent.postMessage({
                            type: 'STREAM_UPDATE',
                            data: streamData,
                            timestamp: Date.now()
                        }, '*');
                    }

                    // 4. Try to directly notify stream-clean if it's open
                    try {
                        const streamWindows = [];
                        // Check if stream-clean is in another tab
                        if (typeof window.streamCleanWindow !== 'undefined' && window.streamCleanWindow) {
                            streamWindows.push(window.streamCleanWindow);
                        }

                        streamWindows.forEach(streamWindow => {
                            try {
                                streamWindow.postMessage({
                                    type: 'STREAM_UPDATE',
                                    data: streamData,
                                    timestamp: Date.now()
                                }, '*');
                            } catch (e) {
                                console.warn('Could not message stream window:', e);
                            }
                        });
                    } catch (e) {
                        console.warn('Could not access stream windows:', e);
                    }

                    // 5. Force localStorage events by updating multiple keys
                    const forceKeys = [
                        'directStreamForceUpdate',
                        'streamInstantNotification',
                        'playerInstantUpdate'
                    ];

                    forceKeys.forEach(key => {
                        localStorage.setItem(key, Date.now().toString());
                        // Remove after a short delay to trigger change events
                        setTimeout(() => {
                            localStorage.removeItem(key);
                        }, 100);
                    });

                    // 6. Simple localStorage updates
                    for (let i = 0; i < 3; i++) {
                        setTimeout(() => {
                            localStorage.setItem('directStreamContentChanged', Date.now().toString());
                        }, i * 50);
                    }

                    console.log('âœ… Instant notifications sent successfully');

                } catch (error) {
                    console.error('âŒ Error sending instant notifications:', error);
                }
            }

            initializeSettings() {
                // Load and apply saved settings
                Object.keys(this.settings).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = this.settings[key];
                    }
                });

                // Apply image size setting
                if (this.settings.playerImageSize) {
                    const imageSizeSlider = document.getElementById('playerImageSize');
                    const imageSizeValue = document.getElementById('imageSizeValue');
                    if (imageSizeSlider) {
                        imageSizeSlider.value = this.settings.playerImageSize;
                    }
                    if (imageSizeValue) {
                        imageSizeValue.textContent = this.settings.playerImageSize;
                    }
                }

                // Apply club logo size setting
                if (this.settings.clubLogoSize) {
                    const logoSizeSlider = document.getElementById('clubLogoSize');
                    const logoSizeValue = document.getElementById('logoSizeValue');
                    if (logoSizeSlider) {
                        logoSizeSlider.value = this.settings.clubLogoSize;
                    }
                    if (logoSizeValue) {
                        logoSizeValue.textContent = this.settings.clubLogoSize;
                    }
                }

                // Apply target club logo size setting
                if (this.settings.targetClubLogoSize) {
                    const targetLogoSizeSlider = document.getElementById('targetClubLogoSize');
                    const targetLogoSizeValue = document.getElementById('targetLogoSizeValue');
                    if (targetLogoSizeSlider) {
                        targetLogoSizeSlider.value = this.settings.targetClubLogoSize;
                    }
                    if (targetLogoSizeValue) {
                        targetLogoSizeValue.textContent = this.settings.targetClubLogoSize;
                    }
                }

                // Apply target club logo large size setting
                if (this.settings.targetClubLogoLargeSize) {
                    const targetLogoLargeSizeSlider = document.getElementById('targetClubLogoLargeSize');
                    const targetLogoLargeSizeValue = document.getElementById('targetLogoLargeSizeValue');
                    if (targetLogoLargeSizeSlider) {
                        targetLogoLargeSizeSlider.value = this.settings.targetClubLogoLargeSize;
                    }
                    if (targetLogoLargeSizeValue) {
                        targetLogoLargeSizeValue.textContent = this.settings.targetClubLogoLargeSize;
                    }
                }

                // Apply card transition settings
                if (this.settings.cardTransition) {
                    const cardTransitionSelect = document.getElementById('cardTransition');
                    if (cardTransitionSelect) {
                        cardTransitionSelect.value = this.settings.cardTransition;
                    }
                }

                if (this.settings.transitionDuration) {
                    const transitionDurationSlider = document.getElementById('transitionDuration');
                    const transitionDurationValue = document.getElementById('transitionDurationValue');
                    if (transitionDurationSlider) {
                        transitionDurationSlider.value = this.settings.transitionDuration;
                    }
                    if (transitionDurationValue) {
                        transitionDurationValue.textContent = this.settings.transitionDuration;
                    }
                }

                // Apply LM Studio URL setting
                if (this.settings.lmStudioURL) {
                    const lmStudioURLInput = document.getElementById('lmStudioURL');
                    if (lmStudioURLInput) {
                        lmStudioURLInput.value = this.settings.lmStudioURL;
                    }
                }

                this.applySettings();

                // Apply default background theme
                const defaultTheme = this.settings.visualTheme || 'cosmic';
                this.changeTheme(defaultTheme);

                // Auto-enable direct stream checkbox for better UX
                const autoSendCheckbox = document.getElementById('autoSendToDirectStream');
                if (autoSendCheckbox && !autoSendCheckbox.checked) {
                    autoSendCheckbox.checked = true;
                    console.log('âœ… Auto-enabled direct stream checkbox for better UX');
                }

                console.log('âš™ï¸ Settings initialized');
            }

            // ðŸ† Initialize Club Database with Arabic-English mapping
            initializeClubDatabase() {
                return {
                    // ðŸ‡ªðŸ‡¸ La Liga (Primera Division - PD)
                    'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯': { english: 'Real Madrid CF', league: 'PD', id: 86 },
                    'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©': { english: 'FC Barcelona', league: 'PD', id: 81 },
                    'Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯': { english: 'Club AtlÃ©tico de Madrid', league: 'PD', id: 78 },
                    'Ø¥Ø´Ø¨ÙŠÙ„ÙŠØ©': { english: 'Sevilla FC', league: 'PD', id: 559 },
                    'ÙØ§Ù„Ù†Ø³ÙŠØ§': { english: 'Valencia CF', league: 'PD', id: 95 },
                    'ÙÙŠØ§Ø±ÙŠØ§Ù„': { english: 'Villarreal CF', league: 'PD', id: 94 },
                    'Ø±ÙŠØ§Ù„ Ø¨ÙŠØªÙŠØ³': { english: 'Real Betis BalompiÃ©', league: 'PD', id: 90 },
                    'Ø±ÙŠØ§Ù„ Ø³ÙˆØ³ÙŠØ¯Ø§Ø¯': { english: 'Real Sociedad de FÃºtbol', league: 'PD', id: 92 },

                    // ðŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ Premier League (PL)
                    'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ': { english: 'Manchester City FC', league: 'PL', id: 65 },
                    'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯': { english: 'Manchester United FC', league: 'PL', id: 66 },
                    'Ù„ÙŠÙØ±Ø¨ÙˆÙ„': { english: 'Liverpool FC', league: 'PL', id: 64 },
                    'ØªØ´ÙŠÙ„Ø³ÙŠ': { english: 'Chelsea FC', league: 'PL', id: 61 },
                    'Ø£Ø±Ø³Ù†Ø§Ù„': { english: 'Arsenal FC', league: 'PL', id: 57 },
                    'ØªÙˆØªÙ†Ù‡Ø§Ù…': { english: 'Tottenham Hotspur FC', league: 'PL', id: 73 },
                    'Ù†ÙŠÙˆÙƒØ§Ø³Ù„': { english: 'Newcastle United FC', league: 'PL', id: 67 },
                    'Ø£Ø³ØªÙˆÙ† ÙÙŠÙ„Ø§': { english: 'Aston Villa FC', league: 'PL', id: 58 },
                    'ÙˆÙŠØ³Øª Ù‡Ø§Ù…': { english: 'West Ham United FC', league: 'PL', id: 563 },
                    'Ø¨Ø±Ø§ÙŠØªÙˆÙ†': { english: 'Brighton & Hove Albion FC', league: 'PL', id: 397 },

                    // ðŸ‡®ðŸ‡¹ Serie A (SA)
                    'ÙŠÙˆÙÙ†ØªÙˆØ³': { english: 'Juventus FC', league: 'SA', id: 109 },
                    'Ù…ÙŠÙ„Ø§Ù†': { english: 'AC Milan', league: 'SA', id: 98 },
                    'Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†': { english: 'FC Internazionale Milano', league: 'SA', id: 108 },
                    'Ù†Ø§Ø¨ÙˆÙ„ÙŠ': { english: 'SSC Napoli', league: 'SA', id: 113 },
                    'Ø±ÙˆÙ…Ø§': { english: 'AS Roma', league: 'SA', id: 100 },
                    'Ù„Ø§ØªØ³ÙŠÙˆ': { english: 'SS Lazio', league: 'SA', id: 110 },
                    'Ø£ØªØ§Ù„Ø§Ù†ØªØ§': { english: 'Atalanta BC', league: 'SA', id: 102 },
                    'ÙÙŠÙˆØ±Ù†ØªÙŠÙ†Ø§': { english: 'ACF Fiorentina', league: 'SA', id: 99 },

                    // ðŸ‡©ðŸ‡ª Bundesliga (BL1)
                    'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®': { english: 'FC Bayern MÃ¼nchen', league: 'BL1', id: 5 },
                    'Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯': { english: 'Borussia Dortmund', league: 'BL1', id: 4 },
                    'Ù„Ø§ÙŠØ¨Ø²ÙŠØº': { english: 'RB Leipzig', league: 'BL1', id: 721 },
                    'Ø¨Ø§ÙŠØ± Ù„ÙŠÙØ±ÙƒÙˆØ²Ù†': { english: 'Bayer 04 Leverkusen', league: 'BL1', id: 3 },
                    'ÙØ±Ø§Ù†ÙƒÙÙˆØ±Øª': { english: 'Eintracht Frankfurt', league: 'BL1', id: 19 },
                    'Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ù…ÙˆÙ†Ø´Ù†ØºÙ„Ø§Ø¯Ø¨Ø§Ø®': { english: 'Borussia MÃ¶nchengladbach', league: 'BL1', id: 18 },

                    // ðŸ‡«ðŸ‡· Ligue 1 (FL1)
                    'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†': { english: 'Paris Saint-Germain FC', league: 'FL1', id: 524 },
                    'Ù…Ø§Ø±Ø³ÙŠÙ„ÙŠØ§': { english: 'Olympique de Marseille', league: 'FL1', id: 516 },
                    'Ù„ÙŠÙˆÙ†': { english: 'Olympique Lyonnais', league: 'FL1', id: 523 },
                    'Ù…ÙˆÙ†Ø§ÙƒÙˆ': { english: 'AS Monaco FC', league: 'FL1', id: 548 },
                    'Ù†ÙŠØ³': { english: 'OGC Nice', league: 'FL1', id: 522 },
                    'Ø±ÙŠÙ†': { english: 'Stade Rennais FC', league: 'FL1', id: 529 },

                    // ðŸ‡³ðŸ‡± Eredivisie (DED)
                    'Ø£ÙŠØ§ÙƒØ³': { english: 'AFC Ajax', league: 'DED', id: 678 },
                    'Ø¨ÙŠ Ø¥Ø³ ÙÙŠ': { english: 'PSV', league: 'DED', id: 674 },
                    'ÙÙŠÙ†ÙˆØ±Ø¯': { english: 'Feyenoord Rotterdam', league: 'DED', id: 675 },

                    // ðŸ‡µðŸ‡¹ Primeira Liga (PPL)
                    'Ø¨ÙˆØ±ØªÙˆ': { english: 'FC Porto', league: 'PPL', id: 503 },
                    'Ø¨Ù†ÙÙŠÙƒØ§': { english: 'SL Benfica', league: 'PPL', id: 1903 },
                    'Ø³Ø¨ÙˆØ±ØªÙŠÙ†Øº Ù„Ø´Ø¨ÙˆÙ†Ø©': { english: 'Sporting Clube de Portugal', league: 'PPL', id: 498 },

                    // ðŸ‡§ðŸ‡· BrasileirÃ£o (BSA)
                    'ÙÙ„Ø§Ù…Ù†ØºÙˆ': { english: 'CR Flamengo', league: 'BSA', id: 1776 },
                    'Ø¨Ø§Ù„Ù…ÙŠØ±Ø§Ø³': { english: 'SE Palmeiras', league: 'BSA', id: 1777 },
                    'ÙƒÙˆØ±ÙŠÙ†Ø«ÙŠØ§Ù†Ø³': { english: 'SC Corinthians Paulista', league: 'BSA', id: 1778 },
                    'Ø³Ø§Ùˆ Ø¨Ø§ÙˆÙ„Ùˆ': { english: 'SÃ£o Paulo FC', league: 'BSA', id: 1779 },

                    // ðŸ‡¸ðŸ‡¦ Saudi Pro League
                    'Ø§Ù„Ù‡Ù„Ø§Ù„': { english: 'Al-Hilal SFC', league: 'SPL', id: null },
                    'Ø§Ù„Ù†ØµØ±': { english: 'Al-Nassr FC', league: 'SPL', id: null },
                    'Ø§Ù„Ø§ØªØ­Ø§Ø¯': { english: 'Al-Ittihad Club', league: 'SPL', id: null },
                    'Ø§Ù„Ø£Ù‡Ù„ÙŠ': { english: 'Al-Ahli Saudi FC', league: 'SPL', id: null },
                    'Ø§Ù„Ø´Ø¨Ø§Ø¨': { english: 'Al-Shabab FC', league: 'SPL', id: null },
                    'Ø§Ù„ÙÙŠØµÙ„ÙŠ': { english: 'Al-Faisaly FC', league: 'SPL', id: null },
                    'Ø§Ù„ØªØ¹Ø§ÙˆÙ†': { english: 'Al-Taawoun FC', league: 'SPL', id: null },
                    'Ø§Ù„ÙØªØ­': { english: 'Al-Fateh SC', league: 'SPL', id: null }
                };
            }

            // ðŸ† Initialize League Database
            initializeLeagueDatabase() {
                return {
                    'WC': { name: 'FIFA World Cup', country: 'International' },
                    'CL': { name: 'UEFA Champions League', country: 'Europe' },
                    'BL1': { name: 'Bundesliga', country: 'Germany' },
                    'DED': { name: 'Eredivisie', country: 'Netherlands' },
                    'BSA': { name: 'Campeonato Brasileiro SÃ©rie A', country: 'Brazil' },
                    'PD': { name: 'Primera Division', country: 'Spain' },
                    'FL1': { name: 'Ligue 1', country: 'France' },
                    'ELC': { name: 'Championship', country: 'England' },
                    'PPL': { name: 'Primeira Liga', country: 'Portugal' },
                    'EC': { name: 'European Championship', country: 'Europe' },
                    'SA': { name: 'Serie A', country: 'Italy' },
                    'PL': { name: 'Premier League', country: 'England' },
                    'SPL': { name: 'Saudi Pro League', country: 'Saudi Arabia' }
                };
            }

            // ðŸ† Enhanced Club Logo Service with Real-time Integration
            async getClubLogo(clubName) {
                try {
                    console.log(`ðŸ” Getting club logo with real-time integration: "${clubName}"`);

                    if (!clubName || clubName.trim() === '') {
                        console.warn('âš ï¸ Empty club name provided');
                        return null;
                    }

                    // First, try the integrated club logo service (real-time sync with verified extractor)
                    if (window.clubLogoIntegration) {
                        console.log(`ðŸ”— Using integrated club logo service for: "${clubName}"`);
                        const integrationResult = await window.clubLogoIntegration.searchClubLogo(clubName);

                        if (integrationResult && integrationResult.logoUrl) {
                            console.log(`âœ… Integration service found logo: ${integrationResult.logoUrl} (${integrationResult.source})`);
                            return integrationResult.logoUrl;
                        }
                    }

                    // Fallback: Use intelligent search to normalize the club name
                    const searchResult = await this.intelligentClubSearch(clubName);
                    let searchClubName = clubName.trim();

                    if (searchResult) {
                        // Use the standardized name for better logo matching
                        searchClubName = searchResult.arabicName || searchResult.englishName || clubName.trim();
                        console.log(`ðŸ§  Intelligent search result: "${clubName}" â†’ "${searchClubName}"`);
                    }

                    // Try the unified club logo service with the normalized name
                    const response = await fetch(`/api/get-club-logo?clubName=${encodeURIComponent(searchClubName)}`);

                    if (response.ok) {
                        const data = await response.json();
                        if (data.success && data.data.logoUrl) {
                            console.log(`âœ… Unified service logo loaded: ${data.data.logoUrl}`);
                            return data.data.logoUrl;
                        }
                    }

                    // If unified service fails, try with original name
                    if (searchClubName !== clubName.trim()) {
                        console.log(`ðŸ”„ Trying with original name: "${clubName}"`);
                        const fallbackResponse = await fetch(`/api/get-club-logo?clubName=${encodeURIComponent(clubName.trim())}`);

                        if (fallbackResponse.ok) {
                            const fallbackResult = await fallbackResponse.json();
                            if (fallbackResult.success && fallbackResult.data.logoUrl) {
                                console.log(`âœ… Logo found with original name: ${fallbackResult.data.logoUrl}`);
                                return fallbackResult.data.logoUrl;
                            }
                        }
                    }

                    console.warn(`âŒ All logo services failed for: "${clubName}"`);
                    return null;

                } catch (error) {
                    console.error('ðŸš¨ Error fetching club logo:', error);
                    return null;
                }
            }

            // ðŸ§  Intelligent Club Search System
            async intelligentClubSearch(clubName) {
                try {
                    if (!clubName || clubName.trim() === '') return null;

                    const normalizedQuery = this.normalizeClubName(clubName);

                    // Try exact match first
                    const exactMatch = this.findExactClubMatch(normalizedQuery);
                    if (exactMatch) return exactMatch;

                    // Try variation match
                    const variationMatch = this.findClubVariationMatch(normalizedQuery);
                    if (variationMatch) return variationMatch;

                    // Try partial match
                    const partialMatch = this.findPartialClubMatch(normalizedQuery);
                    if (partialMatch) return partialMatch;

                    // Try fuzzy match
                    const fuzzyMatch = this.findFuzzyClubMatch(normalizedQuery);
                    if (fuzzyMatch) return fuzzyMatch;

                    return null;
                } catch (error) {
                    console.error('ðŸš¨ Error in intelligent club search:', error);
                    return null;
                }
            }

            // Normalize club name for comparison
            normalizeClubName(name) {
                if (!name) return '';

                return name.toLowerCase()
                    .replace(/[Ø£Ø¥Ø¢]/g, 'Ø§')
                    .replace(/[Ø©]/g, 'Ù‡')
                    .replace(/[ÙŠ]/g, 'Ù‰')
                    .replace(/fc|cf|ac|sc|club|football|soccer/gi, '')
                    .replace(/\s+/g, ' ')
                    .trim();
            }

            // Find exact club match
            findExactClubMatch(normalizedQuery) {
                const clubMappings = this.getClubMappings();

                for (const [arabic, english] of clubMappings) {
                    if (this.normalizeClubName(arabic) === normalizedQuery ||
                        this.normalizeClubName(english) === normalizedQuery) {
                        return {
                            arabicName: arabic,
                            englishName: english,
                            matchType: 'exact'
                        };
                    }
                }
                return null;
            }

            // Find club variation match
            findClubVariationMatch(normalizedQuery) {
                const variations = this.getClubVariations();

                for (const [mainName, varList] of Object.entries(variations)) {
                    for (const variation of varList) {
                        if (this.normalizeClubName(variation) === normalizedQuery) {
                            const clubMappings = this.getClubMappings();
                            const mapping = clubMappings.find(([ar, en]) => ar === mainName || en === mainName);

                            if (mapping) {
                                return {
                                    arabicName: this.isArabic(mapping[0]) ? mapping[0] : mapping[1],
                                    englishName: this.isArabic(mapping[0]) ? mapping[1] : mapping[0],
                                    matchType: 'variation'
                                };
                            }
                        }
                    }
                }
                return null;
            }

            // Find partial club match
            findPartialClubMatch(normalizedQuery) {
                const clubMappings = this.getClubMappings();

                for (const [arabic, english] of clubMappings) {
                    const normalizedArabic = this.normalizeClubName(arabic);
                    const normalizedEnglish = this.normalizeClubName(english);

                    if (normalizedArabic.includes(normalizedQuery) ||
                        normalizedQuery.includes(normalizedArabic) ||
                        normalizedEnglish.includes(normalizedQuery) ||
                        normalizedQuery.includes(normalizedEnglish)) {
                        return {
                            arabicName: arabic,
                            englishName: english,
                            matchType: 'partial'
                        };
                    }
                }
                return null;
            }

            // Find fuzzy club match using simple distance
            findFuzzyClubMatch(normalizedQuery) {
                const clubMappings = this.getClubMappings();
                let bestMatch = null;
                let bestDistance = Infinity;
                const threshold = 2;

                for (const [arabic, english] of clubMappings) {
                    const arabicDistance = this.simpleDistance(normalizedQuery, this.normalizeClubName(arabic));
                    const englishDistance = this.simpleDistance(normalizedQuery, this.normalizeClubName(english));

                    const minDistance = Math.min(arabicDistance, englishDistance);

                    if (minDistance <= threshold && minDistance < bestDistance) {
                        bestDistance = minDistance;
                        bestMatch = {
                            arabicName: arabic,
                            englishName: english,
                            matchType: 'fuzzy',
                            distance: minDistance
                        };
                    }
                }

                return bestMatch;
            }

            // Simple distance calculation
            simpleDistance(str1, str2) {
                if (str1.length === 0) return str2.length;
                if (str2.length === 0) return str1.length;

                const matrix = [];
                for (let i = 0; i <= str2.length; i++) {
                    matrix[i] = [i];
                }
                for (let j = 0; j <= str1.length; j++) {
                    matrix[0][j] = j;
                }

                for (let i = 1; i <= str2.length; i++) {
                    for (let j = 1; j <= str1.length; j++) {
                        if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                            matrix[i][j] = matrix[i - 1][j - 1];
                        } else {
                            matrix[i][j] = Math.min(
                                matrix[i - 1][j - 1] + 1,
                                matrix[i][j - 1] + 1,
                                matrix[i - 1][j] + 1
                            );
                        }
                    }
                }
                return matrix[str2.length][str1.length];
            }

            // Check if text is Arabic
            isArabic(text) {
                const arabicRegex = /[\u0600-\u06FF]/;
                return arabicRegex.test(text);
            }

            // Get club mappings
            getClubMappings() {
                return [
                    ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Real Madrid'],
                    ['Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Barcelona'],
                    ['Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Manchester City'],
                    ['Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'Manchester United'],
                    ['Ù„ÙŠÙØ±Ø¨ÙˆÙ„', 'Liverpool'],
                    ['ØªØ´ÙŠÙ„Ø³ÙŠ', 'Chelsea'],
                    ['Ø£Ø±Ø³Ù†Ø§Ù„', 'Arsenal'],
                    ['Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†', 'Paris Saint-Germain'],
                    ['Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', 'Bayern Munich'],
                    ['ÙŠÙˆÙÙ†ØªÙˆØ³', 'Juventus'],
                    ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Al Hilal'],
                    ['Ø§Ù„Ù†ØµØ±', 'Al Nassr'],
                    ['Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯', 'Atletico Madrid'],
                    ['Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†', 'Inter Milan'],
                    ['Ù…ÙŠÙ„Ø§Ù†', 'AC Milan'],
                    ['Ù†Ø§Ø¨ÙˆÙ„ÙŠ', 'Napoli'],
                    ['Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯', 'Borussia Dortmund'],
                    ['Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Al Ittihad'],
                    ['Ø§Ù„Ø£Ù‡Ù„ÙŠ', 'Al Ahli'],
                    ['ØªÙˆØªÙ†Ù‡Ø§Ù…', 'Tottenham'],
                    ['ÙØ§Ù„Ù†Ø³ÙŠØ§', 'Valencia'],
                    ['Ø¥Ø´Ø¨ÙŠÙ„ÙŠØ©', 'Sevilla'],
                    ['ÙÙŠØ§Ø±ÙŠØ§Ù„', 'Villarreal'],
                    ['Ù†ÙŠÙˆÙƒØ§Ø³Ù„', 'Newcastle'],
                    ['Ø£Ø³ØªÙˆÙ† ÙÙŠÙ„Ø§', 'Aston Villa'],
                    ['Ø±ÙˆÙ…Ø§', 'AS Roma'],
                    ['Ù„Ø§ØªØ³ÙŠÙˆ', 'Lazio'],
                    ['Ø£ØªØ§Ù„Ø§Ù†ØªØ§', 'Atalanta'],
                    ['ÙÙŠÙˆØ±Ù†ØªÙŠÙ†Ø§', 'Fiorentina'],
                    ['Ù„Ø§ÙŠØ¨Ø²ÙŠØº', 'RB Leipzig'],
                    ['Ø¨Ø§ÙŠØ± Ù„ÙŠÙØ±ÙƒÙˆØ²Ù†', 'Bayer Leverkusen'],
                    ['ÙØ±Ø§Ù†ÙƒÙÙˆØ±Øª', 'Eintracht Frankfurt'],
                    ['Ù…Ø§Ø±Ø³ÙŠÙ„ÙŠØ§', 'Marseille'],
                    ['Ù„ÙŠÙˆÙ†', 'Lyon'],
                    ['Ù…ÙˆÙ†Ø§ÙƒÙˆ', 'Monaco'],
                    ['Ù†ÙŠØ³', 'Nice'],
                    ['Ø£ÙŠØ§ÙƒØ³', 'Ajax'],
                    ['Ø¨ÙˆØ±ØªÙˆ', 'Porto'],
                    ['Ø¨Ù†ÙÙŠÙƒØ§', 'Benfica'],
                    ['Ø³Ø¨ÙˆØ±ØªÙŠÙ†Øº Ù„Ø´Ø¨ÙˆÙ†Ø©', 'Sporting CP']
                ];
            }

            // Get club variations
            getClubVariations() {
                return {
                    'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯': ['Ø±ÙŠØ§Ù„', 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø§Ù„Ø±ÙŠØ§Ù„', 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³Ø¨Ø§Ù†ÙŠ', 'Real Madrid', 'Real', 'Madrid'],
                    'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©': ['Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø§', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ù‡', 'Ø§Ù„Ø¨Ø§Ø±Ø³Ø§', 'Ø¨Ø§Ø±Ø³Ø§', 'Ø¨Ø±Ø´Ø§', 'Barcelona', 'Barca', 'FC Barcelona'],
                    'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ': ['Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙ‰', 'Ù…Ø§Ù† Ø³ÙŠØªÙŠ', 'Ø§Ù„Ø³ÙŠØªÙŠ', 'Ø³ÙŠØªÙŠ', 'Manchester City', 'Man City', 'City'],
                    'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯': ['Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªÙŠØ¯', 'Ù…Ø§Ù† ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'Ø§Ù„ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'Manchester United', 'Man United', 'United'],
                    'Ù„ÙŠÙØ±Ø¨ÙˆÙ„': ['Ù„ÙŠÙØ±Ø¨ÙˆÙ„', 'Ù„ÙŠÙØ±Ø¨ÙˆÙˆÙ„', 'Ø§Ù„Ù„ÙŠÙØ±', 'Ø§Ù„Ø±ÙŠØ¯Ø²', 'Liverpool', 'LFC', 'Reds'],
                    'ØªØ´ÙŠÙ„Ø³ÙŠ': ['ØªØ´ÙŠÙ„Ø³ÙŠ', 'ØªØ´ÙŠÙ„Ø³Ù‰', 'ØªØ´Ù„Ø³ÙŠ', 'Ø§Ù„Ø¨Ù„ÙˆØ²', 'Chelsea', 'CFC', 'Blues'],
                    'Ø£Ø±Ø³Ù†Ø§Ù„': ['Ø£Ø±Ø³Ù†Ø§Ù„', 'Ø§Ø±Ø³Ù†Ø§Ù„', 'Ø§Ù„Ø§Ø±Ø³Ù†Ø§Ù„', 'Ø§Ù„Ø¬Ø§Ù†Ø±Ø²', 'Arsenal', 'AFC', 'Gunners'],
                    'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†': ['Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†', 'Ø¨Ø§Ø±ÙŠØ³', 'Ø¨ÙŠ Ø§Ø³ Ø¬ÙŠ', 'PSG', 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬Ø±Ù…Ø§Ù†', 'Paris Saint-Germain', 'Paris'],
                    'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®': ['Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', 'Ø¨Ø§ÙŠØ±Ù†', 'Ø§Ù„Ø¨Ø§ÙŠØ±Ù†', 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†ÙŠØ®', 'Bayern Munich', 'Bayern', 'FC Bayern'],
                    'ÙŠÙˆÙÙ†ØªÙˆØ³': ['ÙŠÙˆÙÙ†ØªÙˆØ³', 'ÙŠÙˆÙÙŠ', 'Ø§Ù„ÙŠÙˆÙÙŠ', 'Ø§Ù„Ø³ÙŠØ¯Ø© Ø§Ù„Ø¹Ø¬ÙˆØ²', 'Juventus', 'Juve', 'Juventus FC'],
                    'Ø§Ù„Ù‡Ù„Ø§Ù„': ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ø²Ø¹ÙŠÙ…', 'Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', 'Al Hilal', 'Al-Hilal', 'Hilal'],
                    'Ø§Ù„Ù†ØµØ±': ['Ø§Ù„Ù†ØµØ±', 'Ù†ØµØ±', 'Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ', 'Ø§Ù„Ù†ØµØ± Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', 'Al Nassr', 'Al-Nassr', 'Nassr'],
                    'Ø§Ù„Ø§ØªØ­Ø§Ø¯': ['Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Ø§ØªØ­Ø§Ø¯', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', 'Al Ittihad', 'Al-Ittihad', 'Ittihad'],
                    'Ø§Ù„Ø£Ù‡Ù„ÙŠ': ['Ø§Ù„Ø£Ù‡Ù„ÙŠ', 'Ø£Ù‡Ù„ÙŠ', 'Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', 'Al Ahli', 'Al-Ahli', 'Ahli'],
                    'Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯': ['Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯', 'Ø§ØªÙ„ØªÙŠÙƒÙˆ', 'Ø£ØªÙ„ØªÙŠÙƒÙˆ', 'Atletico Madrid', 'Atletico', 'Atleti'],
                    'Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†': ['Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†', 'Ø§Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†', 'Ø§Ù†ØªØ±', 'Ø¥Ù†ØªØ±', 'Inter Milan', 'Inter', 'Internazionale'],
                    'Ù…ÙŠÙ„Ø§Ù†': ['Ù…ÙŠÙ„Ø§Ù†', 'AC Milan', 'Milan', 'AC Ù…ÙŠÙ„Ø§Ù†'],
                    'Ù†Ø§Ø¨ÙˆÙ„ÙŠ': ['Ù†Ø§Ø¨ÙˆÙ„ÙŠ', 'Napoli', 'SSC Napoli'],
                    'Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯': ['Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯', 'Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯', 'Ø¨ÙˆØ±ØªÙ…ÙˆÙ†Ø¯', 'Borussia Dortmund', 'Dortmund', 'BVB'],
                    'ØªÙˆØªÙ†Ù‡Ø§Ù…': ['ØªÙˆØªÙ†Ù‡Ø§Ù…', 'ØªÙˆØªÙ†Ø§Ù…', 'Tottenham', 'Spurs', 'THFC']
                };
            }





            // ðŸ” Smart Club Search with Advanced Matching
            findClubByName(clubName) {
                if (!clubName) return null;

                const searchTerm = clubName.trim();

                // 1. Direct exact match
                if (this.clubDatabase[searchTerm]) {
                    console.log(`ðŸŽ¯ Direct match found: ${searchTerm}`);
                    return this.clubDatabase[searchTerm];
                }

                // 2. Smart abbreviations and common names
                const smartMappings = {
                    'Ù…Ø§Ù† Ø³ÙŠØªÙŠ': 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ',
                    'Ù…Ø§Ù† ÙŠÙˆÙ†Ø§ÙŠØªØ¯': 'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯',
                    'Ù…Ø§Ù† ÙŠÙˆ': 'Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯',
                    'Ù„ÙŠÙØ±': 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„',
                    'Ø¨Ø±Ø´Ø§': 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©',
                    'Ø±ÙŠØ§Ù„': 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯',
                    'Ø£ØªÙ„ØªÙŠÙƒÙˆ': 'Ø£ØªÙ„ØªÙŠÙƒÙˆ Ù…Ø¯Ø±ÙŠØ¯',
                    'Ø¨ÙŠ Ø¥Ø³ Ø¬ÙŠ': 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†',
                    'Ø¨Ø§Ø±ÙŠØ³': 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†',
                    'ÙŠÙˆÙÙŠ': 'ÙŠÙˆÙÙ†ØªÙˆØ³',
                    'Ø¨Ø§ÙŠØ±Ù†': 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®',
                    'Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯': 'Ø¨ÙˆØ±ÙˆØ³ÙŠØ§ Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯',
                    'Ø§Ù†ØªØ±': 'Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†',
                    'Ù…ÙŠÙ„Ø§Ù†': 'Ù…ÙŠÙ„Ø§Ù†',
                    'Ù†Ø§Ø¨ÙˆÙ„ÙŠ': 'Ù†Ø§Ø¨ÙˆÙ„ÙŠ',
                    'Ø±ÙˆÙ…Ø§': 'Ø±ÙˆÙ…Ø§',
                    'Ù„Ø§ØªØ³ÙŠÙˆ': 'Ù„Ø§ØªØ³ÙŠÙˆ'
                };

                if (smartMappings[searchTerm]) {
                    const mappedName = smartMappings[searchTerm];
                    if (this.clubDatabase[mappedName]) {
                        console.log(`ðŸ§  Smart mapping: ${searchTerm} â†’ ${mappedName}`);
                        return this.clubDatabase[mappedName];
                    }
                }

                // 3. Partial match in Arabic names
                const clubNames = Object.keys(this.clubDatabase);
                for (const name of clubNames) {
                    if (name.includes(searchTerm) || searchTerm.includes(name)) {
                        console.log(`ðŸ” Partial match: ${searchTerm} â†’ ${name}`);
                        return this.clubDatabase[name];
                    }
                }

                // 4. English name search (case insensitive)
                for (const [arabicName, clubInfo] of Object.entries(this.clubDatabase)) {
                    const englishName = clubInfo.english.toLowerCase();
                    const searchLower = searchTerm.toLowerCase();

                    if (englishName.includes(searchLower) || searchLower.includes(englishName)) {
                        console.log(`ðŸŒ English match: ${searchTerm} â†’ ${arabicName}`);
                        return clubInfo;
                    }
                }

                // 5. Advanced fuzzy matching
                for (const [arabicName, clubInfo] of Object.entries(this.clubDatabase)) {
                    // Check if any word in the search term matches any word in club names
                    const searchWords = searchTerm.split(' ');
                    const arabicWords = arabicName.split(' ');
                    const englishWords = clubInfo.english.toLowerCase().split(' ');

                    for (const searchWord of searchWords) {
                        for (const arabicWord of arabicWords) {
                            if (arabicWord.includes(searchWord) || searchWord.includes(arabicWord)) {
                                console.log(`ðŸŽ¯ Word match: ${searchWord} in ${arabicName}`);
                                return clubInfo;
                            }
                        }

                        for (const englishWord of englishWords) {
                            if (englishWord.includes(searchWord.toLowerCase()) || searchWord.toLowerCase().includes(englishWord)) {
                                console.log(`ðŸŒ English word match: ${searchWord} in ${clubInfo.english}`);
                                return clubInfo;
                            }
                        }
                    }
                }

                console.warn(`âŒ No match found for: ${searchTerm}`);
                return null;
            }

            // ðŸ† Get league info
            getLeagueInfo(leagueCode) {
                return this.leagueDatabase[leagueCode] || { name: 'Unknown League', country: 'Unknown' };
            }

            // ðŸŽ¯ Mode Switching with Advanced Animations
            async switchMode(mode) {
                if (this.isProcessing) return;

                console.log(`ðŸ”„ Switching to ${mode} mode`);
                this.isProcessing = true;

                // Hide all sections with stagger animation
                const sections = ['manualInputSection', 'savedPlayersSection', 'multiSection', 'extractSection', 'aiSection'];
                await this.hideAllSections(sections);

                // Show selected section with cosmic entrance
                let sectionId;
                switch(mode) {
                    case 'manual':
                        sectionId = 'manualInputSection';
                        break;
                    case 'saved':
                        sectionId = 'savedPlayersSection';
                        break;
                    case 'multi':
                        sectionId = 'multiSection';
                        break;
                    case 'extract':
                        sectionId = 'extractSection';
                        break;
                    case 'ai':
                        sectionId = 'aiSection';
                        break;
                    default:
                        sectionId = 'manualInputSection';
                }

                await this.showSection(sectionId);

                // Handle mode-specific logic
                switch(mode) {
                    case 'saved':
                        await this.loadSavedPlayers();
                        break;
                    case 'multi':
                        this.initializeMultiMode();
                        break;
                    case 'extract':
                        this.initializeExtractMode();
                        break;
                    case 'ai':
                        this.initializeAIMode();
                        break;
                    case 'manual':
                        this.initializeManualMode();
                        break;
                }

                this.isProcessing = false;
                this.showNotification(`ðŸš€ ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ù†Ù…Ø· ${this.getModeNameArabic(mode)}`, 'success');
            }

            getModeNameArabic(mode) {
                const names = {
                    'manual': 'Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ',
                    'saved': 'Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†',
                    'multi': 'Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ†',
                    'extract': 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨',
                    'ai': 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ'
                };
                return names[mode] || mode;
            }

            async hideAllSections(sections) {
                const promises = sections.map((sectionId, index) => {
                    return new Promise(resolve => {
                        const section = document.getElementById(sectionId);
                        if (section && section.style.display !== 'none') {
                            setTimeout(() => {
                                section.style.transition = 'all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                                section.style.opacity = '0';
                                section.style.transform = 'translateY(30px) scale(0.9)';
                                setTimeout(() => {
                                    section.style.display = 'none';
                                    resolve();
                                }, 500);
                            }, index * 100);
                        } else {
                            resolve();
                        }
                    });
                });
                await Promise.all(promises);
            }

            async showSection(sectionId) {
                return new Promise(resolve => {
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.style.display = 'block';
                        section.style.opacity = '0';
                        section.style.transform = 'translateY(30px) scale(0.9)';

                        setTimeout(() => {
                            section.style.transition = 'all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                            section.style.opacity = '1';
                            section.style.transform = 'translateY(0) scale(1)';
                            setTimeout(resolve, 600);
                        }, 100);
                    } else {
                        resolve();
                    }
                });
            }

            // ðŸŽ¨ Professional Visualization Creation
            async createVisualization() {
                if (this.isProcessing) {
                    this.showNotification('âš¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù…...', 'warning');
                    return;
                }

                const formData = this.getFormData();
                const validation = this.validateInput(formData);

                if (!validation.isValid) {
                    this.showNotification(validation.message, 'error');
                    this.highlightInvalidField(validation.field);
                    return;
                }

                this.isProcessing = true;
                this.updateSystemStatus('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©...');

                try {
                    // Clear any existing content first
                    this.clearPreviewContent();

                    // Show professional loading animation
                    this.showProfessionalLoader();

                    // Get player data with enhanced probability calculation
                    const playerData = await this.getEnhancedPlayerData(formData);

                    // Store current player for reference
                    this.currentPlayer = playerData;

                    // Create FIFA 26 style visualization ONLY
                    await this.generateFIFA26Visualization(playerData);

                    // Check auto-send to overlay
                    checkAutoSendToOverlay();

                    // Check auto-stream
                    checkAutoStreamPlayer();

                    // Check auto-send to direct stream
                    checkAutoSendToDirectStream();

                    // Check auto-send to OBS File System
                    checkAutoSendToOBSFileSystem();

                    // ðŸŽ¬ AUTO SEND TO STREAM - Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ø­Ø³Ù†
                    this.autoSendToStream();

                    this.showNotification(`ðŸŒŸ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù€ ${formData.playerName}!`, 'success');

                } catch (error) {
                    console.error('ðŸš¨ Visualization error:', error);
                    this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØµÙˆØ±', 'error');
                } finally {
                    this.hideProfessionalLoader();
                    this.isProcessing = false;
                    this.updateSystemStatus('Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¨Ø¯Ø§Ø¹');
                }
            }

            // Clear preview content completely
            clearPreviewContent() {
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                if (previewContent) {
                    previewContent.innerHTML = '';
                }

                if (placeholder) {
                    placeholder.style.display = 'none';
                }
            }

            // ðŸ“Š Enhanced Probability Calculation System
            calculateAdvancedProbability(playerName, currentClub, targetClub) {
                console.log(`ðŸ§® Calculating probability: ${playerName} (${currentClub}) â†’ ${targetClub}`);

                let baseProbability = 35;
                let factors = [];

                // Club tier analysis
                const saudiClubs = ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ù†ØµØ±', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Ø§Ù„Ø£Ù‡Ù„ÙŠ', 'Ø§Ù„Ø´Ø¨Ø§Ø¨', 'Ø§Ù„ÙÙŠØµÙ„ÙŠ'];
                const topEuropeanClubs = ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†'];
                const bigClubs = ['Ù…Ø§Ù†Ø´Ø³ØªØ± ÙŠÙˆÙ†Ø§ÙŠØªØ¯', 'ØªØ´ÙŠÙ„Ø³ÙŠ', 'Ø£Ø±Ø³Ù†Ø§Ù„', 'ÙŠÙˆÙÙ†ØªÙˆØ³', 'Ù…ÙŠÙ„Ø§Ù†', 'Ø¥Ù†ØªØ± Ù…ÙŠÙ„Ø§Ù†'];

                // Target club factor
                if (saudiClubs.includes(targetClub)) {
                    baseProbability += 30;
                    factors.push('Saudi League Attraction (+30%)');
                } else if (topEuropeanClubs.includes(targetClub)) {
                    baseProbability += 20;
                    factors.push('Top European Club (+20%)');
                } else if (bigClubs.includes(targetClub)) {
                    baseProbability += 15;
                    factors.push('Big Club Appeal (+15%)');
                }

                // Current club factor
                if (topEuropeanClubs.includes(currentClub)) {
                    baseProbability -= 10;
                    factors.push('Top Club Retention (-10%)');
                }

                // Player name analysis (simplified)
                const starPlayers = ['Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­', 'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§', 'Ù†ÙŠÙ…Ø§Ø±', 'Ù…Ø¨Ø§Ø¨ÙŠ', 'Ù‡Ø§Ù„Ø§Ù†Ø¯'];
                if (starPlayers.some(star => playerName.includes(star.split(' ')[0]))) {
                    baseProbability += 15;
                    factors.push('Star Player Status (+15%)');
                }

                // Market timing factor
                const currentMonth = new Date().getMonth();
                if (currentMonth === 0 || currentMonth === 5 || currentMonth === 6) { // Jan, June, July
                    baseProbability += 10;
                    factors.push('Transfer Window (+10%)');
                }

                // Add controlled randomness
                const randomFactor = Math.floor(Math.random() * 21) - 10; // -10 to +10
                baseProbability += randomFactor;
                factors.push(`Market Dynamics (${randomFactor > 0 ? '+' : ''}${randomFactor}%)`);

                // Ensure realistic range
                const finalProbability = Math.max(15, Math.min(95, baseProbability));

                return {
                    percentage: finalProbability,
                    factors: factors,
                    confidence: this.calculateConfidence(factors.length),
                    trend: this.calculateTrend(finalProbability)
                };
            }

            calculateConfidence(factorCount) {
                if (factorCount >= 4) return 'High';
                if (factorCount >= 2) return 'Medium';
                return 'Low';
            }

            calculateTrend(probability) {
                if (probability >= 70) return 'Very Likely';
                if (probability >= 50) return 'Likely';
                if (probability >= 30) return 'Possible';
                return 'Unlikely';
            }

            // ðŸŽ® FIFA 26 Professional Visualization Generator
            async generateFIFA26Visualization(playerData) {
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                // Apply exit transition to existing card if any
                const existingCard = previewContent.querySelector('.fifa-card');
                if (existingCard) {
                    await this.applyCardExitTransition(existingCard);
                }

                if (placeholder) {
                    placeholder.style.display = 'none';
                }

                const visualizationHTML = this.createFIFA26CardHTML(playerData);
                previewContent.innerHTML = visualizationHTML;

                // Show card initially with transition
                this.showCardInitially();

                // Initialize particle effects (background continues normally)
                this.initializeParticleEffects();

                // Start FIFA animations (background continues normally)
                this.startFIFAAnimations();

                // Add sound effects
                this.playCreationSound();

                // Force OBS refresh for new card
                setTimeout(() => {
                    this.forceOBSRefresh();
                }, 500);
            }

            // Professional loader
            showProfessionalLoader() {
                const placeholder = document.getElementById('previewPlaceholder');
                if (placeholder) {
                    placeholder.style.display = 'flex';
                    placeholder.innerHTML = `
                        <div class="professional-loader" style="text-align: center;">
                            <div style="
                                width: 80px;
                                height: 80px;
                                border: 4px solid rgba(255, 255, 255, 0.1);
                                border-top: 4px solid #00d4ff;
                                border-radius: 50%;
                                animation: professionalSpin 1s linear infinite;
                                margin: 0 auto 20px;
                            "></div>
                            <h3 style="
                                font-family: 'Orbitron', monospace;
                                color: #00d4ff;
                                margin-bottom: 10px;
                            ">Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</h3>
                            <p style="color: rgba(255, 255, 255, 0.7);">Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                        </div>
                        <style>
                            @keyframes professionalSpin {
                                0% { transform: rotate(0deg); }
                                100% { transform: rotate(360deg); }
                            }
                        </style>
                    `;
                }
            }

            hideProfessionalLoader() {
                const placeholder = document.getElementById('previewPlaceholder');
                if (placeholder) {
                    placeholder.style.display = 'none';
                }
            }

            clearPreviewContent() {
                const previewContent = document.getElementById('previewContent');
                if (previewContent) {
                    previewContent.innerHTML = '';
                }

                // Stop any running sequence
                this.stopSequence();
            }

            // Start FIFA-style animations
            startFIFAAnimations() {
                // FIFA animations are handled by CSS
                console.log('ðŸŽ® FIFA 26 animations started');
            }

            // ðŸ’° Financial Analysis 3D Visualization Generator
            async generateFinancialVisualization(playerData) {
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                // Apply exit transition to existing card if any
                const existingCard = previewContent.querySelector('.financial-card');
                if (existingCard) {
                    await this.applyCardExitTransition(existingCard);
                }

                if (placeholder) {
                    placeholder.style.display = 'none';
                }

                const visualizationHTML = this.createPlayerCardHTML(playerData);
                previewContent.innerHTML = visualizationHTML;

                // Apply entrance transition to new card
                const newCard = previewContent.querySelector('.financial-card');
                if (newCard) {
                    // Set initial state for smooth transition
                    newCard.style.opacity = '0';
                    newCard.style.visibility = 'visible';
                    newCard.style.transform = '';
                    newCard.style.clipPath = '';

                    // Apply transition after a small delay to the card only
                    setTimeout(() => {
                        this.applyCardTransition(previewContent); // Pass container, function will find the card
                    }, 100);
                }

                // Initialize 3D financial effects (background continues normally)
                this.initializeFinancial3DEffects();

                // Start financial animations (background continues normally)
                this.startFinancialAnimations();

                // Add sound effects
                this.playCreationSound();
            }

            // ðŸ’° Financial Card HTML Generator (3D Mathematical Style)
            createFinancialCardHTML(player, animationDelay = 0) {
                const probability = player.probability;
                const probabilityValue = probability.percentage;
                const probabilityColor = this.getProbabilityColor(probabilityValue);
                const marketValueNum = this.extractMarketValue(player.marketValue);
                const transferFee = this.calculateTransferFee(marketValueNum, probabilityValue);

                return `
                    <div class="financial-card-container" style="
                        width: 100%;
                        height: 100%;
                        position: relative;
                        background:
                            radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                            radial-gradient(circle at 80% 80%, rgba(0, 255, 127, 0.1) 0%, transparent 50%),
                            linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%);
                        overflow: hidden;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        padding: 20px;
                        perspective: 1000px;
                    ">
                        <!-- 3D Mathematical Background -->
                        <div class="math-background" style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 1;
                            opacity: 0.3;
                            background-image:
                                url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><text x=\"10\" y=\"20\" font-family=\"monospace\" font-size=\"8\" fill=\"%23ffd700\">$</text><text x=\"70\" y=\"40\" font-family=\"monospace\" font-size=\"6\" fill=\"%2300ff7f\">%</text><text x=\"30\" y=\"60\" font-family=\"monospace\" font-size=\"7\" fill=\"%23ff6b6b\">â‚¬</text><text x=\"80\" y=\"80\" font-family=\"monospace\" font-size=\"5\" fill=\"%234ecdc4\">âˆ‘</text></svg>');
                            animation: mathFloat 20s linear infinite;
                        "></div>

                        <!-- Floating Dollar Signs -->
                        <div class="floating-dollars" style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 2;
                        ">
                            ${this.generateFloatingDollars()}
                        </div>

                        <!-- Enhanced Financial Analysis Card -->
                        <div class="financial-card" style="
                            position: relative;
                            z-index: 10;
                            width: 450px;
                            height: 650px;
                            background: linear-gradient(135deg,
                                rgba(0, 0, 0, 0.95) 0%,
                                rgba(26, 26, 46, 0.98) 30%,
                                rgba(22, 33, 62, 0.95) 70%,
                                rgba(15, 25, 45, 0.98) 100%);
                            border-radius: 30px;
                            padding: 0;
                            overflow: hidden;
                            box-shadow:
                                0 35px 70px rgba(0, 0, 0, 0.7),
                                0 0 0 1px rgba(255, 215, 0, 0.4),
                                0 0 50px rgba(${probabilityColor.replace('#', '').match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.3),
                                inset 0 2px 0 rgba(255, 255, 255, 0.15),
                                inset 0 -2px 0 rgba(0, 0, 0, 0.3);
                            animation: financialEntrance 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${animationDelay}s both;
                            transform-style: preserve-3d;
                            border: 3px solid rgba(255, 215, 0, 0.5);
                        ">
                            <!-- Animated Background Particles -->
                            <div style="
                                position: absolute;
                                top: 0;
                                left: 0;
                                width: 100%;
                                height: 100%;
                                background:
                                    radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                                    radial-gradient(circle at 80% 70%, rgba(${probabilityColor.replace('#', '').match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.1) 0%, transparent 50%),
                                    radial-gradient(circle at 40% 80%, rgba(0, 255, 127, 0.05) 0%, transparent 50%);
                                animation: particleFloat 8s ease-in-out infinite;
                                pointer-events: none;
                            "></div>

                            <!-- Geometric Pattern Overlay -->
                            <div style="
                                position: absolute;
                                top: 0;
                                left: 0;
                                width: 100%;
                                height: 100%;
                                background-image:
                                    linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.02) 50%, transparent 60%),
                                    linear-gradient(-45deg, transparent 40%, rgba(255, 255, 255, 0.02) 50%, transparent 60%);
                                background-size: 30px 30px;
                                animation: patternShift 10s linear infinite;
                                pointer-events: none;
                            "></div>
                            <!-- Header with 3D Probability -->
                            <div class="financial-header" style="
                                position: relative;
                                height: 160px;
                                background: linear-gradient(135deg,
                                    rgba(255, 215, 0, 0.2) 0%,
                                    rgba(0, 255, 127, 0.1) 100%);
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                padding: 20px;
                                border-bottom: 2px solid rgba(255, 215, 0, 0.3);
                                overflow: hidden;
                            ">
                                <!-- 3D Probability Display -->
                                <div class="probability-3d" style="
                                    position: relative;
                                    width: 200px;
                                    height: 120px;
                                    background: ${this.getFinancialProbabilityBackground(probabilityValue)};
                                    border-radius: 20px;
                                    border: 3px solid ${this.getFinancialProbabilityBorder(probabilityValue)};
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    justify-content: center;
                                    transform: rotateX(10deg) rotateY(-5deg);
                                    box-shadow:
                                        0 20px 40px rgba(0, 0, 0, 0.5),
                                        0 0 30px ${this.getFinancialProbabilityGlow(probabilityValue)};
                                    animation: probability3DFloat 4s ease-in-out infinite;
                                ">
                                    <!-- Percentage with 3D effect -->
                                    <div style="
                                        font-size: 3.5rem;
                                        font-weight: 900;
                                        font-family: 'Orbitron', monospace;
                                        color: ${this.getFinancialTextColor(probabilityValue)};
                                        text-shadow:
                                            0 0 20px ${this.getFinancialTextGlow(probabilityValue)},
                                            2px 2px 0px rgba(0, 0, 0, 0.8),
                                            4px 4px 0px rgba(0, 0, 0, 0.6);
                                        animation: numberPulse3D 3s ease-in-out infinite;
                                        transform: translateZ(20px);
                                    ">${probabilityValue}%</div>

                                    <!-- Label -->
                                    <div style="
                                        font-size: 0.9rem;
                                        color: rgba(255, 215, 0, 0.9);
                                        font-weight: 700;
                                        margin-top: 8px;
                                        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
                                        letter-spacing: 1px;
                                    ">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</div>
                                </div>
                            </div>

                            <!-- Player Info Section -->
                            <div class="financial-player-info" style="
                                padding: 25px;
                                background: linear-gradient(180deg,
                                    rgba(0, 0, 0, 0.3) 0%,
                                    rgba(0, 0, 0, 0.5) 100%);
                            ">
                                <!-- Player Name with 3D effect -->
                                <h1 style="
                                    font-size: 2rem;
                                    font-weight: 900;
                                    font-family: 'Orbitron', monospace;
                                    color: #ffd700;
                                    text-align: center;
                                    margin-bottom: 20px;
                                    text-shadow:
                                        0 0 20px rgba(255, 215, 0, 0.8),
                                        2px 2px 0px rgba(0, 0, 0, 0.8),
                                        4px 4px 0px rgba(0, 0, 0, 0.6);
                                    animation: nameGlow3D 3s ease-in-out infinite;
                                    transform: translateZ(15px);
                                ">${player.arabicName}</h1>

                                <!-- Financial Stats Grid -->
                                <div class="financial-stats" style="
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 15px;
                                    margin-bottom: 25px;
                                ">
                                    <!-- Market Value -->
                                    <div class="financial-stat" style="
                                        background: linear-gradient(135deg,
                                            rgba(255, 215, 0, 0.2) 0%,
                                            rgba(255, 215, 0, 0.1) 100%);
                                        border: 2px solid rgba(255, 215, 0, 0.4);
                                        border-radius: 15px;
                                        padding: 15px;
                                        text-align: center;
                                        transform: rotateX(5deg);
                                        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                                    ">
                                        <div style="color: rgba(255, 215, 0, 0.8); font-size: 0.8rem; margin-bottom: 5px;">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ©</div>
                                        <div style="color: #ffd700; font-weight: 900; font-size: 1.2rem;">
                                            ðŸ’° ${player.marketValue}
                                        </div>
                                    </div>

                                    <!-- Transfer Fee -->
                                    <div class="financial-stat" style="
                                        background: linear-gradient(135deg,
                                            rgba(0, 255, 127, 0.2) 0%,
                                            rgba(0, 255, 127, 0.1) 100%);
                                        border: 2px solid rgba(0, 255, 127, 0.4);
                                        border-radius: 15px;
                                        padding: 15px;
                                        text-align: center;
                                        transform: rotateX(5deg);
                                        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                                    ">
                                        <div style="color: rgba(0, 255, 127, 0.8); font-size: 0.8rem; margin-bottom: 5px;">Ø±Ø³ÙˆÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</div>
                                        <div style="color: #00ff7f; font-weight: 900; font-size: 1.2rem;">
                                            ðŸ’¸ ${transferFee}
                                        </div>
                                    </div>

                                    <!-- Current Club with Logo -->
                                    <div class="financial-stat" style="
                                        background: linear-gradient(135deg,
                                            rgba(255, 255, 255, 0.1) 0%,
                                            rgba(255, 255, 255, 0.05) 100%);
                                        border: 2px solid rgba(255, 255, 255, 0.3);
                                        border-radius: 15px;
                                        padding: 15px;
                                        text-align: center;
                                        transform: rotateX(5deg);
                                        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                                        display: flex;
                                        flex-direction: column;
                                        align-items: center;
                                    ">
                                        <div style="color: rgba(255, 255, 255, 0.9); font-size: 0.85rem; margin-bottom: 12px; font-weight: 600;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                                        ${player.currentClubLogo ? `
                                        <div style="
                                            position: relative;
                                            margin-bottom: 8px;
                                            padding: 8px;
                                            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
                                            border-radius: 12px;
                                            backdrop-filter: blur(10px);
                                            border: 1px solid rgba(255, 255, 255, 0.25);
                                            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                                        ">
                                            <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                                width: ${this.settings.clubLogoSize || 24}px;
                                                height: ${this.settings.clubLogoSize || 24}px;
                                                object-fit: contain;
                                                border-radius: 6px;
                                                filter: drop-shadow(0 4px 15px rgba(255, 255, 255, 0.4)) brightness(1.1) contrast(1.1);
                                                transition: all 0.3s ease;
                                            " onerror="this.style.display='none'">
                                        </div>
                                        ` : ''}
                                        <div style="color: white; font-weight: 700; font-size: 1rem; text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);">${player.currentClub}</div>
                                    </div>

                                    <!-- Target Club with Logo -->
                                    <div class="financial-stat" style="
                                        background: linear-gradient(135deg,
                                            ${probabilityColor}40 0%,
                                            ${probabilityColor}20 100%);
                                        border: 2px solid ${probabilityColor}60;
                                        border-radius: 15px;
                                        padding: 15px;
                                        text-align: center;
                                        transform: rotateX(5deg);
                                        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                                        display: flex;
                                        flex-direction: column;
                                        align-items: center;
                                    ">
                                        <div style="color: ${probabilityColor}; font-size: 0.85rem; margin-bottom: 12px; font-weight: 600;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</div>
                                        ${player.targetClubLogo ? `
                                        <div style="
                                            position: relative;
                                            margin-bottom: 8px;
                                            padding: 10px;
                                            background: linear-gradient(135deg, ${probabilityColor}25, ${probabilityColor}15);
                                            border-radius: 15px;
                                            backdrop-filter: blur(15px);
                                            border: 2px solid ${probabilityColor}60;
                                            box-shadow: 0 6px 20px ${probabilityColor}30;
                                            animation: targetGlow 2s ease-in-out infinite alternate;
                                        ">
                                            <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                                width: ${this.settings.clubLogoSize || 24}px;
                                                height: ${this.settings.clubLogoSize || 24}px;
                                                object-fit: contain;
                                                border-radius: 8px;
                                                filter: drop-shadow(0 6px 20px ${probabilityColor}80) brightness(1.2) contrast(1.15);
                                                transition: all 0.3s ease;
                                            " onerror="this.style.display='none'">
                                        </div>
                                        ` : ''}
                                        <div style="color: ${probabilityColor}; font-weight: 700; font-size: 1rem; text-shadow: 0 2px 10px ${probabilityColor}60;">${player.targetClub}</div>
                                    </div>
                                </div>

                                <!-- Financial Analysis -->
                                <div class="financial-analysis" style="
                                    background: linear-gradient(135deg,
                                        rgba(0, 0, 0, 0.6) 0%,
                                        rgba(26, 26, 46, 0.4) 100%);
                                    border: 2px solid rgba(255, 215, 0, 0.3);
                                    border-radius: 20px;
                                    padding: 20px;
                                    margin-bottom: 20px;
                                    transform: rotateX(3deg);
                                    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
                                ">
                                    <h3 style="
                                        color: #ffd700;
                                        font-size: 1.2rem;
                                        font-weight: 700;
                                        margin-bottom: 15px;
                                        text-align: center;
                                        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
                                    ">ðŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h3>

                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9rem;">
                                        <div style="color: rgba(255, 255, 255, 0.8);">Ø§Ù„Ø¹Ù…Ø±:</div>
                                        <div style="color: #00ff7f; font-weight: 600;">${player.age} Ø³Ù†Ø©</div>

                                        <div style="color: rgba(255, 255, 255, 0.8);">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©:</div>
                                        <div style="color: ${probabilityColor}; font-weight: 600;">${probability.confidence}</div>

                                        <div style="color: rgba(255, 255, 255, 0.8);">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­:</div>
                                        <div style="color: ${probabilityColor}; font-weight: 600;">${probabilityValue}%</div>


                                    </div>
                                </div>
                            </div>

                            <!-- Footer with Target Club -->
                            <div class="financial-footer" style="
                                position: absolute;
                                bottom: 0;
                                left: 0;
                                right: 0;
                                height: 60px;
                                background: linear-gradient(135deg,
                                    rgba(255, 215, 0, 0.3) 0%,
                                    rgba(0, 255, 127, 0.2) 100%);
                                border-top: 3px solid rgba(255, 215, 0, 0.5);
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-weight: 700;
                                color: #ffd700;
                                font-size: 1.1rem;
                                text-align: center;
                                padding: 0 20px;
                                box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
                                animation: footerGlow3D 4s ease-in-out infinite;
                            ">
                                <div style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
                                ">
                                    <div style="font-size: 0.8rem; opacity: 0.9; margin-bottom: 5px;">Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</div>
                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        gap: 10px;
                                        font-size: 1.3rem;
                                        font-weight: 900;
                                    ">
                                        ${player.targetClubLogo ? `
                                        <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                            width: ${this.settings.targetClubLogoSize || 28}px;
                                            height: ${this.settings.targetClubLogoSize || 28}px;
                                            object-fit: contain;
                                            border-radius: 4px;
                                            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
                                        " onerror="this.style.display='none'">
                                        ` : ''}
                                        <span>${player.targetClub}</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Financial Animations CSS -->
                        <style>
                            @keyframes financialEntrance {
                                0% {
                                    opacity: 0;
                                    transform: translateY(100px) rotateX(45deg) scale(0.8);
                                    filter: blur(10px);
                                }
                                100% {
                                    opacity: 1;
                                    transform: translateY(0) rotateX(0deg) scale(1);
                                    filter: blur(0px);
                                }
                            }

                            @keyframes probability3DFloat {
                                0%, 100% {
                                    transform: rotateX(10deg) rotateY(-5deg) translateZ(0px);
                                }
                                50% {
                                    transform: rotateX(15deg) rotateY(5deg) translateZ(10px);
                                }
                            }

                            @keyframes numberPulse3D {
                                0%, 100% {
                                    transform: translateZ(20px) scale(1);
                                    text-shadow:
                                        0 0 20px ${this.getFinancialTextGlow(probabilityValue)},
                                        2px 2px 0px rgba(0, 0, 0, 0.8),
                                        4px 4px 0px rgba(0, 0, 0, 0.6);
                                }
                                50% {
                                    transform: translateZ(30px) scale(1.05);
                                    text-shadow:
                                        0 0 30px ${this.getFinancialTextGlow(probabilityValue)},
                                        3px 3px 0px rgba(0, 0, 0, 0.8),
                                        6px 6px 0px rgba(0, 0, 0, 0.6);
                                }
                            }

                            @keyframes nameGlow3D {
                                0%, 100% {
                                    transform: translateZ(15px);
                                    text-shadow:
                                        0 0 20px rgba(255, 215, 0, 0.8),
                                        2px 2px 0px rgba(0, 0, 0, 0.8),
                                        4px 4px 0px rgba(0, 0, 0, 0.6);
                                }
                                50% {
                                    transform: translateZ(25px);
                                    text-shadow:
                                        0 0 30px rgba(255, 215, 0, 1),
                                        3px 3px 0px rgba(0, 0, 0, 0.8),
                                        6px 6px 0px rgba(0, 0, 0, 0.6);
                                }
                            }

                            @keyframes footerGlow3D {
                                0%, 100% {
                                    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
                                }
                                50% {
                                    box-shadow:
                                        0 -5px 20px rgba(0, 0, 0, 0.3),
                                        0 0 30px rgba(255, 215, 0, 0.4);
                                }
                            }

                            @keyframes mathFloat {
                                0% { transform: translateY(0px) rotate(0deg); }
                                50% { transform: translateY(-20px) rotate(180deg); }
                                100% { transform: translateY(0px) rotate(360deg); }
                            }

                            .floating-dollar {
                                position: absolute;
                                font-size: 2rem;
                                color: rgba(255, 215, 0, 0.6);
                                animation: dollarFloat 15s linear infinite;
                                pointer-events: none;
                            }

                            @keyframes dollarFloat {
                                0% {
                                    transform: translateY(100vh) rotate(0deg);
                                    opacity: 0;
                                }
                                10% {
                                    opacity: 1;
                                }
                                90% {
                                    opacity: 1;
                                }
                                100% {
                                    transform: translateY(-100px) rotate(360deg);
                                    opacity: 0;
                                }
                            }
                        </style>
                    </div>
                `;
            }

            // ðŸ’° Financial Helper Functions
            generateFloatingDollars() {
                let dollarsHTML = '';
                const symbols = ['$', 'â‚¬', 'Â£', 'Â¥', 'â‚¹', '%', 'âˆ‘', 'âˆ†'];

                for (let i = 0; i < 8; i++) {
                    const symbol = symbols[i % symbols.length];
                    const left = Math.random() * 100;
                    const delay = Math.random() * 15;
                    const duration = 15 + Math.random() * 10;

                    dollarsHTML += `
                        <div class="floating-dollar" style="
                            left: ${left}%;
                            animation-delay: ${delay}s;
                            animation-duration: ${duration}s;
                        ">${symbol}</div>
                    `;
                }

                return dollarsHTML;
            }

            extractMarketValue(marketValueStr) {
                // Extract numeric value from market value string
                const match = marketValueStr.match(/[\d.]+/);
                return match ? parseFloat(match[0]) : 50;
            }

            calculateTransferFee(marketValue, probability) {
                // Calculate transfer fee based on market value and probability
                const baseFee = marketValue * 1.2; // 20% markup
                const probabilityMultiplier = 1 + (probability / 100) * 0.5; // Up to 50% increase for high probability
                const finalFee = baseFee * probabilityMultiplier;

                if (finalFee >= 100) {
                    return `${(finalFee / 1).toFixed(0)}M â‚¬`;
                } else {
                    return `${finalFee.toFixed(1)}M â‚¬`;
                }
            }

            getFinancialProbabilityBackground(probability) {
                if (probability >= 75) {
                    return 'linear-gradient(135deg, rgba(34, 197, 94, 0.3) 0%, rgba(16, 185, 129, 0.2) 100%)';
                } else if (probability >= 50) {
                    return 'linear-gradient(135deg, rgba(245, 158, 11, 0.3) 0%, rgba(251, 191, 36, 0.2) 100%)';
                } else {
                    return 'linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(220, 38, 38, 0.2) 100%)';
                }
            }

            getFinancialProbabilityBorder(probability) {
                if (probability >= 75) return 'rgba(34, 197, 94, 0.6)';
                if (probability >= 50) return 'rgba(245, 158, 11, 0.6)';
                return 'rgba(239, 68, 68, 0.6)';
            }

            getFinancialProbabilityGlow(probability) {
                if (probability >= 75) return 'rgba(34, 197, 94, 0.4)';
                if (probability >= 50) return 'rgba(245, 158, 11, 0.4)';
                return 'rgba(239, 68, 68, 0.4)';
            }

            getFinancialTextColor(probability) {
                if (probability >= 75) return '#22c55e';
                if (probability >= 50) return '#f59e0b';
                return '#ef4444';
            }

            getFinancialTextGlow(probability) {
                if (probability >= 75) return 'rgba(34, 197, 94, 0.8)';
                if (probability >= 50) return 'rgba(245, 158, 11, 0.8)';
                return 'rgba(239, 68, 68, 0.8)';
            }

            getFinancialRating(probability) {
                if (probability >= 90) return 'â­â­â­â­â­ Ù…Ù…ØªØ§Ø²';
                if (probability >= 75) return 'â­â­â­â­ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹';
                if (probability >= 60) return 'â­â­â­ Ø¬ÙŠØ¯';
                if (probability >= 40) return 'â­â­ Ù…ØªÙˆØ³Ø·';
                return 'â­ Ø¶Ø¹ÙŠÙ';
            }

            initializeFinancial3DEffects() {
                // Initialize 3D financial particle effects
                console.log('ðŸ’° Financial 3D effects initialized');
                this.createFinancialParticles();
            }

            createFinancialParticles() {
                // Create floating mathematical symbols
                const container = document.querySelector('.financial-card-container');
                if (!container) return;

                for (let i = 0; i < 15; i++) {
                    const particle = document.createElement('div');
                    particle.style.cssText = `
                        position: absolute;
                        font-size: ${Math.random() * 20 + 10}px;
                        color: rgba(255, 215, 0, ${Math.random() * 0.3 + 0.1});
                        pointer-events: none;
                        z-index: 3;
                        left: ${Math.random() * 100}%;
                        top: ${Math.random() * 100}%;
                        animation: financialParticleFloat ${Math.random() * 10 + 15}s linear infinite;
                        animation-delay: ${Math.random() * 5}s;
                    `;

                    const symbols = ['$', 'â‚¬', 'Â£', 'Â¥', '%', 'âˆ‘', 'âˆ†', 'âˆž', 'Â±', 'â‰ˆ'];
                    particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];

                    container.appendChild(particle);
                }

                // Add particle animation CSS
                if (!document.getElementById('financialParticleStyles')) {
                    const style = document.createElement('style');
                    style.id = 'financialParticleStyles';
                    style.textContent = `
                        @keyframes financialParticleFloat {
                            0% {
                                transform: translateY(0px) rotate(0deg);
                                opacity: 0;
                            }
                            10% {
                                opacity: 1;
                            }
                            90% {
                                opacity: 1;
                            }
                            100% {
                                transform: translateY(-100vh) rotate(360deg);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            startFinancialAnimations() {
                // Start financial-specific animations
                console.log('ðŸ’° Financial animations started');
            }

            // ðŸŽ® FIFA 26 Card HTML Generator (Clean & Professional)
            createFIFA26CardHTML(player, animationDelay = 0) {
                const probability = player.probability;
                const probabilityValue = probability.percentage;
                const probabilityColor = this.getProbabilityColor(probabilityValue);
                const cardGradient = this.getCardGradient(probabilityValue);
                const ratingColor = this.getRatingColor(player.rating);
                const gradientId = `gradient-${Date.now()}`;

                return `
                    <div class="fifa-card-container" style="
                        width: 100%;
                        height: 100%;
                        position: relative;
                        background: radial-gradient(circle at center, #0a0a0f 0%, #1a0b2e 100%);
                        overflow: hidden;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        padding: 20px;
                    ">
                        <!-- Particle Canvas -->
                        <canvas id="particleCanvas" style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 1;
                        "></canvas>

                        <!-- FIFA 26 Style Card -->
                        <div class="fifa-card" style="
                            position: relative;
                            z-index: 10;
                            width: 400px;
                            height: 600px;
                            background: ${cardGradient};
                            border-radius: 25px;
                            padding: 0;
                            overflow: hidden;
                            box-shadow:
                                0 25px 50px rgba(0, 0, 0, 0.5),
                                0 0 0 1px rgba(255, 255, 255, 0.1),
                                inset 0 1px 0 rgba(255, 255, 255, 0.2);
                            animation: none;
                            transform-style: preserve-3d;
                        ">
                            <!-- Card Header -->
                            <div class="card-header" style="
                                position: relative;
                                height: 140px;
                                background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(255, 255, 255, 0.1));
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                padding: 20px;
                                border-bottom: 2px solid rgba(255, 255, 255, 0.2);
                            ">
                                <!-- Specialized Probability Zone -->
                                <div class="probability-zone" style="
                                    position: relative;
                                    width: 180px;
                                    height: 120px;
                                    background: ${this.getProbabilityZoneBackground(probabilityValue)};
                                    border-radius: 25px;
                                    border: 3px solid ${this.getProbabilityZoneBorder(probabilityValue)};
                                    box-shadow:
                                        0 0 30px ${this.getProbabilityZoneGlow(probabilityValue)},
                                        inset 0 2px 10px rgba(255, 255, 255, 0.1);
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    justify-content: center;
                                    animation: ${this.getProbabilityZoneAnimation(probabilityValue)} 4s ease-in-out infinite;
                                ">
                                    <!-- Floating Particles Background -->
                                    <div style="
                                        position: absolute;
                                        top: 0;
                                        left: 0;
                                        right: 0;
                                        bottom: 0;
                                        border-radius: 22px;
                                        background: ${this.getProbabilityParticlePattern(probabilityValue)};
                                        opacity: 0.4;
                                        animation: particleFloat 6s linear infinite;
                                    "></div>

                                    <!-- Main Percentage Display -->
                                    <div class="percentage-display" style="
                                        position: relative;
                                        z-index: 3;
                                        font-size: 3.2rem;
                                        font-weight: 900;
                                        font-family: 'Orbitron', monospace;
                                        color: ${this.getProbabilityTextColor(probabilityValue)};
                                        text-shadow:
                                            0 0 20px ${this.getProbabilityTextGlow(probabilityValue)},
                                            0 2px 4px rgba(0, 0, 0, 0.5);
                                        animation: ${this.getProbabilityTextAnimation(probabilityValue)} 3s ease-in-out infinite;
                                        filter: drop-shadow(0 0 10px ${this.getProbabilityTextGlow(probabilityValue)});
                                    ">${probabilityValue}%</div>

                                    <!-- Specialized Progress Ring -->
                                    <div style="
                                        position: relative;
                                        width: 140px;
                                        height: 12px;
                                        background: ${this.getProbabilityTrackColor(probabilityValue)};
                                        border-radius: 15px;
                                        overflow: hidden;
                                        margin-top: 12px;
                                        border: 2px solid ${this.getProbabilityTrackBorder(probabilityValue)};
                                        box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.3);
                                    ">
                                        <div style="
                                            width: ${probabilityValue}%;
                                            height: 100%;
                                            background: ${this.getProbabilityFillGradient(probabilityValue)};
                                            border-radius: 15px;
                                            animation:
                                                progressSlide 2.5s ease-out 0.5s both,
                                                ${this.getProbabilityFillAnimation(probabilityValue)} 4s ease-in-out infinite;
                                            box-shadow:
                                                0 0 20px ${this.getProbabilityFillGlow(probabilityValue)},
                                                inset 0 1px 3px rgba(255, 255, 255, 0.3);
                                        "></div>

                                        <!-- Dynamic Sparkle Effect -->
                                        ${this.getProbabilitySparkleEffect(probabilityValue)}
                                    </div>

                                    <!-- Elegant Label -->
                                    <div style="
                                        position: relative;
                                        z-index: 3;
                                        font-size: 0.85rem;
                                        color: ${this.getProbabilityLabelColor(probabilityValue)};
                                        font-weight: 700;
                                        margin-top: 10px;
                                        text-align: center;
                                        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
                                        letter-spacing: 0.5px;
                                    ">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</div>
                                </div>
                            </div>

                            <!-- Player Image Section -->
                            <div class="player-image-section" style="
                                position: relative;
                                height: 280px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                overflow: hidden;
                            ">
                                <!-- Background Pattern -->
                                <div style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    right: 0;
                                    bottom: 0;
                                    background:
                                        radial-gradient(circle at 30% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                                        radial-gradient(circle at 70% 30%, ${probabilityColor}20 0%, transparent 50%);
                                    animation: backgroundShift 8s ease-in-out infinite;
                                "></div>

                                <!-- Target Club Logo (Large) -->
                                ${player.targetClubLogo ? `
                                <div class="target-club-logo-large" style="
                                    position: absolute;
                                    top: 20px;
                                    right: 20px;
                                    z-index: 5;
                                    background: linear-gradient(135deg,
                                        rgba(0, 0, 0, 0.8) 0%,
                                        rgba(0, 0, 0, 0.6) 100%);
                                    border-radius: 20px;
                                    padding: 15px;
                                    border: 3px solid ${probabilityColor}60;
                                    box-shadow:
                                        0 10px 30px rgba(0, 0, 0, 0.5),
                                        0 0 20px ${probabilityColor}40;
                                    animation: targetLogoFloat 4s ease-in-out infinite;
                                    backdrop-filter: blur(10px);
                                ">
                                    <img src="${player.targetClubLogo}"
                                         alt="${player.targetClub}"
                                         style="
                                            width: ${(this.settings.targetClubLogoSize || 28) * 2.5}px;
                                            height: ${(this.settings.targetClubLogoSize || 28) * 2.5}px;
                                            object-fit: contain;
                                            border-radius: 8px;
                                            filter:
                                                drop-shadow(0 0 15px ${probabilityColor}80)
                                                brightness(1.1)
                                                contrast(1.1);
                                            transition: all 0.3s ease;
                                         "
                                         onerror="this.style.display='none'">

                                    <!-- Target Club Name -->
                                    <div style="
                                        text-align: center;
                                        margin-top: 8px;
                                        color: ${probabilityColor};
                                        font-size: 0.8rem;
                                        font-weight: 700;
                                        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
                                        letter-spacing: 0.5px;
                                    ">${player.targetClub}</div>
                                </div>
                                ` : ''}

                                <!-- Player Image -->
                                <img src="${this.getPlayerImageUrl(player)}"
                                     alt="${player.arabicName}"
                                     class="player-image"
                                     style="
                                        width: ${this.settings.playerImageSize || 200}px;
                                        height: ${this.settings.playerImageSize || 200}px;
                                        border-radius: 50%;
                                        border: 5px solid rgba(255, 255, 255, 0.3);
                                        object-fit: cover;
                                        position: relative;
                                        z-index: 2;
                                        filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
                                        animation: playerFloat 3s ease-in-out infinite;
                                        transition: all 0.3s ease;
                                     "
                                     onerror="this.src='${this.getFallbackImageUrl(player.arabicName)}'">

                                <!-- Glow Effect -->
                                <div style="
                                    position: absolute;
                                    top: 50%;
                                    left: 50%;
                                    transform: translate(-50%, -50%);
                                    width: ${(this.settings.playerImageSize || 200) + 20}px;
                                    height: ${(this.settings.playerImageSize || 200) + 20}px;
                                    border-radius: 50%;
                                    background: radial-gradient(circle, ${probabilityColor}30 0%, transparent 70%);
                                    animation: glowPulse 2s ease-in-out infinite;
                                    z-index: 1;
                                    transition: all 0.3s ease;
                                "></div>
                            </div>

                            <!-- Player Info Section -->
                            <div class="player-info" style="
                                padding: 20px;
                                background: linear-gradient(180deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.4));
                                border-top: 1px solid rgba(255, 255, 255, 0.1);
                            ">
                                <!-- Player Name -->
                                <h1 style="
                                    font-size: 1.8rem;
                                    font-weight: 900;
                                    font-family: 'Orbitron', monospace;
                                    color: white;
                                    text-align: center;
                                    margin-bottom: 15px;
                                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                                    animation: nameGlow 3s ease-in-out infinite;
                                ">${player.arabicName}</h1>

                                <!-- Stats Grid -->
                                <div class="stats-grid" style="
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 15px;
                                    margin-bottom: 20px;
                                ">
                                    <!-- Age -->
                                    <div class="stat-item" style="
                                        background: rgba(255, 255, 255, 0.1);
                                        border-radius: 10px;
                                        padding: 12px;
                                        text-align: center;
                                        border: 1px solid rgba(255, 255, 255, 0.2);
                                    ">
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; margin-bottom: 5px;">Ø§Ù„Ø¹Ù…Ø±</div>
                                        <div style="color: white; font-weight: 700; font-size: 1.1rem;">${player.age} Ø³Ù†Ø©</div>
                                    </div>

                                    <!-- Current Club -->
                                    <div class="stat-item" style="
                                        background: rgba(255, 255, 255, 0.1);
                                        border-radius: 10px;
                                        padding: 12px;
                                        text-align: center;
                                        border: 1px solid rgba(255, 255, 255, 0.2);
                                        display: flex;
                                        flex-direction: column;
                                        align-items: center;
                                    ">
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; margin-bottom: 5px;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                                        ${player.currentClubLogo ? `
                                        <img src="${player.currentClubLogo}" alt="${player.currentClub}" class="club-logo" style="
                                            width: ${this.settings.clubLogoSize || 24}px;
                                            height: ${this.settings.clubLogoSize || 24}px;
                                            object-fit: contain;
                                            margin-bottom: 5px;
                                            border-radius: 4px;
                                            transition: all 0.3s ease;
                                        " onerror="this.style.display='none'">
                                        ` : ''}
                                        <div style="color: white; font-weight: 700; font-size: 1rem;">${player.currentClub}</div>
                                    </div>

                                    <!-- Target Club -->
                                    <div class="stat-item" style="
                                        background: rgba(255, 255, 255, 0.1);
                                        border-radius: 10px;
                                        padding: 12px;
                                        text-align: center;
                                        border: 1px solid rgba(255, 255, 255, 0.2);
                                        display: flex;
                                        flex-direction: column;
                                        align-items: center;
                                    ">
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; margin-bottom: 5px;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</div>
                                        ${player.targetClubLogo ? `
                                        <img src="${player.targetClubLogo}" alt="${player.targetClub}" class="target-club-logo" style="
                                            width: ${this.settings.clubLogoSize || 24}px;
                                            height: ${this.settings.clubLogoSize || 24}px;
                                            object-fit: contain;
                                            margin-bottom: 5px;
                                            border-radius: 4px;
                                            filter: drop-shadow(0 0 8px ${probabilityColor}40);
                                            transition: all 0.3s ease;
                                        " onerror="this.style.display='none'">
                                        ` : ''}
                                        <div style="color: ${probabilityColor}; font-weight: 700; font-size: 1rem;">${player.targetClub}</div>
                                    </div>

                                    <!-- Transfer Probability -->
                                    <div class="stat-item" style="
                                        background: rgba(255, 255, 255, 0.1);
                                        border-radius: 10px;
                                        padding: 12px;
                                        text-align: center;
                                        border: 1px solid rgba(255, 255, 255, 0.2);
                                    ">
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; margin-bottom: 5px;">Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</div>
                                        <div style="color: ${probabilityColor}; font-weight: 700; font-size: 1.1rem;">${probabilityValue}%</div>
                                    </div>
                                </div>

                                <!-- Transfer Info -->
                                <div class="transfer-info" style="
                                    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
                                    border-radius: 15px;
                                    padding: 15px;
                                    border: 1px solid rgba(255, 255, 255, 0.2);
                                ">
                                    <div style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: center;
                                        margin-bottom: 10px;
                                    ">
                                        <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">Ù…Ù†:</span>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            ${player.currentClubLogo ? `
                                            <img src="${player.currentClubLogo}" alt="${player.currentClub}" class="club-logo-small" style="
                                                width: ${Math.max(16, (this.settings.clubLogoSize || 24) - 4)}px;
                                                height: ${Math.max(16, (this.settings.clubLogoSize || 24) - 4)}px;
                                                object-fit: contain;
                                                border-radius: 3px;
                                                transition: all 0.3s ease;
                                            " onerror="this.style.display='none'">
                                            ` : ''}
                                            <span style="color: white; font-weight: 600;">${player.currentClub}</span>
                                        </div>
                                    </div>
                                    <div style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: center;
                                        margin-bottom: 10px;
                                    ">
                                        <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">Ø¥Ù„Ù‰:</span>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            ${player.targetClubLogo ? `
                                            <img src="${player.targetClubLogo}" alt="${player.targetClub}" class="target-club-logo-small" style="
                                                width: ${Math.max(16, (this.settings.clubLogoSize || 24) - 4)}px;
                                                height: ${Math.max(16, (this.settings.clubLogoSize || 24) - 4)}px;
                                                object-fit: contain;
                                                border-radius: 3px;
                                                filter: drop-shadow(0 0 6px ${probabilityColor}40);
                                                transition: all 0.3s ease;
                                            " onerror="this.style.display='none'">
                                            ` : ''}
                                            <span style="color: ${probabilityColor}; font-weight: 700;">${player.targetClub}</span>
                                        </div>
                                    </div>
                                    <div style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: center;
                                        margin-bottom: 10px;
                                    ">
                                        <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ©:</span>
                                        <span style="color: #ffd700; font-weight: 700;">${player.marketValue}</span>
                                    </div>
                                    <div style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: center;
                                    ">
                                        <span style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©:</span>
                                        <span style="color: ${probabilityColor}; font-weight: 700;">${probability.confidence}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Card Footer -->
                            <div class="card-footer" style="
                                position: absolute;
                                bottom: 0;
                                left: 0;
                                right: 0;
                                height: 55px;
                                background: ${this.getFooterBackground(probabilityValue)};
                                border: 2px solid ${this.getFooterBorder(probabilityValue)};
                                border-top: 3px solid ${this.getFooterTopBorder(probabilityValue)};
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-weight: 700;
                                color: ${this.getFooterTextColor(probabilityValue)};
                                font-size: 1rem;
                                text-transform: uppercase;
                                letter-spacing: 1px;
                                text-align: center;
                                padding: 0 15px;
                                box-shadow:
                                    0 -3px 15px rgba(0, 0, 0, 0.3),
                                    0 0 20px ${this.getFooterGlow(probabilityValue)};
                                animation: ${this.getFooterAnimation(probabilityValue)} 4s ease-in-out infinite;
                            ">
                                <div style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
                                ">
                                    <div style="
                                        font-size: 0.75rem;
                                        opacity: 0.9;
                                        margin-bottom: 3px;
                                        color: ${this.getFooterSubtitleColor(probabilityValue)};
                                    ">Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©</div>
                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        gap: 8px;
                                        font-size: 1.2rem;
                                        font-weight: 900;
                                        filter: drop-shadow(0 0 8px ${this.getFooterTextGlow(probabilityValue)});
                                    ">
                                        <span>${player.targetClub}</span>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- FIFA 26 Card Animations -->
                        <style>
                            @keyframes cardEntrance {
                                0% {
                                    opacity: 0;
                                    transform: translateY(50px) rotateY(15deg) scale(0.8);
                                    filter: blur(10px);
                                }
                                100% {
                                    opacity: 1;
                                    transform: translateY(0) rotateY(0deg) scale(1);
                                    filter: blur(0px);
                                }
                            }

                            @keyframes probabilityGlow {
                                0%, 100% {
                                    opacity: 0.8;
                                    transform: scale(1);
                                }
                                50% {
                                    opacity: 1;
                                    transform: scale(1.05);
                                }
                            }

                            @keyframes numberPulse {
                                0%, 100% {
                                    transform: scale(1);
                                    text-shadow: 0 0 20px ${probabilityColor}80;
                                }
                                50% {
                                    transform: scale(1.1);
                                    text-shadow: 0 0 30px ${probabilityColor}, 0 0 40px ${probabilityColor}60;
                                }
                            }

                            @keyframes progressSlide {
                                0% {
                                    width: 0%;
                                    opacity: 0;
                                }
                                100% {
                                    width: ${probabilityValue}%;
                                    opacity: 1;
                                }
                            }

                            @keyframes successPulse {
                                0%, 100% {
                                    box-shadow: 0 0 15px #22c55e80;
                                    filter: brightness(1);
                                }
                                50% {
                                    box-shadow: 0 0 25px #22c55e, 0 0 35px #22c55e60;
                                    filter: brightness(1.2);
                                }
                            }

                            @keyframes warningGlow {
                                0%, 100% {
                                    box-shadow: 0 0 15px #f59e0b80;
                                    filter: brightness(1);
                                }
                                50% {
                                    box-shadow: 0 0 20px #f59e0b, 0 0 30px #f59e0b60;
                                    filter: brightness(1.1);
                                }
                            }

                            @keyframes dangerFlicker {
                                0%, 100% {
                                    box-shadow: 0 0 15px #dc262680;
                                    filter: brightness(1);
                                }
                                25% {
                                    box-shadow: 0 0 10px #dc2626;
                                    filter: brightness(0.9);
                                }
                                75% {
                                    box-shadow: 0 0 20px #dc2626, 0 0 30px #dc262660;
                                    filter: brightness(1.1);
                                }
                            }

                            @keyframes sparkleMove {
                                0% {
                                    transform: translateX(-100%);
                                    opacity: 0;
                                }
                                50% {
                                    opacity: 1;
                                }
                                100% {
                                    transform: translateX(100%);
                                    opacity: 0;
                                }
                            }

                            /* Specialized Zone Animations */
                            @keyframes zoneSuccessBreath {
                                0%, 100% {
                                    transform: scale(1);
                                    box-shadow: 0 0 30px rgba(34, 197, 94, 0.3);
                                }
                                50% {
                                    transform: scale(1.02);
                                    box-shadow: 0 0 40px rgba(34, 197, 94, 0.5);
                                }
                            }

                            @keyframes zoneWarningPulse {
                                0%, 100% {
                                    transform: scale(1);
                                    box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
                                }
                                50% {
                                    transform: scale(1.01);
                                    box-shadow: 0 0 35px rgba(245, 158, 11, 0.4);
                                }
                            }

                            @keyframes zoneDangerAlert {
                                0%, 100% {
                                    transform: scale(1);
                                    box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
                                }
                                25% {
                                    transform: scale(0.98);
                                    box-shadow: 0 0 25px rgba(220, 38, 38, 0.2);
                                }
                                75% {
                                    transform: scale(1.01);
                                    box-shadow: 0 0 35px rgba(220, 38, 38, 0.4);
                                }
                            }

                            /* Text Animations */
                            @keyframes textSuccessGlow {
                                0%, 100% {
                                    text-shadow: 0 0 20px rgba(34, 197, 94, 0.8), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                                50% {
                                    text-shadow: 0 0 30px rgba(34, 197, 94, 1), 0 0 40px rgba(34, 197, 94, 0.6), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                            }

                            @keyframes textWarningShimmer {
                                0%, 100% {
                                    text-shadow: 0 0 20px rgba(245, 158, 11, 0.8), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                                50% {
                                    text-shadow: 0 0 25px rgba(245, 158, 11, 1), 0 0 35px rgba(245, 158, 11, 0.6), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                            }

                            @keyframes textDangerFlash {
                                0%, 100% {
                                    text-shadow: 0 0 20px rgba(220, 38, 38, 0.8), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                                25% {
                                    text-shadow: 0 0 15px rgba(220, 38, 38, 0.6), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                                75% {
                                    text-shadow: 0 0 30px rgba(220, 38, 38, 1), 0 0 40px rgba(220, 38, 38, 0.6), 0 2px 4px rgba(0, 0, 0, 0.5);
                                }
                            }

                            /* Fill Animations */
                            @keyframes fillSuccessFlow {
                                0%, 100% {
                                    box-shadow: 0 0 20px rgba(16, 185, 129, 0.6), inset 0 1px 3px rgba(255, 255, 255, 0.3);
                                }
                                50% {
                                    box-shadow: 0 0 30px rgba(16, 185, 129, 0.8), inset 0 1px 3px rgba(255, 255, 255, 0.5);
                                }
                            }

                            @keyframes fillWarningWave {
                                0%, 100% {
                                    box-shadow: 0 0 20px rgba(245, 158, 11, 0.6), inset 0 1px 3px rgba(255, 255, 255, 0.3);
                                }
                                50% {
                                    box-shadow: 0 0 25px rgba(245, 158, 11, 0.7), inset 0 1px 3px rgba(255, 255, 255, 0.4);
                                }
                            }

                            @keyframes fillDangerPulse {
                                0%, 100% {
                                    box-shadow: 0 0 20px rgba(239, 68, 68, 0.6), inset 0 1px 3px rgba(255, 255, 255, 0.3);
                                }
                                25% {
                                    box-shadow: 0 0 15px rgba(239, 68, 68, 0.4), inset 0 1px 3px rgba(255, 255, 255, 0.2);
                                }
                                75% {
                                    box-shadow: 0 0 25px rgba(239, 68, 68, 0.8), inset 0 1px 3px rgba(255, 255, 255, 0.4);
                                }
                            }

                            /* Particle Animation */
                            @keyframes particleFloat {
                                0%, 100% {
                                    transform: translateY(0px) rotate(0deg);
                                    opacity: 0.4;
                                }
                                50% {
                                    transform: translateY(-5px) rotate(180deg);
                                    opacity: 0.6;
                                }
                            }

                            @keyframes sparkleGlow {
                                0%, 100% {
                                    opacity: 0.8;
                                    transform: translate(-50%, -50%) scale(1);
                                }
                                50% {
                                    opacity: 1;
                                    transform: translate(-50%, -50%) scale(1.5);
                                }
                            }

                            /* Footer Animations */
                            @keyframes footerSuccessGlow {
                                0%, 100% {
                                    box-shadow: 0 -3px 15px rgba(0, 0, 0, 0.3), 0 0 20px rgba(5, 150, 105, 0.4);
                                }
                                50% {
                                    box-shadow: 0 -3px 20px rgba(0, 0, 0, 0.4), 0 0 30px rgba(5, 150, 105, 0.6);
                                }
                            }

                            @keyframes footerWarningPulse {
                                0%, 100% {
                                    box-shadow: 0 -3px 15px rgba(0, 0, 0, 0.3), 0 0 20px rgba(217, 119, 6, 0.4);
                                }
                                50% {
                                    box-shadow: 0 -3px 18px rgba(0, 0, 0, 0.35), 0 0 25px rgba(217, 119, 6, 0.5);
                                }
                            }

                            @keyframes footerDangerFlicker {
                                0%, 100% {
                                    box-shadow: 0 -3px 15px rgba(0, 0, 0, 0.3), 0 0 20px rgba(185, 28, 28, 0.4);
                                }
                                25% {
                                    box-shadow: 0 -3px 12px rgba(0, 0, 0, 0.25), 0 0 15px rgba(185, 28, 28, 0.3);
                                }
                                75% {
                                    box-shadow: 0 -3px 18px rgba(0, 0, 0, 0.35), 0 0 25px rgba(185, 28, 28, 0.5);
                                }
                            }

                            @keyframes backgroundShift {
                                0%, 100% {
                                    transform: translateX(0) translateY(0) rotate(0deg);
                                }
                                33% {
                                    transform: translateX(10px) translateY(-5px) rotate(1deg);
                                }
                                66% {
                                    transform: translateX(-5px) translateY(10px) rotate(-1deg);
                                }
                            }

                            @keyframes playerFloat {
                                0%, 100% {
                                    transform: translateY(0) scale(1);
                                }
                                50% {
                                    transform: translateY(-10px) scale(1.02);
                                }
                            }

                            @keyframes glowPulse {
                                0%, 100% {
                                    opacity: 0.3;
                                    transform: translate(-50%, -50%) scale(1);
                                }
                                50% {
                                    opacity: 0.6;
                                    transform: translate(-50%, -50%) scale(1.1);
                                }
                            }

                            @keyframes nameGlow {
                                0%, 100% {
                                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                                }
                                50% {
                                    text-shadow:
                                        0 2px 10px rgba(0, 0, 0, 0.5),
                                        0 0 20px ${probabilityColor}50,
                                        0 0 30px ${probabilityColor}30;
                                }
                            }

                            @keyframes progressFill {
                                0% { stroke-dashoffset: ${2 * Math.PI * 35}; }
                                100% { stroke-dashoffset: ${2 * Math.PI * 35 * (1 - probabilityValue / 100)}; }
                            }

                            /* Hover Effects */
                            .fifa-card:hover {
                                transform: translateY(-10px) rotateY(5deg);
                                box-shadow:
                                    0 35px 70px rgba(0, 0, 0, 0.6),
                                    0 0 0 1px rgba(255, 255, 255, 0.2),
                                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
                                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                            }

                            .stat-item:hover {
                                background: rgba(255, 255, 255, 0.2);
                                transform: translateY(-2px);
                                transition: all 0.3s ease;
                            }

                            /* Target Club Logo Animation */
                            @keyframes targetLogoFloat {
                                0%, 100% {
                                    transform: translateY(0px) scale(1);
                                    box-shadow:
                                        0 10px 30px rgba(0, 0, 0, 0.5),
                                        0 0 20px ${probabilityColor}40;
                                }
                                50% {
                                    transform: translateY(-5px) scale(1.05);
                                    box-shadow:
                                        0 15px 40px rgba(0, 0, 0, 0.6),
                                        0 0 30px ${probabilityColor}60;
                                }
                            }

                            /* Enhanced Target Logo Hover */
                            .target-club-logo-large:hover {
                                transform: translateY(-3px) scale(1.1);
                                box-shadow:
                                    0 20px 50px rgba(0, 0, 0, 0.7),
                                    0 0 40px ${probabilityColor}80;
                                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                            }

                            .target-club-logo-large:hover img {
                                filter:
                                    drop-shadow(0 0 20px ${probabilityColor})
                                    brightness(1.2)
                                    contrast(1.2)
                                    saturate(1.1);
                            }
                        </style>
                    </div>
                `;
            }

            // ðŸŽ¨ Enhanced Helper Methods with Dynamic Colors
            getProbabilityColor(percentage) {
                if (percentage >= 75) {
                    // Green gradient (75-100%)
                    const intensity = (percentage - 75) / 25; // 0 to 1
                    return `hsl(120, ${70 + intensity * 30}%, ${40 + intensity * 20}%)`; // Light to bright green
                } else if (percentage >= 50) {
                    // Orange to Yellow gradient (50-75%)
                    const intensity = (percentage - 50) / 25; // 0 to 1
                    const hue = 30 + intensity * 30; // Orange (30) to Yellow (60)
                    return `hsl(${hue}, ${80 + intensity * 20}%, ${50 + intensity * 10}%)`;
                } else {
                    // Red gradient (0-50%)
                    const intensity = percentage / 50; // 0 to 1
                    return `hsl(0, ${70 + intensity * 30}%, ${35 + intensity * 15}%)`; // Dark to bright red
                }
            }

            // Get gradient for probability background
            getProbabilityGradient(percentage) {
                if (percentage >= 75) {
                    return `linear-gradient(135deg, #22c55e, #16a34a, #15803d)`;
                } else if (percentage >= 50) {
                    const orangeIntensity = (percentage - 50) / 25;
                    if (orangeIntensity > 0.5) {
                        return `linear-gradient(135deg, #f59e0b, #eab308, #ca8a04)`;
                    } else {
                        return `linear-gradient(135deg, #ea580c, #f59e0b, #d97706)`;
                    }
                } else {
                    return `linear-gradient(135deg, #dc2626, #ef4444, #f87171)`;
                }
            }

            // Get animation type based on probability
            getProbabilityAnimation(percentage) {
                if (percentage >= 75) {
                    return 'successPulse'; // Green - success animation
                } else if (percentage >= 50) {
                    return 'warningGlow'; // Orange/Yellow - warning animation
                } else {
                    return 'dangerFlicker'; // Red - danger animation
                }
            }

            // ðŸŽ¨ Specialized Probability Zone Color System

            // Zone Background - Subtle and elegant
            getProbabilityZoneBackground(percentage) {
                if (percentage >= 75) {
                    return 'linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(22, 163, 74, 0.25))';
                } else if (percentage >= 50) {
                    return 'linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(234, 179, 8, 0.25))';
                } else {
                    return 'linear-gradient(135deg, rgba(220, 38, 38, 0.15), rgba(239, 68, 68, 0.25))';
                }
            }

            // Zone Border - Complementary colors
            getProbabilityZoneBorder(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.6)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.6)';
                } else {
                    return 'rgba(220, 38, 38, 0.6)';
                }
            }

            // Zone Glow - Soft outer glow
            getProbabilityZoneGlow(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.3)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.3)';
                } else {
                    return 'rgba(220, 38, 38, 0.3)';
                }
            }

            // Text Color - High contrast and readable
            getProbabilityTextColor(percentage) {
                if (percentage >= 75) {
                    return '#ffffff'; // Pure white for green background
                } else if (percentage >= 50) {
                    return '#1f2937'; // Dark gray for yellow/orange background
                } else {
                    return '#ffffff'; // Pure white for red background
                }
            }

            // Text Glow - Enhances readability
            getProbabilityTextGlow(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.8)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.8)';
                } else {
                    return 'rgba(220, 38, 38, 0.8)';
                }
            }

            // Track Color - Progress bar background
            getProbabilityTrackColor(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.2)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.2)';
                } else {
                    return 'rgba(220, 38, 38, 0.2)';
                }
            }

            // Track Border - Progress bar border
            getProbabilityTrackBorder(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.4)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.4)';
                } else {
                    return 'rgba(220, 38, 38, 0.4)';
                }
            }

            // Fill Gradient - Progress bar fill
            getProbabilityFillGradient(percentage) {
                if (percentage >= 75) {
                    return 'linear-gradient(90deg, #10b981, #34d399, #6ee7b7)';
                } else if (percentage >= 50) {
                    return 'linear-gradient(90deg, #f59e0b, #fbbf24, #fde047)';
                } else {
                    return 'linear-gradient(90deg, #ef4444, #f87171, #fca5a5)';
                }
            }

            // Fill Glow - Progress bar glow
            getProbabilityFillGlow(percentage) {
                if (percentage >= 75) {
                    return 'rgba(16, 185, 129, 0.6)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.6)';
                } else {
                    return 'rgba(239, 68, 68, 0.6)';
                }
            }

            // Label Color - Bottom label
            getProbabilityLabelColor(percentage) {
                if (percentage >= 75) {
                    return '#d1fae5'; // Light green
                } else if (percentage >= 50) {
                    return '#fef3c7'; // Light yellow
                } else {
                    return '#fee2e2'; // Light red
                }
            }

            // Zone Animation - Overall zone animation
            getProbabilityZoneAnimation(percentage) {
                if (percentage >= 75) {
                    return 'zoneSuccessBreath';
                } else if (percentage >= 50) {
                    return 'zoneWarningPulse';
                } else {
                    return 'zoneDangerAlert';
                }
            }

            // Text Animation - Number animation
            getProbabilityTextAnimation(percentage) {
                if (percentage >= 75) {
                    return 'textSuccessGlow';
                } else if (percentage >= 50) {
                    return 'textWarningShimmer';
                } else {
                    return 'textDangerFlash';
                }
            }

            // Fill Animation - Progress bar animation
            getProbabilityFillAnimation(percentage) {
                if (percentage >= 75) {
                    return 'fillSuccessFlow';
                } else if (percentage >= 50) {
                    return 'fillWarningWave';
                } else {
                    return 'fillDangerPulse';
                }
            }

            // Particle Pattern - Background pattern
            getProbabilityParticlePattern(percentage) {
                if (percentage >= 75) {
                    return `radial-gradient(circle at 20% 30%, rgba(34, 197, 94, 0.3) 2px, transparent 2px),
                            radial-gradient(circle at 70% 80%, rgba(16, 185, 129, 0.3) 1px, transparent 1px),
                            radial-gradient(circle at 90% 20%, rgba(34, 197, 94, 0.2) 1.5px, transparent 1.5px)`;
                } else if (percentage >= 50) {
                    return `radial-gradient(circle at 25% 25%, rgba(245, 158, 11, 0.3) 2px, transparent 2px),
                            radial-gradient(circle at 75% 75%, rgba(234, 179, 8, 0.3) 1px, transparent 1px),
                            radial-gradient(circle at 50% 90%, rgba(245, 158, 11, 0.2) 1.5px, transparent 1.5px)`;
                } else {
                    return `radial-gradient(circle at 30% 70%, rgba(220, 38, 38, 0.3) 2px, transparent 2px),
                            radial-gradient(circle at 80% 30%, rgba(239, 68, 68, 0.3) 1px, transparent 1px),
                            radial-gradient(circle at 10% 10%, rgba(220, 38, 38, 0.2) 1.5px, transparent 1.5px)`;
                }
            }

            // Sparkle Effect - Special effects for high probability
            getProbabilitySparkleEffect(percentage) {
                if (percentage >= 75) {
                    return `
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: linear-gradient(90deg,
                                transparent,
                                rgba(255, 255, 255, 0.8),
                                transparent);
                            animation: sparkleMove 3s linear infinite;
                            border-radius: 15px;
                        "></div>
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: ${percentage}%;
                            transform: translate(-50%, -50%);
                            width: 6px;
                            height: 6px;
                            background: radial-gradient(circle, #ffffff, transparent);
                            border-radius: 50%;
                            animation: sparkleGlow 2s ease-in-out infinite;
                        "></div>
                    `;
                } else if (percentage >= 50) {
                    return `
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: linear-gradient(90deg,
                                transparent,
                                rgba(255, 255, 255, 0.5),
                                transparent);
                            animation: sparkleMove 4s linear infinite;
                            border-radius: 15px;
                        "></div>
                    `;
                } else {
                    return '';
                }
            }

            // ðŸ·ï¸ Footer Color System - Complementary to probability zone

            getFooterBackground(percentage) {
                if (percentage >= 75) {
                    return 'linear-gradient(135deg, rgba(5, 150, 105, 0.9), rgba(6, 120, 85, 0.95))';
                } else if (percentage >= 50) {
                    return 'linear-gradient(135deg, rgba(217, 119, 6, 0.9), rgba(180, 83, 9, 0.95))';
                } else {
                    return 'linear-gradient(135deg, rgba(185, 28, 28, 0.9), rgba(153, 27, 27, 0.95))';
                }
            }

            getFooterBorder(percentage) {
                if (percentage >= 75) {
                    return 'rgba(5, 150, 105, 0.7)';
                } else if (percentage >= 50) {
                    return 'rgba(217, 119, 6, 0.7)';
                } else {
                    return 'rgba(185, 28, 28, 0.7)';
                }
            }

            getFooterTopBorder(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.8)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.8)';
                } else {
                    return 'rgba(220, 38, 38, 0.8)';
                }
            }

            getFooterTextColor(percentage) {
                return '#ffffff'; // Always white for good contrast
            }

            getFooterSubtitleColor(percentage) {
                if (percentage >= 75) {
                    return 'rgba(255, 255, 255, 0.8)';
                } else if (percentage >= 50) {
                    return 'rgba(255, 255, 255, 0.85)';
                } else {
                    return 'rgba(255, 255, 255, 0.8)';
                }
            }

            getFooterGlow(percentage) {
                if (percentage >= 75) {
                    return 'rgba(5, 150, 105, 0.4)';
                } else if (percentage >= 50) {
                    return 'rgba(217, 119, 6, 0.4)';
                } else {
                    return 'rgba(185, 28, 28, 0.4)';
                }
            }

            getFooterTextGlow(percentage) {
                if (percentage >= 75) {
                    return 'rgba(34, 197, 94, 0.6)';
                } else if (percentage >= 50) {
                    return 'rgba(245, 158, 11, 0.6)';
                } else {
                    return 'rgba(220, 38, 38, 0.6)';
                }
            }

            getFooterAnimation(percentage) {
                if (percentage >= 75) {
                    return 'footerSuccessGlow';
                } else if (percentage >= 50) {
                    return 'footerWarningPulse';
                } else {
                    return 'footerDangerFlicker';
                }
            }

            getCardGradient(percentage) {
                if (percentage >= 80) {
                    return 'linear-gradient(135deg, #39ff14 0%, #00ff88 50%, #00d4ff 100%)'; // Legendary
                } else if (percentage >= 60) {
                    return 'linear-gradient(135deg, #00d4ff 0%, #667eea 50%, #764ba2 100%)'; // Epic
                } else if (percentage >= 40) {
                    return 'linear-gradient(135deg, #ffd700 0%, #ff8c00 50%, #ff4500 100%)'; // Rare
                } else if (percentage >= 20) {
                    return 'linear-gradient(135deg, #ff4500 0%, #ff6b6b 50%, #ff8e8e 100%)'; // Uncommon
                } else {
                    return 'linear-gradient(135deg, #ff0080 0%, #8e44ad 50%, #3f51b5 100%)'; // Common
                }
            }

            getRatingColor(rating) {
                if (rating >= 90) return 'linear-gradient(135deg, #ffd700, #ffed4e)'; // Gold
                if (rating >= 85) return 'linear-gradient(135deg, #c0392b, #e74c3c)'; // Red
                if (rating >= 80) return 'linear-gradient(135deg, #8e44ad, #9b59b6)'; // Purple
                if (rating >= 75) return 'linear-gradient(135deg, #2980b9, #3498db)'; // Blue
                return 'linear-gradient(135deg, #27ae60, #2ecc71)'; // Green
            }

            getPlayerImageUrl(player) {
                // Check for both playerImage and imageUrl properties
                const imageUrl = player.playerImage || player.imageUrl;
                if (imageUrl && imageUrl.startsWith('http')) {
                    return imageUrl;
                }
                return this.getFallbackImageUrl(player.arabicName || player.name || 'Ù„Ø§Ø¹Ø¨');
            }

            getFallbackImageUrl(playerName) {
                const initials = playerName.split(' ')
                    .map(word => word.charAt(0))
                    .join('')
                    .substring(0, 2);

                return `https://ui-avatars.com/api/?name=${encodeURIComponent(initials)}&size=300&background=667eea&color=fff&bold=true&format=png`;
            }

            // ðŸŽµ Audio System
            setupAudioSystem() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    console.log('ðŸŽµ Audio system initialized');
                } catch (error) {
                    console.warn('ðŸ”‡ Audio not available:', error);
                }
            }

            // ðŸŽµ Professional Sound System
            playCreationSound() {
                if (!this.audioContext || this.settings.soundEffects === 'disabled') return;

                try {
                    this.playFIFAStyleSound();
                } catch (error) {
                    console.warn('ðŸ”‡ Sound playback failed:', error);
                }
            }

            playFIFAStyleSound() {
                const now = this.audioContext.currentTime;

                // Create a professional FIFA-style sound
                // Main chord (C major)
                this.playNote(261.63, now, 0.8, 0.05); // C
                this.playNote(329.63, now + 0.1, 0.6, 0.04); // E
                this.playNote(392.00, now + 0.2, 0.8, 0.06); // G

                // High sparkle
                this.playNote(523.25, now + 0.3, 0.4, 0.03); // C (octave)
                this.playNote(659.25, now + 0.4, 0.3, 0.02); // E (octave)

                // Success chime
                this.playNote(783.99, now + 0.5, 0.5, 0.04); // G (octave)
                this.playNote(1046.50, now + 0.6, 0.3, 0.03); // C (2 octaves)
            }

            playNote(frequency, startTime, duration, volume) {
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                const filterNode = this.audioContext.createBiquadFilter();

                // Professional sound shaping
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(frequency, startTime);

                // Add slight vibrato for richness
                const vibrato = this.audioContext.createOscillator();
                const vibratoGain = this.audioContext.createGain();
                vibrato.frequency.setValueAtTime(5, startTime); // 5Hz vibrato
                vibratoGain.gain.setValueAtTime(2, startTime); // 2Hz depth

                vibrato.connect(vibratoGain);
                vibratoGain.connect(oscillator.frequency);

                // Low-pass filter for warmth
                filterNode.type = 'lowpass';
                filterNode.frequency.setValueAtTime(2000, startTime);
                filterNode.Q.setValueAtTime(1, startTime);

                // Professional envelope (ADSR)
                gainNode.gain.setValueAtTime(0, startTime);
                gainNode.gain.linearRampToValueAtTime(volume, startTime + 0.05); // Attack
                gainNode.gain.linearRampToValueAtTime(volume * 0.7, startTime + 0.1); // Decay
                gainNode.gain.setValueAtTime(volume * 0.7, startTime + duration - 0.1); // Sustain
                gainNode.gain.exponentialRampToValueAtTime(0.001, startTime + duration); // Release

                // Connect the audio graph
                oscillator.connect(filterNode);
                filterNode.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                // Start and stop
                oscillator.start(startTime);
                vibrato.start(startTime);
                oscillator.stop(startTime + duration);
                vibrato.stop(startTime + duration);
            }

            // Enhanced sound for sequence transitions
            playSequenceTransitionSound() {
                if (!this.audioContext || this.settings.soundEffects === 'disabled') return;

                try {
                    const now = this.audioContext.currentTime;

                    // Quick transition sound
                    this.playNote(440, now, 0.2, 0.03);
                    this.playNote(554.37, now + 0.1, 0.2, 0.02);
                } catch (error) {
                    console.warn('ðŸ”‡ Transition sound failed:', error);
                }
            }

            // ðŸŒŸ Particle System
            setupParticleSystem() {
                console.log('âœ¨ Initializing particle system...');
                // Particle system will be initialized when visualization is created
            }

            initializeParticleEffects() {
                const canvas = document.getElementById('particleCanvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                const particles = [];
                const particleCount = 50;

                // Create particles
                for (let i = 0; i < particleCount; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        vx: (Math.random() - 0.5) * 2,
                        vy: (Math.random() - 0.5) * 2,
                        size: Math.random() * 3 + 1,
                        opacity: Math.random() * 0.5 + 0.2,
                        color: this.getRandomParticleColor()
                    });
                }

                // Animate particles
                const animate = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    particles.forEach(particle => {
                        particle.x += particle.vx;
                        particle.y += particle.vy;

                        // Wrap around edges
                        if (particle.x < 0) particle.x = canvas.width;
                        if (particle.x > canvas.width) particle.x = 0;
                        if (particle.y < 0) particle.y = canvas.height;
                        if (particle.y > canvas.height) particle.y = 0;

                        // Draw particle
                        ctx.beginPath();
                        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        ctx.fillStyle = particle.color;
                        ctx.globalAlpha = particle.opacity;
                        ctx.fill();
                    });

                    requestAnimationFrame(animate);
                };

                animate();
            }

            getRandomParticleColor() {
                const colors = ['#667eea', '#764ba2', '#f093fb', '#00d4ff', '#39ff14', '#ffd700'];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            // ðŸŽ¨ Animation Systems
            startQuantumAnimations() {
                // Add quantum field effect to body
                setInterval(() => {
                    document.body.style.filter = `hue-rotate(${Date.now() / 100 % 360}deg)`;
                }, 100);
            }

            startCosmicAnimations() {
                const visualization = document.querySelector('.ultimate-visualization');
                if (visualization) {
                    visualization.style.animation = 'cosmicPulse 4s ease-in-out infinite';
                }
            }

            // ðŸ“± Utility Methods
            getFormData() {
                return {
                    playerName: document.getElementById('playerName')?.value?.trim() || '',
                    currentClub: document.getElementById('currentClub')?.value?.trim() || '',
                    targetClub: document.getElementById('targetClub')?.value?.trim() || '',
                    playerImage: document.getElementById('playerImage')?.value?.trim() || ''
                };
            }

            validateInput(formData) {
                if (!formData.playerName) {
                    return { isValid: false, message: 'ðŸš¨ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ø·Ù„ÙˆØ¨', field: 'playerName' };
                }
                if (!formData.currentClub) {
                    return { isValid: false, message: 'ðŸš¨ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø·Ù„ÙˆØ¨', field: 'currentClub' };
                }
                if (!formData.targetClub) {
                    return { isValid: false, message: 'ðŸš¨ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ø·Ù„ÙˆØ¨', field: 'targetClub' };
                }
                if (formData.playerName.length < 2) {
                    return { isValid: false, message: 'ðŸš¨ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹', field: 'playerName' };
                }
                return { isValid: true };
            }

            highlightInvalidField(fieldName) {
                const field = document.getElementById(fieldName);
                if (field) {
                    field.style.borderColor = '#ff0080';
                    field.style.boxShadow = '0 0 0 4px rgba(255, 0, 128, 0.3)';
                    field.focus();
                    setTimeout(() => {
                        field.style.borderColor = '';
                        field.style.boxShadow = '';
                    }, 3000);
                }
            }

            clearForm() {
                // Don't clear form automatically - keep user data
                console.log('ðŸ“ Form data preserved for user convenience');
            }

            // ðŸ”„ Enhanced Data Processing - Using Real API
            async getEnhancedPlayerData(formData) {
                try {
                    // Use the same API as the main page
                    const response = await fetch('/api/search-player', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            arabicName: formData.playerName,
                            targetClub: formData.targetClub,
                            currentClub: formData.currentClub
                        })
                    });

                    const data = await response.json();

                    if (data.success) {
                        // Extract probability from the real API response
                        const probability = data.targetRumor?.probability || '0%';
                        const probabilityValue = parseInt(probability.match(/(\d+)/)?.[1] || '0');

                        // Get club logos with detailed logging
                        console.log('ðŸ” Getting club logos for:', {
                            currentClub: data.currentClub || formData.currentClub,
                            targetClub: formData.targetClub
                        });

                        const currentClubLogo = await this.getClubLogo(data.currentClub || formData.currentClub);
                        const targetClubLogo = await this.getClubLogo(formData.targetClub);

                        console.log('ðŸ† Club logos loaded:', {
                            current: currentClubLogo,
                            target: targetClubLogo,
                            currentClubName: data.currentClub || formData.currentClub,
                            targetClubName: formData.targetClub
                        });

                        // Log age data for debugging
                        console.log('ðŸŽ‚ Age data analysis:', {
                            'data.data?.age': data.data?.age,
                            'data.data?.playerAge': data.data?.playerAge,
                            'data.age': data.age,
                            'finalAge': data.data?.age || data.data?.playerAge || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
                        });

                        return {
                            arabicName: formData.playerName,
                            englishName: data.englishName || formData.playerName,
                            currentClub: data.currentClub || formData.currentClub,
                            targetClub: formData.targetClub,
                            imageUrl: formData.playerImage || data.data?.playerImage,
                            currentClubLogo: currentClubLogo,
                            targetClubLogo: targetClubLogo,
                            probability: {
                                percentage: probabilityValue,
                                display: probability,
                                factors: this.generateFactorsFromRealData(data),
                                confidence: this.calculateConfidenceFromReal(data),
                                trend: this.calculateTrendFromReal(probabilityValue)
                            },
                            position: data.data?.playerPosition || data.playerPosition || this.getPlayerPosition(formData.playerName),
                            age: data.data?.age || data.data?.playerAge || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                            marketValue: data.data?.marketValue || this.calculateMarketValue(formData.playerName, formData.currentClub),
                            contractExpiry: data.data?.contractExpiry || this.generateContractExpiry(),
                            nationality: data.data?.nationality || this.getPlayerNationality(formData.playerName),
                            height: data.data?.height || this.getPlayerHeight(formData.playerName),
                            foot: data.data?.preferredFoot || this.getPlayerFoot(formData.playerName),
                            rating: this.calculatePlayerRating(formData.playerName, formData.currentClub),
                            allRumors: data.allRumors || []
                        };
                    } else {
                        throw new Error(data.error || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«');
                    }
                } catch (error) {
                    console.error('ðŸš¨ Error getting real player data:', error);
                    // Fallback to local calculation if API fails
                    return this.getFallbackPlayerData(formData);
                }
            }

            // Fallback method if API fails
            async getFallbackPlayerData(formData) {
                console.log('ðŸ”„ Using fallback data for:', formData);

                const probability = this.calculateLocalProbability(formData.playerName, formData.targetClub);

                // Get club logos for fallback data with detailed logging
                console.log('ðŸ” Getting fallback logos for:', {
                    currentClub: formData.currentClub,
                    targetClub: formData.targetClub
                });

                const currentClubLogo = await this.getClubLogo(formData.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
                const targetClubLogo = await this.getClubLogo(formData.targetClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');

                console.log('ðŸ† Fallback logos loaded:', {
                    current: currentClubLogo,
                    target: targetClubLogo
                });

                return {
                    arabicName: formData.playerName,
                    englishName: formData.playerName,
                    currentClub: formData.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    targetClub: formData.targetClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    imageUrl: formData.playerImage,
                    currentClubLogo: currentClubLogo,
                    targetClubLogo: targetClubLogo,
                    probability: {
                        percentage: probability,
                        display: probability + '%',
                        factors: ['ØªØ­Ù„ÙŠÙ„ Ù…Ø­Ù„ÙŠ', 'Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©'],
                        confidence: 'Ù…ØªÙˆØ³Ø·Ø©',
                        trend: this.calculateTrendFromReal(probability)
                    },
                    position: this.getPlayerPosition(formData.playerName),
                    age: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯', // Don't use local age calculation
                    marketValue: this.calculateMarketValue(formData.playerName, formData.currentClub),
                    contractExpiry: this.generateContractExpiry(),
                    nationality: this.getPlayerNationality(formData.playerName),
                    height: this.getPlayerHeight(formData.playerName),
                    foot: this.getPlayerFoot(formData.playerName),
                    rating: this.calculatePlayerRating(formData.playerName, formData.currentClub),
                    allRumors: []
                };
            }

            // Generate factors from real API data
            generateFactorsFromRealData(data) {
                const factors = [];

                if (data.targetRumor) {
                    factors.push('Ø´Ø§Ø¦Ø¹Ø© Ù…Ø¤ÙƒØ¯Ø© Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ø±');
                }

                if (data.allRumors && data.allRumors.length > 0) {
                    factors.push(`${data.allRumors.length} Ø´Ø§Ø¦Ø¹Ø© Ø¥Ø¶Ø§ÙÙŠØ©`);
                }

                if (data.currentClub) {
                    factors.push(`ÙŠÙ„Ø¹Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ ${data.currentClub}`);
                }

                if (data.playerPosition) {
                    factors.push(`Ù…Ø±ÙƒØ²: ${data.playerPosition}`);
                }

                // Add some default factors if none found
                if (factors.length === 0) {
                    factors.push('ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø§Ù„ÙŠ', 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡');
                }

                return factors;
            }

            calculateConfidenceFromReal(data) {
                let score = 0;

                if (data.targetRumor) score += 2;
                if (data.allRumors && data.allRumors.length > 0) score += 1;
                if (data.englishName) score += 1;
                if (data.currentClub) score += 1;

                if (score >= 4) return 'Ø¹Ø§Ù„ÙŠØ©';
                if (score >= 2) return 'Ù…ØªÙˆØ³Ø·Ø©';
                return 'Ù…Ù†Ø®ÙØ¶Ø©';
            }

            calculateTrendFromReal(probability) {
                if (probability >= 70) return 'Ù…Ø­ØªÙ…Ù„ Ø¬Ø¯Ø§Ù‹';
                if (probability >= 50) return 'Ù…Ø­ØªÙ…Ù„';
                if (probability >= 30) return 'Ù…Ù…ÙƒÙ†';
                return 'ØºÙŠØ± Ù…Ø­ØªÙ…Ù„';
            }

            // Local probability calculation (same as server.js)
            calculateLocalProbability(playerName, targetClub) {
                let baseProbability = 45;

                // Player-based adjustments (same as server.js)
                if (playerName.includes('Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­')) baseProbability = 75;
                else if (playerName.includes('ØµÙ„Ø§Ø­')) baseProbability += 20;
                else if (playerName.includes('Ù…Ø­Ù…Ø¯') || playerName.includes('Ø£Ø­Ù…Ø¯')) baseProbability += 10;
                else if (playerName.includes('Ù…Ø§Ù†Ù‡') || playerName.includes('ÙÙŠØ±Ù…ÙŠÙ†Ùˆ')) baseProbability += 15;
                else if (playerName.includes('Ø¨Ù†Ø²ÙŠÙ…Ø§')) baseProbability += 18;
                else if (playerName.includes('Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ')) baseProbability += 22;
                else if (playerName.includes('Ù…ÙŠØ³ÙŠ')) baseProbability += 20;
                else if (playerName.includes('Ù†ÙŠÙ…Ø§Ø±')) baseProbability += 17;
                else if (playerName.includes('Ù…Ø¨Ø§Ø¨ÙŠ')) baseProbability += 19;

                // Club-based adjustments (same as server.js)
                const bigClubs = ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†', 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®'];
                const saudiClubs = ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ù†ØµØ±', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Ø§Ù„Ø£Ù‡Ù„ÙŠ'];

                if (bigClubs.includes(targetClub)) {
                    baseProbability += 15;
                } else if (saudiClubs.includes(targetClub)) {
                    baseProbability += 25; // Saudi clubs have high transfer success
                }

                // Use consistent hash-based variation (same as server.js)
                const nameHash = playerName.split('').reduce((hash, char) => {
                    return ((hash << 5) - hash) + char.charCodeAt(0);
                }, 0);

                const clubHash = targetClub.split('').reduce((hash, char) => {
                    return ((hash << 5) - hash) + char.charCodeAt(0);
                }, 0);

                // Create consistent variation based on name and club
                const variation = ((Math.abs(nameHash + clubHash) % 16) - 8); // -8 to +8
                const finalProbability = Math.max(20, Math.min(90, baseProbability + variation));

                return finalProbability;
            }

            // ðŸŽ¯ Enhanced Player Data Extraction (Professional Database)
            getPlayerPosition(playerName) {
                const playerData = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': 'RW',
                    'ØµÙ„Ø§Ø­': 'RW',
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': 'ST',
                    'Ø¨Ù†Ø²ÙŠÙ…Ø§': 'ST',
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': 'LW',
                    'Ù…Ø§Ù†Ù‡': 'LW',
                    'Ù†ÙŠÙ…Ø§Ø±': 'LW',
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': 'ST',
                    'Ù…Ø¨Ø§Ø¨ÙŠ': 'ST',
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': 'ST',
                    'Ù‡Ø§Ù„Ø§Ù†Ø¯': 'ST',
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 'ST',
                    'Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 'ST',
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': 'CAM',
                    'Ù…ÙŠØ³ÙŠ': 'CAM',
                    'ÙƒÙŠÙÙ† Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 'CAM',
                    'Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 'CAM',
                    'Ù„ÙˆÙƒØ§ Ù…ÙˆØ¯Ø±ÙŠØªØ´': 'CM',
                    'Ù…ÙˆØ¯Ø±ÙŠØªØ´': 'CM',
                    'ÙÙŠØ±Ø¬ÙŠÙ„ ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 'CB',
                    'ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 'CB',
                    'Ø³ÙŠØ±Ø¬ÙŠÙˆ Ø±Ø§Ù…ÙˆØ³': 'CB',
                    'Ø±Ø§Ù…ÙˆØ³': 'CB',
                    'Ù…Ø§Ù†ÙˆÙŠÙ„ Ù†ÙˆÙŠØ±': 'GK',
                    'Ù†ÙˆÙŠØ±': 'GK'
                };

                // Check exact match first
                if (playerData[playerName]) {
                    return playerData[playerName];
                }

                // Check partial matches
                for (const [key, position] of Object.entries(playerData)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return position;
                    }
                }

                // Default positions based on name patterns
                if (playerName.includes('Ù…Ø­Ù…Ø¯') || playerName.includes('Ø£Ø­Ù…Ø¯')) return 'ST';
                if (playerName.includes('Ø¹Ø¨Ø¯') || playerName.includes('Ø¹Ù„ÙŠ')) return 'CM';
                if (playerName.includes('Ø­Ø§Ø±Ø³')) return 'GK';

                const positions = ['ST', 'CM', 'CB', 'LW', 'RW', 'CAM'];
                return positions[Math.floor(Math.random() * positions.length)];
            }

            getPlayerAge(playerName) {
                const playerAges = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': 32,
                    'ØµÙ„Ø§Ø­': 32,
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': 36,
                    'Ø¨Ù†Ø²ÙŠÙ…Ø§': 36,
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': 32,
                    'Ù…Ø§Ù†Ù‡': 32,
                    'Ù†ÙŠÙ…Ø§Ø±': 32,
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': 25,
                    'Ù…Ø¨Ø§Ø¨ÙŠ': 25,
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': 24,
                    'Ù‡Ø§Ù„Ø§Ù†Ø¯': 24,
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 39,
                    'Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 39,
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': 37,
                    'Ù…ÙŠØ³ÙŠ': 37,
                    'ÙƒÙŠÙÙ† Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 33,
                    'Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 33,
                    'Ù„ÙˆÙƒØ§ Ù…ÙˆØ¯Ø±ÙŠØªØ´': 39,
                    'Ù…ÙˆØ¯Ø±ÙŠØªØ´': 39,
                    'ÙÙŠØ±Ø¬ÙŠÙ„ ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 33,
                    'ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 33,
                    'Ø³ÙŠØ±Ø¬ÙŠÙˆ Ø±Ø§Ù…ÙˆØ³': 38,
                    'Ø±Ø§Ù…ÙˆØ³': 38,
                    'Ù…Ø§Ù†ÙˆÙŠÙ„ Ù†ÙˆÙŠØ±': 38,
                    'Ù†ÙˆÙŠØ±': 38
                };

                // Check exact match first
                if (playerAges[playerName]) {
                    return playerAges[playerName];
                }

                // Check partial matches
                for (const [key, age] of Object.entries(playerAges)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return age;
                    }
                }

                // Generate realistic age based on name hash for consistency
                const nameHash = playerName.split('').reduce((hash, char) => {
                    return ((hash << 5) - hash) + char.charCodeAt(0);
                }, 0);

                return 20 + (Math.abs(nameHash) % 16); // 20-35 years
            }

            getPlayerNationality(playerName) {
                const nationalities = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': 'Ù…ØµØ±',
                    'ØµÙ„Ø§Ø­': 'Ù…ØµØ±',
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': 'ÙØ±Ù†Ø³Ø§',
                    'Ø¨Ù†Ø²ÙŠÙ…Ø§': 'ÙØ±Ù†Ø³Ø§',
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': 'Ø§Ù„Ø³Ù†ØºØ§Ù„',
                    'Ù…Ø§Ù†Ù‡': 'Ø§Ù„Ø³Ù†ØºØ§Ù„',
                    'Ù†ÙŠÙ…Ø§Ø±': 'Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„',
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': 'ÙØ±Ù†Ø³Ø§',
                    'Ù…Ø¨Ø§Ø¨ÙŠ': 'ÙØ±Ù†Ø³Ø§',
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': 'Ø§Ù„Ù†Ø±ÙˆÙŠØ¬',
                    'Ù‡Ø§Ù„Ø§Ù†Ø¯': 'Ø§Ù„Ù†Ø±ÙˆÙŠØ¬',
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 'Ø§Ù„Ø¨Ø±ØªØºØ§Ù„',
                    'Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 'Ø§Ù„Ø¨Ø±ØªØºØ§Ù„',
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': 'Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†',
                    'Ù…ÙŠØ³ÙŠ': 'Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†',
                    'ÙƒÙŠÙÙ† Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 'Ø¨Ù„Ø¬ÙŠÙƒØ§',
                    'Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 'Ø¨Ù„Ø¬ÙŠÙƒØ§',
                    'Ù„ÙˆÙƒØ§ Ù…ÙˆØ¯Ø±ÙŠØªØ´': 'ÙƒØ±ÙˆØ§ØªÙŠØ§',
                    'Ù…ÙˆØ¯Ø±ÙŠØªØ´': 'ÙƒØ±ÙˆØ§ØªÙŠØ§',
                    'ÙÙŠØ±Ø¬ÙŠÙ„ ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 'Ù‡ÙˆÙ„Ù†Ø¯Ø§',
                    'ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 'Ù‡ÙˆÙ„Ù†Ø¯Ø§',
                    'Ø³ÙŠØ±Ø¬ÙŠÙˆ Ø±Ø§Ù…ÙˆØ³': 'Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§',
                    'Ø±Ø§Ù…ÙˆØ³': 'Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§',
                    'Ù…Ø§Ù†ÙˆÙŠÙ„ Ù†ÙˆÙŠØ±': 'Ø£Ù„Ù…Ø§Ù†ÙŠØ§',
                    'Ù†ÙˆÙŠØ±': 'Ø£Ù„Ù…Ø§Ù†ÙŠØ§'
                };

                // Check exact and partial matches
                for (const [key, nationality] of Object.entries(nationalities)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return nationality;
                    }
                }

                // Default nationalities based on name patterns
                if (playerName.includes('Ù…Ø­Ù…Ø¯') || playerName.includes('Ø£Ø­Ù…Ø¯') || playerName.includes('Ø¹Ù„ÙŠ')) {
                    const arabCountries = ['Ù…ØµØ±', 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', 'Ø§Ù„Ù…ØºØ±Ø¨', 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±', 'ØªÙˆÙ†Ø³'];
                    return arabCountries[Math.floor(Math.random() * arabCountries.length)];
                }

                const countries = ['Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„', 'Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†', 'ÙØ±Ù†Ø³Ø§', 'Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§', 'Ø¥ÙŠØ·Ø§Ù„ÙŠØ§', 'Ø£Ù„Ù…Ø§Ù†ÙŠØ§', 'Ø¥Ù†Ø¬Ù„ØªØ±Ø§'];
                return countries[Math.floor(Math.random() * countries.length)];
            }

            getPlayerHeight(playerName) {
                const heights = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': '175 Ø³Ù…',
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': '185 Ø³Ù…',
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': '175 Ø³Ù…',
                    'Ù†ÙŠÙ…Ø§Ø±': '175 Ø³Ù…',
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': '178 Ø³Ù…',
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': '194 Ø³Ù…',
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': '187 Ø³Ù…',
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': '170 Ø³Ù…'
                };

                for (const [key, height] of Object.entries(heights)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return height;
                    }
                }

                // Generate realistic height
                const baseHeight = 170 + Math.floor(Math.random() * 25); // 170-195 cm
                return `${baseHeight} Ø³Ù…`;
            }

            getPlayerFoot(playerName) {
                const feet = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': 'Ø£ÙŠØ³Ø±',
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': 'Ø£ÙŠÙ…Ù†',
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': 'Ø£ÙŠÙ…Ù†',
                    'Ù†ÙŠÙ…Ø§Ø±': 'Ø£ÙŠÙ…Ù†',
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': 'Ø£ÙŠÙ…Ù†',
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': 'Ø£ÙŠØ³Ø±',
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 'Ø£ÙŠÙ…Ù†',
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': 'Ø£ÙŠØ³Ø±'
                };

                for (const [key, foot] of Object.entries(feet)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return foot;
                    }
                }

                return Math.random() > 0.5 ? 'Ø£ÙŠÙ…Ù†' : 'Ø£ÙŠØ³Ø±';
            }

            calculatePlayerRating(playerName, currentClub) {
                const starPlayers = {
                    'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­': 89,
                    'ØµÙ„Ø§Ø­': 89,
                    'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§': 91,
                    'Ø¨Ù†Ø²ÙŠÙ…Ø§': 91,
                    'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡': 86,
                    'Ù…Ø§Ù†Ù‡': 86,
                    'Ù†ÙŠÙ…Ø§Ø±': 89,
                    'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ': 91,
                    'Ù…Ø¨Ø§Ø¨ÙŠ': 91,
                    'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯': 88,
                    'Ù‡Ø§Ù„Ø§Ù†Ø¯': 88,
                    'ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 87,
                    'Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ': 87,
                    'Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ': 91,
                    'Ù…ÙŠØ³ÙŠ': 91,
                    'ÙƒÙŠÙÙ† Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 91,
                    'Ø¯ÙŠ Ø¨Ø±ÙˆÙŠÙ†': 91,
                    'Ù„ÙˆÙƒØ§ Ù…ÙˆØ¯Ø±ÙŠØªØ´': 88,
                    'Ù…ÙˆØ¯Ø±ÙŠØªØ´': 88,
                    'ÙÙŠØ±Ø¬ÙŠÙ„ ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 90,
                    'ÙØ§Ù† Ø¯Ø§ÙŠÙƒ': 90,
                    'Ø³ÙŠØ±Ø¬ÙŠÙˆ Ø±Ø§Ù…ÙˆØ³': 86,
                    'Ø±Ø§Ù…ÙˆØ³': 86,
                    'Ù…Ø§Ù†ÙˆÙŠÙ„ Ù†ÙˆÙŠØ±': 90,
                    'Ù†ÙˆÙŠØ±': 90
                };

                for (const [key, rating] of Object.entries(starPlayers)) {
                    if (playerName.includes(key) || key.includes(playerName)) {
                        return rating;
                    }
                }

                // Base rating calculation
                let baseRating = 75;

                const topClubs = ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†'];
                if (topClubs.includes(currentClub)) {
                    baseRating += 8;
                }

                const saudiClubs = ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ù†ØµØ±', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Ø§Ù„Ø£Ù‡Ù„ÙŠ'];
                if (saudiClubs.includes(currentClub)) {
                    baseRating += 5;
                }

                // Add some variation
                const variation = Math.floor(Math.random() * 11) - 5; // -5 to +5
                return Math.max(65, Math.min(94, baseRating + variation));
            }

            calculateMarketValue(playerName, currentClub) {
                let baseValue = Math.floor(Math.random() * 50) + 10; // 10-60M

                const topClubs = ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„'];
                if (topClubs.includes(currentClub)) {
                    baseValue += 20;
                }

                return `â‚¬${baseValue}M`;
            }

            generateContractExpiry() {
                const currentYear = new Date().getFullYear();
                const expiryYear = currentYear + Math.floor(Math.random() * 4) + 1;
                return `${expiryYear}`;
            }

            // ðŸ’¾ Saved Players Management
            async loadSavedPlayers() {
                const select = document.getElementById('savedPlayersList');
                if (!select) return;

                select.innerHTML = '<option value="">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</option>';

                try {
                    // Use the correct API endpoint from player-links system
                    const response = await fetch('/api/player-pages-cache-stats');

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();

                    if (data.success && data.data && data.data.entries && data.data.entries.length > 0) {
                        select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù„Ø§Ø¹Ø¨ Ù…Ø­ÙÙˆØ¸...</option>';
                        data.data.entries.forEach((player, index) => {
                            const option = document.createElement('option');
                            // Create a simplified player object for the Ultimate Studio
                            const playerData = {
                                arabicName: player.name || `Ù„Ø§Ø¹Ø¨ ${index + 1}`,
                                currentClub: player.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                                playerImage: player.playerImage || '',
                                pageUrl: player.url || ''
                            };
                            option.value = JSON.stringify(playerData);
                            option.textContent = `${playerData.arabicName} - ${playerData.currentClub}`;
                            select.appendChild(option);
                        });
                        console.log(`ðŸ“‹ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${data.data.entries.length} Ù„Ø§Ø¹Ø¨ Ù…Ø­ÙÙˆØ¸`);
                        this.showNotification(`ðŸ“‹ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${data.data.entries.length} Ù„Ø§Ø¹Ø¨ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`, 'success');
                    } else {
                        // Try alternative API endpoint
                        try {
                            const altResponse = await fetch('/api/get-player-pages');
                            const altData = await altResponse.json();

                            if (altData.success && altData.data) {
                                select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù„Ø§Ø¹Ø¨ Ù…Ø­ÙÙˆØ¸...</option>';
                                Object.values(altData.data).forEach((player, index) => {
                                    const option = document.createElement('option');
                                    const playerData = {
                                        arabicName: player.arabicName || player.name || `Ù„Ø§Ø¹Ø¨ ${index + 1}`,
                                        currentClub: player.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                                        playerImage: player.playerImage || '',
                                        pageUrl: player.pageUrl || ''
                                    };
                                    option.value = JSON.stringify(playerData);
                                    option.textContent = `${playerData.arabicName} - ${playerData.currentClub}`;
                                    select.appendChild(option);
                                });
                                console.log(`ðŸ“‹ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${Object.keys(altData.data).length} Ù„Ø§Ø¹Ø¨ Ù…Ø­ÙÙˆØ¸ (API Ø¨Ø¯ÙŠÙ„)`);
                                this.showNotification(`ðŸ“‹ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${Object.keys(altData.data).length} Ù„Ø§Ø¹Ø¨ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`, 'success');
                            } else {
                                select.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ†</option>';
                                console.log('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ† ÙÙŠ ÙƒÙ„Ø§ Ø§Ù„Ù€ APIs');
                                this.showNotification('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ† - ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ù† ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', 'info');
                            }
                        } catch (altError) {
                            select.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ†</option>';
                            console.log('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ†');
                            this.showNotification('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ† - ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ù† ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', 'info');
                        }
                    }
                } catch (error) {
                    select.innerHTML = '<option value="">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</option>';
                    console.error('ðŸš¨ Error loading saved players:', error);
                    this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†', 'error');
                }
            }

            async loadSavedPlayer() {
                const selectedPlayer = document.getElementById('savedPlayersList').value;
                const targetClub = document.getElementById('savedPlayerTargetClub').value.trim();

                if (!selectedPlayer) {
                    this.showNotification('ðŸš¨ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù„Ø§Ø¹Ø¨', 'warning');
                    return;
                }

                if (!targetClub) {
                    this.showNotification('ðŸš¨ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨', 'warning');
                    return;
                }

                this.isProcessing = true;
                this.updateSystemStatus('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ø­ÙÙˆØ¸...');

                try {
                    const player = JSON.parse(selectedPlayer);

                    // Clear any existing content first
                    this.clearPreviewContent();
                    this.showProfessionalLoader();

                    // Create enhanced player data with fallback
                    const enhancedData = await this.createSavedPlayerData(player, targetClub);

                    await this.generateFIFA26Visualization(enhancedData);

                    // Check auto-send to overlay
                    checkAutoSendToOverlay();

                    // Check auto-stream
                    checkAutoStreamPlayer();

                    // Check auto-send to direct stream
                    checkAutoSendToDirectStream();

                    // Check auto-send to OBS File System
                    checkAutoSendToOBSFileSystem();

                    this.showNotification(`ðŸŒŸ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${player.arabicName} Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!`, 'success');

                    // Don't clear target club field - keep user data
                } catch (error) {
                    console.error('ðŸš¨ Error loading saved player:', error);
                    this.showNotification(`âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨: ${error.message}`, 'error');
                } finally {
                    this.hideProfessionalLoader();
                    this.isProcessing = false;
                    this.updateSystemStatus('Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¨Ø¯Ø§Ø¹');
                }
            }

            // Create enhanced data for saved player
            async createSavedPlayerData(player, targetClub) {
                const playerName = player.arabicName || 'Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                const currentClub = player.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';

                // Try to get real API data first, then fallback to local calculation
                let probabilityData;
                try {
                    const response = await fetch('/api/search-player', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            arabicName: playerName,
                            targetClub: targetClub,
                            currentClub: currentClub
                        })
                    });

                    const data = await response.json();

                    if (data.success && data.targetRumor?.probability) {
                        // Use real API probability
                        const apiProbability = parseInt(data.targetRumor.probability.match(/(\d+)/)?.[1] || '0');
                        probabilityData = {
                            percentage: apiProbability,
                            display: apiProbability + '%',
                            factors: this.generateFactorsFromRealData(data),
                            confidence: this.calculateConfidenceFromReal(data),
                            trend: this.calculateTrendFromReal(apiProbability)
                        };
                    } else {
                        throw new Error('API data not available');
                    }
                } catch (error) {
                    // Fallback to local calculation
                    const localProbability = this.calculateLocalProbability(playerName, targetClub);
                    probabilityData = {
                        percentage: localProbability,
                        display: localProbability + '%',
                        factors: this.generateLocalFactors(playerName, currentClub, targetClub),
                        confidence: this.calculateLocalConfidence(localProbability),
                        trend: this.calculateTrendFromReal(localProbability)
                    };
                }

                // Get club logos
                const currentClubLogo = await this.getClubLogo(currentClub);
                const targetClubLogo = await this.getClubLogo(targetClub);

                return {
                    arabicName: playerName,
                    englishName: playerName,
                    currentClub: currentClub,
                    targetClub: targetClub,
                    imageUrl: player.playerImage || player.imageUrl || '',
                    currentClubLogo: currentClubLogo,
                    targetClubLogo: targetClubLogo,
                    probability: probabilityData,
                    position: this.getPlayerPosition(playerName),
                    age: this.getPlayerAge(playerName),
                    marketValue: this.calculateMarketValue(playerName, currentClub),
                    contractExpiry: this.generateContractExpiry(),
                    nationality: this.getPlayerNationality(playerName),
                    height: this.getPlayerHeight(playerName),
                    foot: this.getPlayerFoot(playerName),
                    rating: this.calculatePlayerRating(playerName, currentClub),
                    allRumors: []
                };
            }

            generateLocalFactors(playerName, currentClub, targetClub) {
                const factors = [];

                factors.push(`ÙŠÙ„Ø¹Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ ${currentClub}`);
                factors.push(`Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ ${targetClub}`);

                if (this.isStarPlayer(playerName)) {
                    factors.push('Ù„Ø§Ø¹Ø¨ Ù†Ø¬Ù… Ø¹Ø§Ù„Ù…ÙŠ');
                }

                if (this.isSaudiClub(targetClub)) {
                    factors.push('Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ø¬Ø§Ø°Ø¨ Ù„Ù„Ù†Ø¬ÙˆÙ…');
                }

                factors.push('ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø§Ù„ÙŠ');
                factors.push('ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡');

                return factors;
            }

            calculateLocalConfidence(probability) {
                if (probability >= 70) return 'Ø¹Ø§Ù„ÙŠØ©';
                if (probability >= 50) return 'Ù…ØªÙˆØ³Ø·Ø©';
                return 'Ù…Ù†Ø®ÙØ¶Ø©';
            }

            isStarPlayer(playerName) {
                const starPlayers = ['Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­', 'ØµÙ„Ø§Ø­', 'Ø¨Ù†Ø²ÙŠÙ…Ø§', 'Ù…Ø¨Ø§Ø¨ÙŠ', 'Ù‡Ø§Ù„Ø§Ù†Ø¯', 'Ù†ÙŠÙ…Ø§Ø±', 'Ù…ÙŠØ³ÙŠ', 'Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ'];
                return starPlayers.some(star => playerName.includes(star));
            }

            isSaudiClub(clubName) {
                const saudiClubs = ['Ø§Ù„Ù‡Ù„Ø§Ù„', 'Ø§Ù„Ù†ØµØ±', 'Ø§Ù„Ø§ØªØ­Ø§Ø¯', 'Ø§Ù„Ø£Ù‡Ù„ÙŠ', 'Ø§Ù„Ø´Ø¨Ø§Ø¨', 'Ø§Ù„ÙÙŠØµÙ„ÙŠ'];
                return saudiClubs.includes(clubName);
            }

            // ðŸ¤– AI Mode (Experimental)
            initializeAIMode() {
                console.log('ðŸ¤– AI mode initialized');
                this.showNotification('ðŸ¤– AI mode is experimental', 'info');
            }

            async generateWithAI() {
                const prompt = document.getElementById('aiPrompt').value.trim();
                if (!prompt) {
                    this.showNotification('ðŸš¨ Please enter a description', 'warning');
                    return;
                }

                this.showNotification('ðŸ¤– AI generation is coming soon!', 'info');
                // TODO: Implement AI integration
            }

            // ðŸŽ² Quick Actions
            randomPlayer() {
                const samplePlayers = [
                    { name: 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­', current: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„', target: 'Ø§Ù„Ù‡Ù„Ø§Ù„' },
                    { name: 'ÙƒØ±ÙŠÙ… Ø¨Ù†Ø²ÙŠÙ…Ø§', current: 'Ø§Ù„Ø§ØªØ­Ø§Ø¯', target: 'Ø§Ù„Ù†ØµØ±' },
                    { name: 'Ø³Ø§Ø¯ÙŠÙˆ Ù…Ø§Ù†Ù‡', current: 'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®', target: 'Ø§Ù„Ø£Ù‡Ù„ÙŠ' },
                    { name: 'Ù†ÙŠÙ…Ø§Ø±', current: 'Ø§Ù„Ù‡Ù„Ø§Ù„', target: 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©' },
                    { name: 'ÙƒÙŠÙ„ÙŠØ§Ù† Ù…Ø¨Ø§Ø¨ÙŠ', current: 'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†', target: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯' },
                    { name: 'Ø¥Ø±Ù„ÙŠÙ†Øº Ù‡Ø§Ù„Ø§Ù†Ø¯', current: 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', target: 'Ø§Ù„Ù†ØµØ±' }
                ];

                const randomIndex = Math.floor(Math.random() * samplePlayers.length);
                const player = samplePlayers[randomIndex];

                document.getElementById('playerName').value = player.name;
                document.getElementById('currentClub').value = player.current;
                document.getElementById('targetClub').value = player.target;

                this.showNotification(`ðŸŽ² Random player: ${player.name}`, 'success');
            }

            // ðŸŽ¯ SMART DATA EXPORT/IMPORT SYSTEM
            exportPlayerData() {
                try {
                    // Collect current multi-player data from UI
                    const currentMultiPlayers = this.collectCurrentMultiPlayerData();

                    const exportData = {
                        timestamp: new Date().toISOString(),
                        version: 'Ultimate Studio V4',
                        type: 'multi_players_session',
                        singlePlayer: this.currentPlayer,
                        multiPlayers: currentMultiPlayers.length > 0 ? currentMultiPlayers : this.multiPlayers,
                        settings: this.settings,
                        customTitle: this.getCustomTitle(),
                        channelRights: this.getChannelRights(),
                        playersCount: currentMultiPlayers.length || this.multiPlayers.length
                    };

                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });

                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').split('T')[0];
                    const playersCount = exportData.playersCount;
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `ultimate-studio-${playersCount}players-${timestamp}.json`;
                    link.click();

                    this.showNotification(`âœ… ØªÙ… ØªØµØ¯ÙŠØ± ${playersCount} Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                } catch (error) {
                    console.error('Export error:', error);
                    this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                }
            }

            // Collect current multi-player data from UI forms
            collectCurrentMultiPlayerData() {
                const multiPlayerInputs = document.querySelectorAll('.multi-player-input');
                const playersData = [];

                multiPlayerInputs.forEach((container, index) => {
                    const savedPlayerSelect = container.querySelector('.saved-player-select');
                    let playerData = {};

                    if (savedPlayerSelect && savedPlayerSelect.value) {
                        // This is a saved player
                        try {
                            const savedPlayer = JSON.parse(savedPlayerSelect.value);
                            playerData = {
                                ...savedPlayer,
                                targetClub: container.querySelector('.multi-player-target-club').value.trim(),
                                type: 'saved_player',
                                originalData: savedPlayer
                            };
                        } catch (error) {
                            console.error('Error parsing saved player:', error);
                        }
                    } else {
                        // This is manual input
                        const name = container.querySelector('.multi-player-name').value.trim();
                        const currentClub = container.querySelector('.multi-player-current-club').value.trim();
                        const targetClub = container.querySelector('.multi-player-target-club').value.trim();
                        const imageUrl = container.querySelector('.multi-player-image').value.trim();

                        if (name || currentClub || targetClub) {
                            playerData = {
                                arabicName: name,
                                name: name,
                                currentClub: currentClub,
                                targetClub: targetClub,
                                playerImage: imageUrl,
                                imageUrl: imageUrl,
                                type: 'manual_input'
                            };
                        }
                    }

                    if (Object.keys(playerData).length > 0) {
                        playersData.push(playerData);
                    }
                });

                return playersData;
            }

            importPlayerData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (event) => {
                    const file = event.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const importData = JSON.parse(e.target.result);

                            // Validate data structure
                            if (!importData.version || !importData.timestamp) {
                                throw new Error('Invalid data format');
                            }

                            // Import single player
                            if (importData.singlePlayer) {
                                this.currentPlayer = importData.singlePlayer;
                            }

                            // Smart import for multi players
                            if (importData.multiPlayers && Array.isArray(importData.multiPlayers)) {
                                this.multiPlayers = importData.multiPlayers;

                                // Auto-populate multi-player UI
                                this.autoPopulateMultiPlayerUI(importData.multiPlayers);
                            }

                            // Import settings
                            if (importData.settings) {
                                this.settings = { ...this.settings, ...importData.settings };
                                this.saveSettings();
                            }

                            // Import custom title and rights
                            if (importData.customTitle) {
                                this.setCustomTitle(importData.customTitle);
                            }
                            if (importData.channelRights) {
                                this.setChannelRights(importData.channelRights);
                            }

                            const playersCount = importData.multiPlayers ? importData.multiPlayers.length : 0;
                            this.showNotification(`âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${playersCount} Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­`, 'success');

                        } catch (error) {
                            console.error('Import error:', error);
                            this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù', 'error');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            // Smart auto-populate multi-player UI with automatic visualization
            async autoPopulateMultiPlayerUI(playersData) {
                try {
                    // Switch to multi-player mode first
                    const inputMode = document.getElementById('inputMode');
                    if (inputMode) {
                        inputMode.value = 'multi';
                        await this.switchMode('multi');
                    }

                    // Clear existing inputs first
                    const multiContainer = document.getElementById('multiPlayersContainer');
                    if (!multiContainer) {
                        this.showNotification('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ø§ÙˆÙŠ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ†', 'error');
                        return;
                    }

                    multiContainer.innerHTML = '';

                    // Add inputs for each player
                    for (let i = 0; i < playersData.length; i++) {
                        const player = playersData[i];

                        // Add new input container
                        if (player.type === 'saved_player' && player.originalData) {
                            await this.addSavedMultiPlayer();
                        } else {
                            this.addManualMultiPlayer();
                        }

                        // Get the newly added container
                        const containers = multiContainer.querySelectorAll('.multi-player-input');
                        const container = containers[containers.length - 1];

                        if (container) {
                            // Populate based on player type
                            if (player.type === 'saved_player' && player.originalData) {
                                // This was a saved player - try to restore saved player selection
                                const savedPlayerSelect = container.querySelector('.saved-player-select');
                                if (savedPlayerSelect) {
                                    // Try to find matching saved player
                                    const savedPlayers = this.getSavedPlayers();
                                    const matchingPlayer = savedPlayers.find(sp =>
                                        sp.arabicName === player.arabicName ||
                                        sp.name === player.name ||
                                        sp.id === player.id
                                    );

                                    if (matchingPlayer) {
                                        savedPlayerSelect.value = JSON.stringify(matchingPlayer);
                                        // Trigger change event to populate other fields
                                        await this.loadSelectedSavedPlayer(savedPlayerSelect);
                                    }
                                }
                            } else {
                                // Manual input - populate directly
                                container.querySelector('.multi-player-name').value = player.arabicName || player.name || '';
                                container.querySelector('.multi-player-current-club').value = player.currentClub || '';
                                container.querySelector('.multi-player-image').value = player.playerImage || player.imageUrl || '';
                            }

                            // Always set target club
                            container.querySelector('.multi-player-target-club').value = player.targetClub || '';
                        }
                    }

                    // Update UI counter
                    this.updateMultiPlayerCounter();

                    this.showNotification(`ðŸŽ¯ ØªÙ… Ù…Ù„Ø¡ ${playersData.length} Ù„Ø§Ø¹Ø¨ÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹`, 'success');

                    // Auto-generate visualization after import
                    setTimeout(async () => {
                        await this.autoGenerateAfterImport(playersData);
                    }, 1000);

                } catch (error) {
                    console.error('Error in autoPopulateMultiPlayerUI:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', 'error');
                }
            }

            // Auto-generate visualization after import
            async autoGenerateAfterImport(playersData) {
                try {
                    this.showNotification('ðŸŽ¨ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØµÙ…ÙŠÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...', 'info');

                    // Generate multi-player visualization
                    await this.generateMultiVisualization('all');

                    // Auto-send to OBS if available
                    setTimeout(() => {
                        this.autoSendToOBS();
                    }, 2000);

                    this.showNotification(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªØµÙ…ÙŠÙ… ${playersData.length} Ù„Ø§Ø¹Ø¨ÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹!`, 'success');
                } catch (error) {
                    console.error('Error in auto-generation:', error);
                    this.showNotification('âš ï¸ ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙƒÙ† ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØµÙ…ÙŠÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', 'warning');
                }
            }

            // Auto-send to OBS after import
            autoSendToOBS() {
                try {
                    // Check if OBS is ready
                    const obsReady = localStorage.getItem('obsReady');
                    if (!obsReady) {
                        console.log('ðŸ“º OBS not ready, skipping auto-send');
                        return;
                    }

                    // Get current preview content
                    const previewContent = document.getElementById('previewContent');
                    if (previewContent && previewContent.innerHTML.trim()) {
                        // Send to direct stream
                        const streamData = {
                            html: previewContent.innerHTML,
                            timestamp: Date.now(),
                            source: 'auto-import'
                        };

                        localStorage.setItem('directStreamContent', JSON.stringify(streamData));
                        localStorage.setItem('directStreamActive', 'true');
                        localStorage.setItem('directStreamContentChanged', Date.now().toString());

                        // Also send via postMessage
                        window.postMessage({
                            type: 'STREAM_UPDATE',
                            data: streamData
                        }, '*');

                        this.showNotification('ðŸ“º ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¥Ù„Ù‰ OBS ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', 'success');
                        console.log('ðŸ“º Auto-sent to OBS after import');
                    }
                } catch (error) {
                    console.error('Error auto-sending to OBS:', error);
                }
            }

            // Get saved players from localStorage
            getSavedPlayers() {
                try {
                    const savedPlayers = localStorage.getItem('savedPlayers');
                    return savedPlayers ? JSON.parse(savedPlayers) : [];
                } catch (error) {
                    console.error('Error loading saved players:', error);
                    return [];
                }
            }

            // Update multi-player counter
            updateMultiPlayerCounter() {
                const multiContainer = document.getElementById('multiPlayerInputs');
                if (multiContainer) {
                    const count = multiContainer.querySelectorAll('.multi-player-input').length;
                    const counterElement = document.querySelector('.multi-player-counter');
                    if (counterElement) {
                        counterElement.textContent = `${count} Ù„Ø§Ø¹Ø¨`;
                    }
                }
            }

            refreshMultiPlayerUI() {
                // Legacy function - kept for compatibility
                this.autoPopulateMultiPlayerUI(this.multiPlayers);
            }

            // ðŸŽ¨ NEW CARD DESIGN SYSTEM
            getSelectedCardDesign() {
                return this.settings.cardDesign || 'financial';
            }

            // Master card creation function
            createPlayerCardHTML(player, animationDelay = 0) {
                const design = this.getSelectedCardDesign();

                switch (design) {
                    case 'modern':
                        return this.createModernCardHTML(player, animationDelay);
                    case 'minimalist':
                        return this.createMinimalistCardHTML(player, animationDelay);
                    case 'glassmorphism':
                        return this.createGlassmorphismCardHTML(player, animationDelay);
                    case 'cyberpunk':
                        return this.createCyberpunkCardHTML(player, animationDelay);
                    case 'neon':
                        return this.createNeonCardHTML(player, animationDelay);
                    case 'holographic':
                        return this.createHolographicCardHTML(player, animationDelay);
                    case 'financial':
                    default:
                        return this.createFinancialCardHTML(player, animationDelay);
                }
            }

            // Helper function to get probability value
            getProbabilityValue(player) {
                if (player.probability && player.probability.percentage) {
                    return player.probability.percentage;
                }
                if (player.transferProbability) {
                    return player.transferProbability;
                }
                return 50; // Default value
            }

            // Modern FIFA-inspired card design
            createModernCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);
                const probabilityColor = this.getProbabilityColor(probabilityValue);

                return `
                    <div class="modern-card" style="
                        position: relative;
                        width: 380px;
                        height: 520px;
                        background: linear-gradient(145deg,
                            rgba(15, 25, 45, 0.98) 0%,
                            rgba(25, 35, 65, 0.95) 50%,
                            rgba(35, 45, 85, 0.98) 100%);
                        border-radius: 25px;
                        padding: 0;
                        overflow: hidden;
                        box-shadow:
                            0 25px 50px rgba(0, 0, 0, 0.6),
                            0 0 0 2px ${probabilityColor}40,
                            0 0 30px ${probabilityColor}30;
                        animation: modernCardEntrance 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${animationDelay}s both;
                        border: 2px solid ${probabilityColor}60;
                    ">
                        <!-- Card Header -->
                        <div style="
                            position: relative;
                            height: 80px;
                            background: linear-gradient(135deg, ${probabilityColor}20, ${probabilityColor}10);
                            display: flex;
                            align-items: center;
                            justify-content: space-between;
                            padding: 0 20px;
                            border-bottom: 2px solid ${probabilityColor}30;
                        ">
                            <div style="
                                color: ${probabilityColor};
                                font-size: 1.1rem;
                                font-weight: 700;
                                text-transform: uppercase;
                                letter-spacing: 1px;
                            ">TRANSFER</div>
                            <div style="
                                background: ${probabilityColor};
                                color: white;
                                padding: 8px 16px;
                                border-radius: 15px;
                                font-weight: 800;
                                font-size: 1.2rem;
                            ">${probabilityValue}%</div>
                        </div>

                        <!-- Player Image Section -->
                        <div style="
                            position: relative;
                            height: 200px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
                        ">
                            ${player.playerImage ? `
                            <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                width: 160px;
                                height: 160px;
                                border-radius: 50%;
                                object-fit: cover;
                                border: 4px solid ${probabilityColor};
                                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                                filter: brightness(1.1) contrast(1.1);
                            ">
                            ` : `
                            <div style="
                                width: 160px;
                                height: 160px;
                                border-radius: 50%;
                                background: linear-gradient(135deg, ${probabilityColor}30, ${probabilityColor}10);
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                border: 4px solid ${probabilityColor};
                                color: ${probabilityColor};
                                font-size: 3rem;
                                font-weight: 900;
                            ">âš½</div>
                            `}
                        </div>

                        <!-- Player Info -->
                        <div style="
                            padding: 20px;
                            text-align: center;
                        ">
                            <h2 style="
                                color: white;
                                font-size: 1.8rem;
                                font-weight: 800;
                                margin: 0 0 10px 0;
                                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                            ">${player.arabicName || player.name}</h2>

                            <!-- Clubs Section -->
                            <div style="
                                display: flex;
                                align-items: center;
                                justify-content: space-between;
                                margin: 20px 0;
                                padding: 15px;
                                background: rgba(255, 255, 255, 0.05);
                                border-radius: 15px;
                                backdrop-filter: blur(10px);
                            ">
                                <!-- Current Club -->
                                <div style="text-align: center; flex: 1;">
                                    ${player.currentClubLogo ? `
                                    <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                        width: 40px;
                                        height: 40px;
                                        object-fit: contain;
                                        margin-bottom: 8px;
                                        filter: brightness(1.1);
                                    ">
                                    ` : ''}
                                    <div style="color: rgba(255, 255, 255, 0.9); font-size: 0.9rem; font-weight: 600;">
                                        ${player.currentClub}
                                    </div>
                                </div>

                                <!-- Arrow -->
                                <div style="
                                    flex: 0 0 60px;
                                    display: flex;
                                    justify-content: center;
                                    color: ${probabilityColor};
                                    font-size: 1.5rem;
                                    font-weight: 900;
                                ">â†</div>

                                <!-- Target Club -->
                                <div style="text-align: center; flex: 1;">
                                    ${player.targetClubLogo ? `
                                    <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                        width: 40px;
                                        height: 40px;
                                        object-fit: contain;
                                        margin-bottom: 8px;
                                        filter: brightness(1.1) drop-shadow(0 0 10px ${probabilityColor}60);
                                    ">
                                    ` : ''}
                                    <div style="color: ${probabilityColor}; font-size: 0.9rem; font-weight: 600;">
                                        ${player.targetClub}
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Info -->
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                margin-top: 15px;
                                padding-top: 15px;
                                border-top: 1px solid rgba(255, 255, 255, 0.1);
                            ">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem;">
                                    Ø§Ù„Ø¹Ù…Ø±: ${player.age || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                                </div>
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem;">
                                    Ø§Ù„Ù…Ø±ÙƒØ²: ${player.position || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Minimalist card design
            createMinimalistCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);
                const probabilityColor = this.getProbabilityColor(probabilityValue);

                return `
                    <div class="minimalist-card" style="
                        position: relative;
                        width: 400px;
                        height: 280px;
                        background: rgba(255, 255, 255, 0.95);
                        border-radius: 20px;
                        padding: 30px;
                        overflow: hidden;
                        box-shadow:
                            0 20px 40px rgba(0, 0, 0, 0.1),
                            0 0 0 1px rgba(0, 0, 0, 0.05);
                        animation: minimalistCardEntrance 1s ease-out ${animationDelay}s both;
                        color: #2d3748;
                    ">
                        <!-- Probability Badge -->
                        <div style="
                            position: absolute;
                            top: 20px;
                            right: 20px;
                            background: ${probabilityColor};
                            color: white;
                            padding: 8px 16px;
                            border-radius: 25px;
                            font-weight: 800;
                            font-size: 1.1rem;
                            box-shadow: 0 4px 15px ${probabilityColor}40;
                        ">${probabilityValue}%</div>

                        <!-- Player Info -->
                        <div style="
                            display: flex;
                            align-items: center;
                            gap: 20px;
                            height: 100%;
                        ">
                            <!-- Player Image -->
                            <div style="flex: 0 0 120px;">
                                ${player.playerImage ? `
                                <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                    width: 120px;
                                    height: 120px;
                                    border-radius: 15px;
                                    object-fit: cover;
                                    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                                ">
                                ` : `
                                <div style="
                                    width: 120px;
                                    height: 120px;
                                    border-radius: 15px;
                                    background: linear-gradient(135deg, ${probabilityColor}20, ${probabilityColor}10);
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    color: ${probabilityColor};
                                    font-size: 2.5rem;
                                ">âš½</div>
                                `}
                            </div>

                            <!-- Content -->
                            <div style="flex: 1;">
                                <h2 style="
                                    color: #1a202c;
                                    font-size: 1.6rem;
                                    font-weight: 700;
                                    margin: 0 0 15px 0;
                                ">${player.arabicName || player.name}</h2>

                                <!-- Transfer Info -->
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 15px;
                                    margin-bottom: 15px;
                                ">
                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        gap: 8px;
                                        padding: 8px 12px;
                                        background: #f7fafc;
                                        border-radius: 10px;
                                        border-left: 4px solid #e2e8f0;
                                    ">
                                        ${player.currentClubLogo ? `
                                        <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                            width: 24px;
                                            height: 24px;
                                            object-fit: contain;
                                        ">
                                        ` : ''}
                                        <span style="font-size: 0.9rem; color: #4a5568; font-weight: 600;">
                                            ${player.currentClub}
                                        </span>
                                    </div>

                                    <div style="
                                        color: ${probabilityColor};
                                        font-size: 1.2rem;
                                        font-weight: 700;
                                    ">â†</div>

                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        gap: 8px;
                                        padding: 8px 12px;
                                        background: ${probabilityColor}10;
                                        border-radius: 10px;
                                        border-left: 4px solid ${probabilityColor};
                                    ">
                                        ${player.targetClubLogo ? `
                                        <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                            width: 24px;
                                            height: 24px;
                                            object-fit: contain;
                                        ">
                                        ` : ''}
                                        <span style="font-size: 0.9rem; color: ${probabilityColor}; font-weight: 600;">
                                            ${player.targetClub}
                                        </span>
                                    </div>
                                </div>

                                <!-- Additional Info -->
                                <div style="
                                    display: flex;
                                    gap: 20px;
                                    font-size: 0.85rem;
                                    color: #718096;
                                ">
                                    <span>Ø§Ù„Ø¹Ù…Ø±: ${player.age || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    <span>Ø§Ù„Ù…Ø±ÙƒØ²: ${player.position || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Glassmorphism card design (Modern glass effect)
            createGlassmorphismCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);
                const probabilityColor = this.getProbabilityColor(probabilityValue);

                return `
                    <div class="glassmorphism-card" style="
                        position: relative;
                        width: 420px;
                        height: 580px;
                        background: linear-gradient(135deg,
                            rgba(255, 255, 255, 0.1) 0%,
                            rgba(255, 255, 255, 0.05) 100%);
                        backdrop-filter: blur(20px);
                        -webkit-backdrop-filter: blur(20px);
                        border-radius: 30px;
                        border: 1px solid rgba(255, 255, 255, 0.2);
                        padding: 0;
                        overflow: hidden;
                        box-shadow:
                            0 8px 32px rgba(0, 0, 0, 0.3),
                            inset 0 1px 0 rgba(255, 255, 255, 0.2),
                            0 0 50px ${probabilityColor}30;
                        animation: glassCardEntrance 1.5s cubic-bezier(0.23, 1, 0.32, 1) ${animationDelay}s both;
                    ">
                        <!-- Glass reflection effect -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: linear-gradient(135deg,
                                rgba(255, 255, 255, 0.1) 0%,
                                transparent 50%,
                                rgba(255, 255, 255, 0.05) 100%);
                            pointer-events: none;
                            animation: glassReflection 3s ease-in-out infinite;
                        "></div>

                        <!-- Header section -->
                        <div style="
                            position: relative;
                            padding: 30px 30px 20px;
                            text-align: center;
                            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                        ">
                            <div style="
                                display: inline-block;
                                background: linear-gradient(135deg, ${probabilityColor}40, ${probabilityColor}20);
                                backdrop-filter: blur(10px);
                                border: 1px solid ${probabilityColor}30;
                                border-radius: 25px;
                                padding: 12px 24px;
                                color: white;
                                font-weight: 800;
                                font-size: 1.4rem;
                                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                                box-shadow: 0 4px 20px ${probabilityColor}20;
                            ">${probabilityValue}%</div>
                        </div>

                        <!-- Player section -->
                        <div style="
                            position: relative;
                            padding: 30px;
                            text-align: center;
                        ">
                            <!-- Player image -->
                            ${player.playerImage ? `
                            <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                width: 180px;
                                height: 180px;
                                border-radius: 50%;
                                object-fit: cover;
                                border: 3px solid rgba(255, 255, 255, 0.3);
                                box-shadow:
                                    0 15px 35px rgba(0, 0, 0, 0.3),
                                    0 0 30px ${probabilityColor}40;
                                filter: brightness(1.1) contrast(1.1);
                                margin-bottom: 20px;
                            ">
                            ` : `
                            <div style="
                                width: 180px;
                                height: 180px;
                                border-radius: 50%;
                                background: linear-gradient(135deg, ${probabilityColor}30, ${probabilityColor}10);
                                backdrop-filter: blur(10px);
                                border: 3px solid rgba(255, 255, 255, 0.3);
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                color: white;
                                font-size: 4rem;
                                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                                margin: 0 auto 20px;
                            ">âš½</div>
                            `}

                            <!-- Player name -->
                            <h2 style="
                                color: white;
                                font-size: 2rem;
                                font-weight: 800;
                                margin: 0 0 25px 0;
                                text-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
                            ">${player.arabicName || player.name}</h2>

                            <!-- Clubs section -->
                            <div style="
                                display: flex;
                                align-items: center;
                                justify-content: space-between;
                                margin: 25px 0;
                                padding: 20px;
                                background: rgba(255, 255, 255, 0.08);
                                backdrop-filter: blur(15px);
                                border-radius: 20px;
                                border: 1px solid rgba(255, 255, 255, 0.1);
                            ">
                                <!-- Current Club -->
                                <div style="text-align: center; flex: 1;">
                                    ${player.currentClubLogo ? `
                                    <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                        width: 45px;
                                        height: 45px;
                                        object-fit: contain;
                                        margin-bottom: 10px;
                                        filter: brightness(1.1);
                                    ">
                                    ` : ''}
                                    <div style="
                                        color: rgba(255, 255, 255, 0.9);
                                        font-size: 0.95rem;
                                        font-weight: 600;
                                    ">${player.currentClub}</div>
                                </div>

                                <!-- Arrow -->
                                <div style="
                                    flex: 0 0 60px;
                                    display: flex;
                                    justify-content: center;
                                    color: ${probabilityColor};
                                    font-size: 1.5rem;
                                    font-weight: 900;
                                ">â†</div>

                                <!-- Target Club -->
                                <div style="text-align: center; flex: 1;">
                                    ${player.targetClubLogo ? `
                                    <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                        width: 45px;
                                        height: 45px;
                                        object-fit: contain;
                                        margin-bottom: 10px;
                                        filter: brightness(1.2) drop-shadow(0 0 10px ${probabilityColor}60);
                                    ">
                                    ` : ''}
                                    <div style="
                                        color: ${probabilityColor};
                                        font-size: 0.95rem;
                                        font-weight: 700;
                                    ">${player.targetClub}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Cyberpunk card design (Futuristic neon style)
            createCyberpunkCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);
                const probabilityColor = this.getProbabilityColor(probabilityValue);

                return `
                    <div class="cyberpunk-card" style="
                        position: relative;
                        width: 450px;
                        height: 600px;
                        background: linear-gradient(145deg,
                            #0a0a0a 0%,
                            #1a1a2e 30%,
                            #16213e  70%,
                            #0f0f23 100%);
                        border-radius: 15px;
                        padding: 0;
                        overflow: hidden;
                        border: 2px solid ${probabilityColor};
                        box-shadow:
                            0 0 30px ${probabilityColor}60,
                            0 0 60px ${probabilityColor}30,
                            inset 0 0 30px rgba(0, 0, 0, 0.5);
                        animation: cyberpunkEntrance 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) ${animationDelay}s both;
                        position: relative;
                    ">
                        <!-- Cyberpunk grid background -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background-image:
                                linear-gradient(${probabilityColor}30 1px, transparent 1px),
                                linear-gradient(90deg, ${probabilityColor}30 1px, transparent 1px);
                            background-size: 20px 20px;
                            animation: gridPulse 4s ease-in-out infinite;
                            pointer-events: none;
                        "></div>

                        <!-- Glitch lines -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: linear-gradient(90deg,
                                transparent 0%,
                                ${probabilityColor}20 50%,
                                transparent 100%);
                            animation: glitchScan 3s linear infinite;
                            pointer-events: none;
                        "></div>

                        <!-- Header HUD -->
                        <div style="
                            position: relative;
                            padding: 25px;
                            border-bottom: 2px solid ${probabilityColor}50;
                            background: linear-gradient(90deg,
                                transparent 0%,
                                rgba(0, 0, 0, 0.3) 50%,
                                transparent 100%);
                        ">
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 15px;
                            ">
                                <div style="
                                    color: ${probabilityColor};
                                    font-family: 'Courier New', monospace;
                                    font-size: 0.9rem;
                                    font-weight: 700;
                                    text-transform: uppercase;
                                    letter-spacing: 2px;
                                    text-shadow: 0 0 10px currentColor;
                                ">TRANSFER_PROTOCOL</div>
                                <div style="
                                    color: #00ff41;
                                    font-family: 'Courier New', monospace;
                                    font-size: 0.8rem;
                                    animation: textGlitch 2s infinite;
                                ">ONLINE</div>
                            </div>

                            <div style="
                                background: linear-gradient(90deg, ${probabilityColor}, #ff0080);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                background-clip: text;
                                font-size: 3rem;
                                font-weight: 900;
                                font-family: 'Courier New', monospace;
                                text-align: center;
                                text-shadow: 0 0 20px ${probabilityColor}80;
                                animation: probabilityGlow 2s ease-in-out infinite alternate;
                            ">${probabilityValue}%</div>
                        </div>

                        <!-- Player data section -->
                        <div style="
                            position: relative;
                            padding: 30px 25px;
                        ">
                            <!-- Player image with hologram effect -->
                            <div style="
                                position: relative;
                                text-align: center;
                                margin-bottom: 25px;
                            ">
                                ${player.playerImage ? `
                                <div style="
                                    position: relative;
                                    display: inline-block;
                                ">
                                    <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                        width: 160px;
                                        height: 160px;
                                        border-radius: 10px;
                                        object-fit: cover;
                                        border: 2px solid ${probabilityColor};
                                        box-shadow:
                                            0 0 20px ${probabilityColor}60,
                                            inset 0 0 20px rgba(0, 0, 0, 0.3);
                                        filter: brightness(1.2) contrast(1.3) hue-rotate(10deg);
                                        animation: hologramFlicker 3s infinite;
                                    ">
                                    <!-- Hologram scan lines -->
                                    <div style="
                                        position: absolute;
                                        top: 0;
                                        left: 0;
                                        width: 100%;
                                        height: 100%;
                                        background: repeating-linear-gradient(
                                            0deg,
                                            transparent,
                                            transparent 2px,
                                            ${probabilityColor}20 2px,
                                            ${probabilityColor}20 4px
                                        );
                                        border-radius: 10px;
                                        animation: scanLines 2s linear infinite;
                                        pointer-events: none;
                                    "></div>
                                </div>
                                ` : `
                                <div style="
                                    width: 160px;
                                    height: 160px;
                                    border-radius: 10px;
                                    background: linear-gradient(135deg, ${probabilityColor}30, #ff008030);
                                    border: 2px solid ${probabilityColor};
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    color: ${probabilityColor};
                                    font-size: 4rem;
                                    margin: 0 auto;
                                    box-shadow: 0 0 20px ${probabilityColor}60;
                                    animation: hologramFlicker 3s infinite;
                                ">âš½</div>
                                `}
                            </div>

                            <!-- Player name with glitch effect -->
                            <h2 style="
                                color: white;
                                font-size: 1.8rem;
                                font-weight: 800;
                                margin: 0 0 20px 0;
                                text-align: center;
                                font-family: 'Courier New', monospace;
                                text-transform: uppercase;
                                letter-spacing: 3px;
                                text-shadow:
                                    0 0 10px ${probabilityColor},
                                    2px 2px 0px #ff0080,
                                    -2px -2px 0px #00ffff;
                                animation: nameGlitch 4s infinite;
                            ">${player.arabicName || player.name}</h2>

                            <!-- Transfer data -->
                            <div style="
                                background: rgba(0, 0, 0, 0.6);
                                border: 1px solid ${probabilityColor}50;
                                border-radius: 10px;
                                padding: 20px;
                                margin: 20px 0;
                                position: relative;
                            ">
                                <!-- Data header -->
                                <div style="
                                    color: ${probabilityColor};
                                    font-family: 'Courier New', monospace;
                                    font-size: 0.8rem;
                                    font-weight: 700;
                                    text-transform: uppercase;
                                    letter-spacing: 1px;
                                    margin-bottom: 15px;
                                    text-shadow: 0 0 5px currentColor;
                                ">TRANSFER_DATA</div>

                                <div style="
                                    display: flex;
                                    align-items: center;
                                    justify-content: space-between;
                                ">
                                    <!-- Current Club -->
                                    <div style="
                                        text-align: center;
                                        flex: 1;
                                        padding: 10px;
                                        background: rgba(255, 255, 255, 0.05);
                                        border-radius: 8px;
                                        border: 1px solid rgba(255, 255, 255, 0.1);
                                    ">
                                        ${player.currentClubLogo ? `
                                        <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                            width: 40px;
                                            height: 40px;
                                            object-fit: contain;
                                            margin-bottom: 8px;
                                            filter: brightness(1.2) drop-shadow(0 0 5px ${probabilityColor}40);
                                        ">
                                        ` : ''}
                                        <div style="
                                            color: #00ff41;
                                            font-family: 'Courier New', monospace;
                                            font-size: 0.8rem;
                                            font-weight: 600;
                                            text-shadow: 0 0 5px currentColor;
                                        ">${player.currentClub}</div>
                                    </div>

                                    <!-- Transfer arrow -->
                                    <div style="
                                        flex: 0 0 80px;
                                        text-align: center;
                                        color: ${probabilityColor};
                                        font-size: 2rem;
                                        font-weight: 900;
                                        text-shadow: 0 0 15px currentColor;
                                        animation: arrowPulse 1.5s ease-in-out infinite;
                                    ">â—€</div>

                                    <!-- Target Club -->
                                    <div style="
                                        text-align: center;
                                        flex: 1;
                                        padding: 10px;
                                        background: linear-gradient(135deg, ${probabilityColor}20, #ff008020);
                                        border-radius: 8px;
                                        border: 1px solid ${probabilityColor}50;
                                        box-shadow: 0 0 15px ${probabilityColor}30;
                                    ">
                                        ${player.targetClubLogo ? `
                                        <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                            width: 40px;
                                            height: 40px;
                                            object-fit: contain;
                                            margin-bottom: 8px;
                                            filter: brightness(1.3) drop-shadow(0 0 10px ${probabilityColor}80);
                                        ">
                                        ` : ''}
                                        <div style="
                                            color: ${probabilityColor};
                                            font-family: 'Courier New', monospace;
                                            font-size: 0.8rem;
                                            font-weight: 700;
                                            text-shadow: 0 0 8px currentColor;
                                        ">${player.targetClub}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional stats -->
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                margin-top: 20px;
                            ">
                                <div style="
                                    background: rgba(0, 0, 0, 0.4);
                                    border: 1px solid #00ff4150;
                                    border-radius: 8px;
                                    padding: 10px 15px;
                                    text-align: center;
                                    flex: 1;
                                    margin-right: 10px;
                                ">
                                    <div style="
                                        color: #00ff41;
                                        font-family: 'Courier New', monospace;
                                        font-size: 0.7rem;
                                        font-weight: 600;
                                        margin-bottom: 5px;
                                    ">AGE</div>
                                    <div style="
                                        color: white;
                                        font-family: 'Courier New', monospace;
                                        font-size: 1rem;
                                        font-weight: 700;
                                    ">${player.age || 'N/A'}</div>
                                </div>
                                <div style="
                                    background: rgba(0, 0, 0, 0.4);
                                    border: 1px solid #ff008050;
                                    border-radius: 8px;
                                    padding: 10px 15px;
                                    text-align: center;
                                    flex: 1;
                                ">
                                    <div style="
                                        color: #ff0080;
                                        font-family: 'Courier New', monospace;
                                        font-size: 0.7rem;
                                        font-weight: 600;
                                        margin-bottom: 5px;
                                    ">POS</div>
                                    <div style="
                                        color: white;
                                        font-family: 'Courier New', monospace;
                                        font-size: 1rem;
                                        font-weight: 700;
                                    ">${player.position || 'N/A'}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Neon card design (Vibrant neon style)
            createNeonCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);
                const probabilityColor = this.getProbabilityColor(probabilityValue);

                return `
                    <div class="neon-card" style="
                        position: relative;
                        width: 400px;
                        height: 550px;
                        background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f23 100%);
                        border-radius: 20px;
                        padding: 25px;
                        overflow: hidden;
                        border: 3px solid ${probabilityColor};
                        box-shadow:
                            0 0 20px ${probabilityColor},
                            0 0 40px ${probabilityColor}60,
                            0 0 80px ${probabilityColor}30,
                            inset 0 0 20px rgba(0, 0, 0, 0.5);
                        animation: neonPulse 2s ease-in-out infinite alternate;
                    ">
                        <!-- Neon glow effect -->
                        <div style="
                            position: absolute;
                            top: -50%;
                            left: -50%;
                            width: 200%;
                            height: 200%;
                            background: conic-gradient(${probabilityColor}, #ff0080, #00ffff, ${probabilityColor});
                            animation: neonRotate 4s linear infinite;
                            z-index: -1;
                        "></div>

                        <div style="
                            position: absolute;
                            top: 3px;
                            left: 3px;
                            right: 3px;
                            bottom: 3px;
                            background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f23 100%);
                            border-radius: 17px;
                            z-index: 1;
                        "></div>

                        <div style="position: relative; z-index: 2;">
                            <!-- Header -->
                            <div style="text-align: center; margin-bottom: 25px;">
                                <div style="
                                    color: ${probabilityColor};
                                    font-size: 3rem;
                                    font-weight: 900;
                                    text-shadow:
                                        0 0 10px currentColor,
                                        0 0 20px currentColor,
                                        0 0 30px currentColor;
                                    animation: neonFlicker 3s infinite;
                                ">${probabilityValue}%</div>
                            </div>

                            <!-- Player -->
                            <div style="text-align: center; margin-bottom: 25px;">
                                ${player.playerImage ? `
                                <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                    width: 150px;
                                    height: 150px;
                                    border-radius: 50%;
                                    object-fit: cover;
                                    border: 2px solid ${probabilityColor};
                                    box-shadow: 0 0 20px ${probabilityColor}80;
                                    margin-bottom: 15px;
                                ">
                                ` : `
                                <div style="
                                    width: 150px;
                                    height: 150px;
                                    border-radius: 50%;
                                    background: linear-gradient(45deg, ${probabilityColor}30, #ff008030);
                                    border: 2px solid ${probabilityColor};
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    color: ${probabilityColor};
                                    font-size: 3rem;
                                    margin: 0 auto 15px;
                                    box-shadow: 0 0 20px ${probabilityColor}80;
                                ">âš½</div>
                                `}

                                <h2 style="
                                    color: white;
                                    font-size: 1.8rem;
                                    font-weight: 800;
                                    margin: 0;
                                    text-shadow: 0 0 15px ${probabilityColor}80;
                                ">${player.arabicName || player.name}</h2>
                            </div>

                            <!-- Clubs -->
                            <div style="
                                display: flex;
                                align-items: center;
                                justify-content: space-between;
                                background: rgba(0, 0, 0, 0.3);
                                border: 1px solid ${probabilityColor}50;
                                border-radius: 15px;
                                padding: 20px;
                                box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
                            ">
                                <div style="text-align: center; flex: 1;">
                                    ${player.currentClubLogo ? `
                                    <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                        width: 35px; height: 35px; object-fit: contain; margin-bottom: 8px;
                                        filter: drop-shadow(0 0 5px ${probabilityColor}60);
                                    ">` : ''}
                                    <div style="color: white; font-size: 0.9rem; font-weight: 600;">${player.currentClub}</div>
                                </div>
                                <div style="color: ${probabilityColor}; font-size: 1.5rem; font-weight: 900; flex: 0 0 40px; text-align: center;">â†</div>
                                <div style="text-align: center; flex: 1;">
                                    ${player.targetClubLogo ? `
                                    <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                        width: 35px; height: 35px; object-fit: contain; margin-bottom: 8px;
                                        filter: drop-shadow(0 0 10px ${probabilityColor}80);
                                    ">` : ''}
                                    <div style="color: ${probabilityColor}; font-size: 0.9rem; font-weight: 700;">${player.targetClub}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Holographic card design (Rainbow hologram effect)
            createHolographicCardHTML(player, animationDelay = 0) {
                const probabilityValue = this.getProbabilityValue(player);

                return `
                    <div class="holographic-card" style="
                        position: relative;
                        width: 380px;
                        height: 520px;
                        background: linear-gradient(45deg, #1a1a2e, #16213e, #0f0f23);
                        border-radius: 25px;
                        padding: 25px;
                        overflow: hidden;
                        border: 2px solid transparent;
                        background-clip: padding-box;
                        animation: holoCardEntrance 2s ease-out ${animationDelay}s both;
                    ">
                        <!-- Holographic border -->
                        <div style="
                            position: absolute;
                            top: -2px; left: -2px; right: -2px; bottom: -2px;
                            background: linear-gradient(45deg, #ff0080, #00ffff, #ff8000, #8000ff, #ff0080);
                            background-size: 400% 400%;
                            border-radius: 27px;
                            z-index: -1;
                            animation: holoBorder 3s ease-in-out infinite;
                        "></div>

                        <!-- Rainbow reflection -->
                        <div style="
                            position: absolute;
                            top: 0; left: 0; width: 100%; height: 100%;
                            background: linear-gradient(135deg,
                                rgba(255, 0, 128, 0.1) 0%,
                                rgba(0, 255, 255, 0.1) 25%,
                                rgba(255, 128, 0, 0.1) 50%,
                                rgba(128, 0, 255, 0.1) 75%,
                                rgba(255, 0, 128, 0.1) 100%);
                            background-size: 200% 200%;
                            border-radius: 23px;
                            animation: holoShimmer 4s ease-in-out infinite;
                            pointer-events: none;
                        "></div>

                        <div style="position: relative; z-index: 2; text-align: center;">
                            <!-- Probability -->
                            <div style="
                                background: linear-gradient(45deg, #ff0080, #00ffff, #ff8000);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                background-clip: text;
                                font-size: 2.5rem;
                                font-weight: 900;
                                margin-bottom: 20px;
                                animation: holoText 2s ease-in-out infinite;
                            ">${probabilityValue}%</div>

                            <!-- Player -->
                            ${player.playerImage ? `
                            <img src="${player.playerImage}" alt="${player.arabicName || player.name}" style="
                                width: 140px; height: 140px; border-radius: 50%; object-fit: cover;
                                border: 3px solid transparent;
                                background: linear-gradient(45deg, #ff0080, #00ffff, #ff8000, #8000ff) border-box;
                                margin-bottom: 15px;
                                filter: brightness(1.2) contrast(1.2);
                            ">
                            ` : `
                            <div style="
                                width: 140px; height: 140px; border-radius: 50%;
                                background: linear-gradient(45deg, #ff008030, #00ffff30, #ff800030);
                                border: 3px solid #ff0080;
                                display: flex; align-items: center; justify-content: center;
                                color: white; font-size: 3rem; margin: 0 auto 15px;
                            ">âš½</div>
                            `}

                            <h2 style="
                                background: linear-gradient(45deg, #ffffff, #ff0080, #00ffff);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                background-clip: text;
                                font-size: 1.6rem; font-weight: 800; margin: 0 0 20px 0;
                            ">${player.arabicName || player.name}</h2>

                            <!-- Clubs -->
                            <div style="
                                display: flex; align-items: center; justify-content: space-between;
                                background: rgba(255, 255, 255, 0.05);
                                border: 1px solid rgba(255, 255, 255, 0.2);
                                border-radius: 15px; padding: 15px;
                            ">
                                <div style="text-align: center; flex: 1;">
                                    ${player.currentClubLogo ? `
                                    <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                        width: 30px; height: 30px; object-fit: contain; margin-bottom: 5px;
                                    ">` : ''}
                                    <div style="color: white; font-size: 0.8rem;">${player.currentClub}</div>
                                </div>
                                <div style="color: #ff0080; font-size: 1.2rem; font-weight: 900;">â†</div>
                                <div style="text-align: center; flex: 1;">
                                    ${player.targetClubLogo ? `
                                    <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                        width: 30px; height: 30px; object-fit: contain; margin-bottom: 5px;
                                    ">` : ''}
                                    <div style="color: #00ffff; font-size: 0.8rem; font-weight: 600;">${player.targetClub}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            exportCreation() {
                this.exportPlayerData();
            }

            // ðŸŽ¨ UI Helpers
            showCosmicLoader() {
                const placeholder = document.getElementById('previewPlaceholder');
                if (placeholder) {
                    placeholder.innerHTML = `
                        <div class="cosmic-loader">
                            <div style="
                                width: 80px;
                                height: 80px;
                                border: 4px solid rgba(255, 255, 255, 0.1);
                                border-top: 4px solid #00d4ff;
                                border-radius: 50%;
                                animation: cosmicSpin 1s linear infinite;
                                margin: 0 auto 20px;
                            "></div>
                            <h3 style="
                                font-family: 'Orbitron', monospace;
                                color: #00d4ff;
                                margin-bottom: 10px;
                            ">Creating Quantum Visualization</h3>
                            <p style="color: rgba(255, 255, 255, 0.7);">Processing cosmic data...</p>
                        </div>
                        <style>
                            @keyframes cosmicSpin {
                                0% { transform: rotate(0deg); }
                                100% { transform: rotate(360deg); }
                            }
                        </style>
                    `;
                }
            }

            hideCosmicLoader() {
                // Loader will be hidden when visualization is generated
            }

            updateSystemStatus(status) {
                const statusElement = document.getElementById('systemStatus');
                if (statusElement) {
                    statusElement.textContent = status;
                }
            }

            showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `ultimate-notification ${type}`;

                const colors = {
                    success: '#39ff14',
                    error: '#ff0080',
                    warning: '#ffd700',
                    info: '#00d4ff'
                };

                notification.style.cssText = `
                    position: fixed;
                    top: 30px;
                    right: 30px;
                    background: rgba(0, 0, 0, 0.9);
                    backdrop-filter: blur(20px);
                    border: 2px solid ${colors[type]};
                    border-radius: 15px;
                    padding: 20px 25px;
                    color: white;
                    font-weight: 600;
                    z-index: 10000;
                    animation: notificationSlide 0.5s ease-out;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 20px ${colors[type]}30;
                    max-width: 400px;
                    font-family: 'Cairo', sans-serif;
                `;

                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'times' : type === 'warning' ? 'exclamation' : 'info'}-circle"
                           style="color: ${colors[type]}; font-size: 1.2rem;"></i>
                        <span>${message}</span>
                    </div>
                `;

                // Add CSS for animation
                if (!document.getElementById('notificationStyles')) {
                    const style = document.createElement('style');
                    style.id = 'notificationStyles';
                    style.textContent = `
                        @keyframes notificationSlide {
                            0% { transform: translateX(100%); opacity: 0; }
                            100% { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes notificationFadeOut {
                            0% { transform: translateX(0); opacity: 1; }
                            100% { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }

                document.body.appendChild(notification);

                // Auto remove after 4 seconds
                setTimeout(() => {
                    notification.style.animation = 'notificationFadeOut 0.5s ease-out forwards';
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 500);
                }, 4000);

                // Click to dismiss
                notification.addEventListener('click', () => {
                    notification.style.animation = 'notificationFadeOut 0.5s ease-out forwards';
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 500);
                });
            }

            // âš™ï¸ Advanced Settings 2025
            loadSettings() {
                const defaultSettings = {
                    visualTheme: 'cosmic',
                    animationSpeed: 'normal',
                    particleEffects: 'enabled',
                    soundEffects: 'enabled',
                    autoSave: 'enabled',
                    playerImageSize: 150,
                    clubLogoSize: 32,
                    cardTransition: 'fadeIn',
                    transitionDuration: 1.0,
                    lmStudioURL: 'http://localhost:1234'
                };

                try {
                    const saved = localStorage.getItem('ultimateStudio_settings');
                    return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
                } catch (error) {
                    console.warn('ðŸš¨ Error loading settings:', error);
                    return defaultSettings;
                }
            }

            saveSettings() {
                try {
                    // Merge current settings with new values
                    const newSettings = {
                        ...this.settings,
                        visualTheme: document.getElementById('visualTheme')?.value || this.settings.visualTheme || 'cosmic',
                        animationSpeed: document.getElementById('animationSpeed')?.value || this.settings.animationSpeed || 'normal',
                        particleEffects: document.getElementById('particleEffects')?.value || this.settings.particleEffects || 'enabled',
                        soundEffects: document.getElementById('soundEffects')?.value || this.settings.soundEffects || 'enabled',
                        autoSave: document.getElementById('autoSave')?.value || this.settings.autoSave || 'enabled',
                        playerImageSize: document.getElementById('playerImageSize')?.value || this.settings.playerImageSize || 150,
                        clubLogoSize: document.getElementById('clubLogoSize')?.value || this.settings.clubLogoSize || 32,
                        cardTransition: document.getElementById('cardTransition')?.value || this.settings.cardTransition || 'fadeIn',
                        transitionDuration: document.getElementById('transitionDuration')?.value || this.settings.transitionDuration || 1.0,
                        lmStudioURL: document.getElementById('lmStudioURL')?.value || this.settings.lmStudioURL || 'http://localhost:1234'
                    };

                    localStorage.setItem('ultimateStudio_settings', JSON.stringify(newSettings));
                    this.settings = newSettings;

                    this.showNotification('ðŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('ðŸš¨ Error saving settings:', error);
                    this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
                }
            }

            // Safe settings save without applying (to avoid recursion)
            saveSettingsOnly() {
                try {
                    localStorage.setItem('ultimateStudio_settings', JSON.stringify(this.settings));
                } catch (error) {
                    console.error('ðŸš¨ Error saving settings:', error);
                }
            }

            resetSettings() {
                const defaultSettings = {
                    visualTheme: 'cosmic',
                    animationSpeed: 'normal',
                    particleEffects: 'enabled',
                    soundEffects: 'enabled',
                    autoSave: 'enabled'
                };

                // Update UI
                Object.keys(defaultSettings).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = defaultSettings[key];
                    }
                });

                this.settings = defaultSettings;
                this.applySettings();
                this.showNotification('ðŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'info');
            }

            applySettings() {
                // Apply visual theme
                this.changeTheme(this.settings.visualTheme);

                // Apply animation speed
                this.setAnimationSpeed(this.settings.animationSpeed);

                // Apply particle effects
                this.setParticleEffects(this.settings.particleEffects);

                // Apply sound effects
                this.setSoundEffects(this.settings.soundEffects);
            }

            // ðŸŽ® Card Style Management
            changeCardStyle(style) {
                this.currentCardStyle = style;
                this.showNotification(`ðŸŽ® ØªÙ… ØªØºÙŠÙŠØ± Ù†Ù…Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ù„Ù‰ ${this.getCardStyleNameArabic(style)}`, 'success');

                // If there's a current visualization, regenerate it with new style
                if (this.currentPlayer) {
                    this.regenerateWithNewStyle();
                }
            }

            getCardStyleNameArabic(style) {
                const names = {
                    'fifa26': 'ÙÙŠÙØ§ 26',
                    'financial': 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯'
                };
                return names[style] || style;
            }

            async regenerateWithNewStyle() {
                if (!this.currentPlayer) return;

                this.clearPreviewContent();
                this.showProfessionalLoader();

                try {
                    await this.generateVisualizationByStyle(this.currentPlayer);
                } catch (error) {
                    console.error('Error regenerating with new style:', error);
                } finally {
                    this.hideProfessionalLoader();
                }
            }

            async generateVisualizationByStyle(playerData) {
                switch(this.currentCardStyle) {
                    case 'fifa26':
                        await this.generateFIFA26Visualization(playerData);
                        break;
                    case 'financial':
                        await this.generateFinancialVisualization(playerData);
                        break;
                    default:
                        await this.generateFIFA26Visualization(playerData);
                }
            }

            // ðŸŽ¨ Modern Background Theme Management
            changeTheme(theme) {
                console.log(`ðŸŽ¨ Changing theme to: ${theme}`);

                const body = document.body;

                // Remove existing theme classes
                body.classList.remove('theme-cosmic', 'theme-neon', 'theme-holographic', 'theme-quantum', 'theme-futuristic', 'theme-financial', 'theme-matrix', 'theme-cyberpunk');

                // Add new theme class
                body.classList.add(`theme-${theme}`);

                // Save theme to settings
                this.settings.visualTheme = theme;
                this.saveSettingsOnly();

                // Apply modern background styles directly
                this.applyModernBackground(theme);

                // Update the select element
                const themeSelect = document.getElementById('visualTheme');
                if (themeSelect && themeSelect.value !== theme) {
                    themeSelect.value = theme;
                }

                this.showNotification(`ðŸŽ¨ ØªÙ… ØªØºÙŠÙŠØ± Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¥Ù„Ù‰ ${this.getThemeNameArabic(theme)}`, 'success');
            }

            applyModernBackground(theme) {
                console.log(`ðŸŒˆ Applying background theme: ${theme}`);

                const body = document.body;

                // Clean up existing particles and effects
                this.cleanupBackgroundEffects();

                // Remove existing background styles and animations
                body.style.background = '';
                body.style.backgroundImage = '';
                body.style.backgroundAttachment = '';
                body.style.backgroundSize = '';
                body.style.backgroundPosition = '';
                body.style.animation = '';

                // Force immediate application
                setTimeout(() => {
                    switch(theme) {
                    case 'neon':
                        body.style.background = `
                            linear-gradient(45deg, #ff0080 0%, #00d4ff 25%, #39ff14 50%, #ff4500 75%, #ff0080 100%),
                            radial-gradient(circle at 20% 80%, #ff0080 0%, transparent 50%),
                            radial-gradient(circle at 80% 20%, #00d4ff 0%, transparent 50%),
                            radial-gradient(circle at 40% 40%, #39ff14 0%, transparent 50%)
                        `;
                        body.style.backgroundSize = '400% 400%, 100% 100%, 100% 100%, 100% 100%';
                        body.style.animation = 'neonShift 8s ease-in-out infinite';
                        break;

                    case 'holographic':
                        body.style.background = `
                            linear-gradient(124deg, #ff006e, #8338ec, #3a86ff),
                            linear-gradient(45deg, #06ffa5, #ffbe0b, #fb5607),
                            linear-gradient(90deg, #ff006e, transparent, #3a86ff)
                        `;
                        body.style.backgroundSize = '300% 300%, 200% 200%, 100% 100%';
                        body.style.animation = 'holographicShift 12s ease-in-out infinite';
                        break;

                    case 'quantum':
                        body.style.background = `
                            radial-gradient(circle at 25% 25%, #667eea 0%, transparent 50%),
                            radial-gradient(circle at 75% 75%, #764ba2 0%, transparent 50%),
                            linear-gradient(135deg, #f093fb 0%, #f5576c 100%),
                            linear-gradient(45deg, #667eea, #764ba2)
                        `;
                        body.style.backgroundSize = '100% 100%, 100% 100%, 100% 100%, 100% 100%';
                        body.style.animation = 'quantumPulse 10s ease-in-out infinite';
                        break;

                    case 'futuristic':
                        body.style.background = `
                            linear-gradient(45deg, #00c9ff, #92fe9d, #fc00ff, #00dbde),
                            radial-gradient(circle at 30% 70%, #00c9ff 0%, transparent 60%),
                            radial-gradient(circle at 70% 30%, #fc00ff 0%, transparent 60%)
                        `;
                        body.style.backgroundSize = '300% 300%, 100% 100%, 100% 100%';
                        body.style.animation = 'futuristicFlow 15s linear infinite';
                        break;

                    case 'financial':
                        body.style.background = `
                            radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.15) 0%, transparent 50%),
                            radial-gradient(circle at 80% 80%, rgba(0, 255, 127, 0.15) 0%, transparent 50%),
                            radial-gradient(circle at 50% 10%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                            linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%)
                        `;
                        body.style.backgroundSize = '100% 100%, 100% 100%, 100% 100%, 100% 100%';
                        body.style.animation = 'financialFloat 25s ease-in-out infinite';
                        this.createFinancialParticles();
                        break;

                    case 'matrix':
                        body.style.background = `
                            linear-gradient(90deg, transparent 0%, rgba(0, 255, 0, 0.03) 50%, transparent 100%),
                            linear-gradient(0deg, #000000 0%, #001100 100%)
                        `;
                        body.style.backgroundSize = '100px 100%, 100% 100%';
                        body.style.animation = 'matrixRain 20s linear infinite';
                        this.createMatrixEffect();
                        break;

                    case 'cyberpunk':
                        body.style.background = `
                            linear-gradient(45deg, #ff0080 0%, #00d4ff 25%, #ff4500 50%, #39ff14 75%, #ff0080 100%),
                            radial-gradient(circle at 20% 80%, rgba(255, 0, 128, 0.3) 0%, transparent 50%),
                            radial-gradient(circle at 80% 20%, rgba(0, 212, 255, 0.3) 0%, transparent 50%),
                            linear-gradient(135deg, #0a0a0f 0%, #2a0845 100%)
                        `;
                        body.style.backgroundSize = '400% 400%, 100% 100%, 100% 100%, 100% 100%';
                        body.style.animation = 'cyberpunkGlow 12s ease-in-out infinite';
                        break;

                    default: // cosmic
                        body.style.background = `
                            radial-gradient(circle at 20% 80%, #667eea 0%, transparent 50%),
                            radial-gradient(circle at 80% 20%, #764ba2 0%, transparent 50%),
                            radial-gradient(circle at 40% 40%, #f093fb 0%, transparent 50%),
                            linear-gradient(135deg, #0a0a0f 0%, #1a0b2e 100%)
                        `;
                        body.style.backgroundSize = '100% 100%, 100% 100%, 100% 100%, 100% 100%';
                        body.style.animation = 'cosmicDrift 20s ease-in-out infinite';
                }

                    // Add dynamic background animations
                    this.addBackgroundAnimations();

                    console.log(`âœ… Background theme applied: ${theme}`);
                }, 100); // Small delay to ensure proper application
            }

            // Clean up existing background effects
            cleanupBackgroundEffects() {
                // Remove financial particles
                const financialParticles = document.querySelectorAll('.financial-bg-particle');
                financialParticles.forEach(p => p.remove());

                // Remove matrix characters
                const matrixChars = document.querySelectorAll('.matrix-char');
                matrixChars.forEach(m => m.remove());

                // Remove existing styles
                const existingFinancialStyles = document.getElementById('financialBgStyles');
                if (existingFinancialStyles) {
                    existingFinancialStyles.remove();
                }

                const existingMatrixStyles = document.getElementById('matrixStyles');
                if (existingMatrixStyles) {
                    existingMatrixStyles.remove();
                }
            }

            addBackgroundAnimations() {
                // Remove existing animation styles
                const existingStyle = document.getElementById('backgroundAnimations');
                if (existingStyle) {
                    existingStyle.remove();
                }

                // Add new animation styles
                const style = document.createElement('style');
                style.id = 'backgroundAnimations';
                style.textContent = `
                    @keyframes neonShift {
                        0%, 100% { background-position: 0% 50%, 0% 0%, 100% 100%, 50% 50%; }
                        25% { background-position: 100% 50%, 20% 20%, 80% 80%, 30% 70%; }
                        50% { background-position: 100% 100%, 40% 40%, 60% 60%, 70% 30%; }
                        75% { background-position: 0% 100%, 60% 60%, 40% 40%, 80% 80%; }
                    }

                    @keyframes holographicShift {
                        0% { background-position: 0% 0%, 0% 0%, 0% 0%; }
                        33% { background-position: 100% 100%, 50% 50%, 25% 75%; }
                        66% { background-position: 50% 50%, 100% 0%, 75% 25%; }
                        100% { background-position: 0% 0%, 0% 0%, 0% 0%; }
                    }

                    @keyframes quantumPulse {
                        0%, 100% { background-position: 0% 0%, 100% 100%, 0% 0%, 0% 0%; }
                        25% { background-position: 25% 25%, 75% 75%, 25% 25%, 25% 25%; }
                        50% { background-position: 50% 50%, 50% 50%, 50% 50%, 50% 50%; }
                        75% { background-position: 75% 75%, 25% 25%, 75% 75%, 75% 75%; }
                    }

                    @keyframes futuristicFlow {
                        0% { background-position: 0% 0%, 0% 0%, 100% 100%; }
                        50% { background-position: 100% 100%, 50% 50%, 0% 0%; }
                        100% { background-position: 0% 0%, 0% 0%, 100% 100%; }
                    }

                    @keyframes cosmicDrift {
                        0%, 100% { background-position: 0% 0%, 100% 100%, 50% 50%, 0% 0%; }
                        25% { background-position: 25% 25%, 75% 75%, 25% 75%, 25% 25%; }
                        50% { background-position: 50% 50%, 50% 50%, 75% 25%, 50% 50%; }
                        75% { background-position: 75% 75%, 25% 25%, 25% 75%, 75% 75%; }
                    }

                    @keyframes financialFloat {
                        0%, 100% { background-position: 0% 0%, 100% 100%, 50% 50%, 0% 0%; }
                        25% { background-position: 20% 20%, 80% 80%, 30% 70%, 25% 25%; }
                        50% { background-position: 40% 40%, 60% 60%, 70% 30%, 50% 50%; }
                        75% { background-position: 60% 60%, 40% 40%, 20% 80%, 75% 75%; }
                    }

                    @keyframes matrixRain {
                        0% { background-position: 0% 0%, 0% 0%; }
                        100% { background-position: 100% 0%, 0% 100%; }
                    }

                    @keyframes cyberpunkGlow {
                        0%, 100% { background-position: 0% 50%, 0% 0%, 100% 100%, 0% 0%; }
                        25% { background-position: 100% 50%, 20% 20%, 80% 80%, 25% 25%; }
                        50% { background-position: 100% 100%, 40% 40%, 60% 60%, 50% 50%; }
                        75% { background-position: 0% 100%, 60% 60%, 40% 40%, 75% 75%; }
                    }
                `;
                document.head.appendChild(style);
            }

            getThemeNameArabic(theme) {
                const names = {
                    'cosmic': 'ÙƒÙˆÙ†ÙŠ Ø¹ØµØ±ÙŠ',
                    'neon': 'Ù†ÙŠÙˆÙ† Ø³Ø§ÙŠØ¨Ø± Ù…ØªØ­Ø±Ùƒ',
                    'holographic': 'Ù‡ÙˆÙ„ÙˆØ¬Ø±Ø§ÙÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯',
                    'quantum': 'ÙƒÙ…ÙŠ Ù…ØªÙ‚Ø¯Ù… Ù†Ø§Ø¨Ø¶',
                    'futuristic': 'Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ 2025 Ù…ØªØ¯ÙÙ‚',
                    'financial': 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯',
                    'matrix': 'Ù…Ø§ØªØ±ÙŠÙƒØ³ Ø±Ù‚Ù…ÙŠ Ù…ØªØ­Ø±Ùƒ',
                    'cyberpunk': 'Ø³Ø§ÙŠØ¨Ø± Ø¨Ø§Ù†Ùƒ 2077'
                };
                return names[theme] || theme;
            }

            setAnimationSpeed(speed) {
                const root = document.documentElement;

                switch(speed) {
                    case 'slow':
                        root.style.setProperty('--animation-duration', '3s');
                        break;
                    case 'fast':
                        root.style.setProperty('--animation-duration', '0.5s');
                        break;
                    case 'instant':
                        root.style.setProperty('--animation-duration', '0.1s');
                        break;
                    default: // normal
                        root.style.setProperty('--animation-duration', '1s');
                }
            }

            setParticleEffects(setting) {
                // This will be handled in the particle system
                this.particleEffectsSetting = setting;
            }

            setSoundEffects(setting) {
                this.soundEffectsSetting = setting;
            }

            // ðŸ§ª Test Club Logos Function
            async testClubLogos() {
                console.log('ðŸ§ª Testing club logos with real-verified-extractor integration...');

                // Ø£ÙˆÙ„Ø§Ù‹ØŒ ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                const realExtractorData = localStorage.getItem('realExtractor_clubs');
                const arabicMappings = localStorage.getItem('ARABIC_MAPPINGS');

                console.log('ðŸ“Š Data check:');
                console.log(`- Real Extractor Clubs: ${realExtractorData ? 'Found' : 'Not found'}`);
                console.log(`- Arabic Mappings: ${arabicMappings ? 'Found' : 'Not found'}`);

                if (realExtractorData) {
                    try {
                        const clubsData = JSON.parse(realExtractorData);
                        console.log(`ðŸ“ˆ Total clubs in real-verified-extractor: ${clubsData.length}`);

                        // Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 5 Ø£Ù†Ø¯ÙŠØ© ÙƒÙ…Ø«Ø§Ù„
                        console.log('ðŸ“‹ Sample clubs:');
                        clubsData.slice(0, 5).forEach(([id, club]) => {
                            console.log(`  - ${club.englishName} (${club.arabicName}) - Logo: ${club.logoUrl ? 'Yes' : 'No'}`);
                        });
                    } catch (error) {
                        console.error('âŒ Error parsing clubs data:', error);
                    }
                }

                const testClubs = [
                    'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ',
                    'Ù…Ø§Ù† Ø³ÙŠØªÙŠ',
                    'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯',
                    'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©',
                    'Ø§Ù„Ù‡Ù„Ø§Ù„',
                    'Ø§Ù„Ù†ØµØ±',
                    'Ø¨Ø§Ø±ÙŠØ³ Ø³Ø§Ù† Ø¬ÙŠØ±Ù…Ø§Ù†',
                    'Ø¨Ø§ÙŠØ±Ù† Ù…ÙŠÙˆÙ†Ø®'
                ];

                console.log('\nðŸ” Testing logo retrieval:');
                let successCount = 0;
                for (const club of testClubs) {
                    console.log(`\nðŸ” Testing: ${club}`);
                    const logo = await this.getClubLogo(club);
                    if (logo) {
                        console.log(`ðŸ“¸ Result: âœ… Found - ${logo}`);
                        successCount++;
                    } else {
                        console.log(`ðŸ“¸ Result: âŒ Not found`);
                    }
                }

                console.log(`\nðŸ“Š Test Summary: ${successCount}/${testClubs.length} clubs found logos`);
                this.showNotification(`ðŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª: ${successCount}/${testClubs.length} Ù†Ø¬Ø­ - ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…`,
                    successCount > testClubs.length / 2 ? 'success' : 'warning');
            }

            // ðŸ“Š Show Integration Statistics
            async showIntegrationStats() {
                try {
                    console.log('ðŸ“Š Getting integration statistics...');

                    let message = 'ðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„:\n\n';

                    // Get local cache stats
                    if (window.clubLogoIntegration) {
                        const cacheStats = window.clubLogoIntegration.getCacheStats();
                        message += `ðŸ”— Ø§Ù„ØªÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ:\n`;
                        message += `â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø¯ÙŠØ©: ${cacheStats.totalClubs}\n`;
                        message += `â€¢ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø´Ø¹Ø§Ø±Ø§Øª: ${cacheStats.clubsWithLogos}\n`;
                        message += `â€¢ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±Ø§Øª: ${cacheStats.clubsWithoutLogos}\n`;
                        message += `â€¢ Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©: ${cacheStats.lastSyncTime ? new Date(cacheStats.lastSyncTime).toLocaleString('ar') : 'Ù„Ù… ØªØªÙ…'}\n\n`;

                        if (Object.keys(cacheStats.sources).length > 0) {
                            message += `ðŸ“ˆ Ø§Ù„Ù…ØµØ§Ø¯Ø±:\n`;
                            Object.entries(cacheStats.sources).forEach(([source, count]) => {
                                message += `â€¢ ${source}: ${count}\n`;
                            });
                            message += '\n';
                        }
                    }

                    // Get server stats
                    try {
                        const response = await fetch('/api/sync-status');
                        if (response.ok) {
                            const serverStats = await response.json();
                            if (serverStats.success) {
                                const stats = serverStats.data;
                                message += `ðŸŒ Ø§Ù„Ø®Ø§Ø¯Ù…:\n`;
                                message += `â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø¯ÙŠØ©: ${stats.totalClubs}\n`;
                                message += `â€¢ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø´Ø¹Ø§Ø±Ø§Øª: ${stats.clubsWithLogos}\n`;
                                message += `â€¢ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±Ø§Øª: ${stats.clubsWithoutLogos}\n`;
                                message += `â€¢ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${stats.lastUpdated ? new Date(stats.lastUpdated).toLocaleString('ar') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\n\n`;

                                if (Object.keys(stats.sources).length > 0) {
                                    message += `ðŸ“ˆ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø®Ø§Ø¯Ù…:\n`;
                                    Object.entries(stats.sources).forEach(([source, count]) => {
                                        message += `â€¢ ${source}: ${count}\n`;
                                    });
                                }
                            }
                        }
                    } catch (serverError) {
                        message += `âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø®Ø§Ø¯Ù…: ${serverError.message}\n`;
                    }

                    // Show in console and notification
                    console.log(message);
                    this.showNotification('ðŸ“Š ØªÙ… Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'info');

                    // Also show in alert for immediate visibility
                    alert(message);

                } catch (error) {
                    console.error('ðŸš¨ Error getting integration stats:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„', 'error');
                }
            }

            // ðŸ”„ Force Sync with Verified Extractor
            async forceSyncWithExtractor() {
                try {
                    console.log('ðŸ”„ Forcing sync with verified extractor...');

                    if (window.clubLogoIntegration) {
                        await window.clubLogoIntegration.syncWithVerifiedExtractor();
                        this.showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ø³ØªØ®Ø±Ø¬ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', 'success');

                        // Show updated stats
                        setTimeout(() => {
                            this.showIntegrationStats();
                        }, 1000);
                    } else {
                        this.showNotification('âš ï¸ Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø©', 'warning');
                    }

                } catch (error) {
                    console.error('ðŸš¨ Error forcing sync:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù‚Ø³Ø±ÙŠØ©', 'error');
                }
            }

            // ðŸ“Š Show Real-time Sync Statistics
            async showRealTimeSyncStats() {
                try {
                    console.log('ðŸ“Š Getting real-time sync statistics...');

                    let message = 'ðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©:\n\n';

                    if (window.realTimeSync) {
                        const syncStats = window.realTimeSync.getSyncStats();

                        message += `ðŸ”„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©: ${syncStats.isMonitoring ? 'Ù†Ø´Ø·Ø©' : 'Ù…ØªÙˆÙ‚ÙØ©'}\n`;
                        message += `â±ï¸ ÙØªØ±Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©: ${syncStats.syncInterval / 1000} Ø«Ø§Ù†ÙŠØ©\n`;
                        message += `ðŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø§Øª: ${syncStats.totalSyncs}\n`;
                        message += `âœ… Ù…Ø²Ø§Ù…Ù†Ø§Øª Ù†Ø§Ø¬Ø­Ø©: ${syncStats.successfulSyncs}\n`;
                        message += `âŒ Ø£Ø®Ø·Ø§Ø¡: ${syncStats.errors}\n`;
                        message += `ðŸ‘‚ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª: ${syncStats.changeListeners}\n`;
                        message += `ðŸ• Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©: ${syncStats.lastSyncTime ? new Date(syncStats.lastSyncTime).toLocaleString('ar') : 'Ù„Ù… ØªØªÙ…'}\n\n`;

                        // Calculate success rate
                        const successRate = syncStats.totalSyncs > 0 ?
                            ((syncStats.successfulSyncs / syncStats.totalSyncs) * 100).toFixed(1) : 0;
                        message += `ðŸ“Š Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%\n`;

                    } else {
                        message += 'âš ï¸ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­Ø©\n';
                    }

                    // Show in console and notification
                    console.log(message);
                    this.showNotification('ðŸ“Š ØªÙ… Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'info');

                    // Also show in alert for immediate visibility
                    alert(message);

                } catch (error) {
                    console.error('ðŸš¨ Error getting real-time sync stats:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©', 'error');
                }
            }

            // ðŸ”„ Toggle Real-time Monitoring
            toggleRealTimeMonitoring() {
                try {
                    if (window.realTimeSync) {
                        const stats = window.realTimeSync.getSyncStats();

                        if (stats.isMonitoring) {
                            window.realTimeSync.stopMonitoring();
                            this.showNotification('â¸ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©', 'warning');
                        } else {
                            window.realTimeSync.startMonitoring();
                            this.showNotification('â–¶ï¸ ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©', 'success');
                        }
                    } else {
                        this.showNotification('âš ï¸ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­Ø©', 'warning');
                    }
                } catch (error) {
                    console.error('ðŸš¨ Error toggling real-time monitoring:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©', 'error');
                }
            }

            // ðŸ”„ Force Real-time Sync
            async forceRealTimeSync() {
                try {
                    if (window.realTimeSync) {
                        await window.realTimeSync.forceSync();
                        this.showNotification('âœ… ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©', 'success');

                        // Show updated stats
                        setTimeout(() => {
                            this.showRealTimeSyncStats();
                        }, 1000);
                    } else {
                        this.showNotification('âš ï¸ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­Ø©', 'warning');
                    }
                } catch (error) {
                    console.error('ðŸš¨ Error forcing real-time sync:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ© Ø§Ù„Ù‚Ø³Ø±ÙŠØ©', 'error');
                }
            }

            // ðŸ§ª Run Comprehensive System Tests
            async runComprehensiveTests() {
                try {
                    console.log('ðŸ§ª Starting comprehensive system tests...');
                    this.showNotification('ðŸ§ª Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù†Ø¸Ø§Ù…...', 'info');

                    if (window.SystemTester) {
                        const tester = new window.SystemTester();
                        const results = await tester.runComprehensiveTests();

                        // Show results summary
                        const report = tester.generateTestReport();
                        const message = `ðŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©:

ðŸ”¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª: ${report.summary.totalTests}
âœ… Ù†Ø¬Ø­: ${report.summary.passedTests}
âŒ ÙØ´Ù„: ${report.summary.failedTests}
ðŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${report.successRate}%
â±ï¸ Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${report.summary.averageResponseTime.toFixed(2)}ms

ðŸ“‹ Ø§Ù„ÙØ¦Ø§Øª:
${Object.entries(report.categories).map(([category, stats]) =>
    `â€¢ ${category}: ${stats.passed}/${stats.total} (${(stats.passed/stats.total*100).toFixed(1)}%)`
).join('\n')}`;

                        console.log(message);
                        alert(message);

                        this.showNotification(`âœ… Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª - Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${report.successRate}%`, 'success');

                        return results;
                    } else {
                        this.showNotification('âš ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØºÙŠØ± Ù…ØªØ§Ø­', 'warning');
                    }
                } catch (error) {
                    console.error('ðŸš¨ Error running comprehensive tests:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©', 'error');
                }
            }

            // âš¡ Run Quick System Test
            async runQuickTest() {
                try {
                    console.log('âš¡ Starting quick system test...');
                    this.showNotification('âš¡ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹...', 'info');

                    if (window.SystemTester) {
                        const tester = new window.SystemTester();
                        const results = await tester.runQuickTest();

                        const passedTests = results.filter(r => r.searchPassed && r.logoPassed).length;
                        const totalTests = results.length;
                        const successRate = (passedTests / totalTests * 100).toFixed(1);

                        const message = `âš¡ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹:

âœ… Ù†Ø¬Ø­: ${passedTests}/${totalTests} (${successRate}%)

ðŸ“‹ Ø§Ù„ØªÙØ§ØµÙŠÙ„:
${results.map(r =>
    `â€¢ ${r.club}: ${r.searchPassed ? 'âœ…' : 'âŒ'} Ø¨Ø­Ø« | ${r.logoPassed ? 'âœ…' : 'âŒ'} Ø´Ø¹Ø§Ø±`
).join('\n')}`;

                        console.log(message);
                        alert(message);

                        this.showNotification(`âš¡ Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹ - Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%`,
                            successRate > 80 ? 'success' : successRate > 60 ? 'warning' : 'error');

                        return results;
                    } else {
                        this.showNotification('âš ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØºÙŠØ± Ù…ØªØ§Ø­', 'warning');
                    }
                } catch (error) {
                    console.error('ðŸš¨ Error running quick test:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹', 'error');
                }
            }

            // ðŸ“Š Show System Health Status
            async showSystemHealthStatus() {
                try {
                    console.log('ðŸ“Š Checking system health...');

                    let healthReport = 'ðŸ“Š ØªÙ‚Ø±ÙŠØ± ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:\n\n';
                    let overallHealth = 100;

                    // Check integration service
                    if (window.clubLogoIntegration) {
                        const cacheStats = window.clubLogoIntegration.getCacheStats();
                        healthReport += `ðŸ”— Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„: âœ… Ù†Ø´Ø·Ø©\n`;
                        healthReport += `   â€¢ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©: ${cacheStats.totalClubs}\n`;
                        healthReport += `   â€¢ Ø£Ù†Ø¯ÙŠØ© Ø¨Ø´Ø¹Ø§Ø±Ø§Øª: ${cacheStats.clubsWithLogos}\n`;
                        healthReport += `   â€¢ Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©: ${cacheStats.lastSyncTime ? new Date(cacheStats.lastSyncTime).toLocaleString('ar') : 'Ù„Ù… ØªØªÙ…'}\n\n`;
                    } else {
                        healthReport += `ðŸ”— Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙƒØ§Ù…Ù„: âŒ ØºÙŠØ± Ù†Ø´Ø·Ø©\n\n`;
                        overallHealth -= 30;
                    }

                    // Check real-time sync
                    if (window.realTimeSync) {
                        const syncStats = window.realTimeSync.getSyncStats();
                        healthReport += `âš¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©: ${syncStats.isMonitoring ? 'âœ…' : 'âš ï¸'} ${syncStats.isMonitoring ? 'Ù†Ø´Ø·Ø©' : 'Ù…ØªÙˆÙ‚ÙØ©'}\n`;
                        healthReport += `   â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø§Øª: ${syncStats.totalSyncs}\n`;
                        healthReport += `   â€¢ Ù…Ø²Ø§Ù…Ù†Ø§Øª Ù†Ø§Ø¬Ø­Ø©: ${syncStats.successfulSyncs}\n`;
                        healthReport += `   â€¢ Ø£Ø®Ø·Ø§Ø¡: ${syncStats.errors}\n\n`;

                        if (!syncStats.isMonitoring) overallHealth -= 20;
                        if (syncStats.errors > 0) overallHealth -= 10;
                    } else {
                        healthReport += `âš¡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©: âŒ ØºÙŠØ± Ù…ØªØ§Ø­Ø©\n\n`;
                        overallHealth -= 25;
                    }

                    // Check API connectivity
                    try {
                        const response = await fetch('/api/sync-status');
                        if (response.ok) {
                            healthReport += `ðŸŒ Ø§ØªØµØ§Ù„ API: âœ… Ù…ØªØµÙ„\n`;
                            const data = await response.json();
                            if (data.success) {
                                healthReport += `   â€¢ Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø®Ø§Ø¯Ù…: ${data.data.totalClubs}\n`;
                            }
                        } else {
                            healthReport += `ðŸŒ Ø§ØªØµØ§Ù„ API: âš ï¸ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„\n`;
                            overallHealth -= 15;
                        }
                    } catch (error) {
                        healthReport += `ðŸŒ Ø§ØªØµØ§Ù„ API: âŒ ØºÙŠØ± Ù…ØªØµÙ„\n`;
                        overallHealth -= 25;
                    }

                    healthReport += `\nðŸ“ˆ Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø©: ${overallHealth}%\n`;

                    if (overallHealth >= 90) {
                        healthReport += `ðŸŸ¢ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ù…ØªØ§Ø²`;
                    } else if (overallHealth >= 70) {
                        healthReport += `ðŸŸ¡ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯ Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©`;
                    } else if (overallHealth >= 50) {
                        healthReport += `ðŸŸ  Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ù…Ø´Ø§ÙƒÙ„ Ù…ØªÙˆØ³Ø·Ø©`;
                    } else {
                        healthReport += `ðŸ”´ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥ØµÙ„Ø§Ø­ ÙÙˆØ±ÙŠ`;
                    }

                    console.log(healthReport);
                    alert(healthReport);

                    const notificationType = overallHealth >= 80 ? 'success' : overallHealth >= 60 ? 'warning' : 'error';
                    this.showNotification(`ðŸ“Š ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…: ${overallHealth}%`, notificationType);

                } catch (error) {
                    console.error('ðŸš¨ Error checking system health:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…', 'error');
                }
            }

            // ðŸ”— Test Direct Connection with Real-Verified-Extractor
            async testDirectConnection() {
                try {
                    console.log('ðŸ”— Testing direct connection with real-verified-extractor...');
                    this.showNotification('ðŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...', 'info');

                    // ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                    const realExtractorData = localStorage.getItem('realExtractor_clubs');
                    const arabicMappings = localStorage.getItem('ARABIC_MAPPINGS');

                    let report = 'ðŸ”— ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:\n\n';

                    if (!realExtractorData) {
                        report += 'âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† real-verified-extractor\n';
                        report += 'ðŸ’¡ ØªØ£ÙƒØ¯ Ù…Ù† ÙØªØ­ http://localhost:8201/real-verified-extractor-fixed.html ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹\n\n';
                    } else {
                        try {
                            const clubsData = JSON.parse(realExtractorData);
                            report += `âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${clubsData.length} Ù†Ø§Ø¯ÙŠ\n`;

                            // Ø¹Ø¯ Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„ØªÙŠ Ù„Ø¯ÙŠÙ‡Ø§ Ø´Ø¹Ø§Ø±Ø§Øª
                            let clubsWithLogos = 0;
                            let sampleClubs = [];

                            clubsData.slice(0, 10).forEach(([id, club]) => {
                                if (club.logoUrl) clubsWithLogos++;
                                sampleClubs.push(`${club.englishName} (${club.arabicName})`);
                            });

                            report += `ðŸ† Ø£Ù†Ø¯ÙŠØ© Ø¨Ø´Ø¹Ø§Ø±Ø§Øª: ${clubsWithLogos}/10 Ù…Ù† Ø§Ù„Ø¹ÙŠÙ†Ø©\n`;
                            report += `ðŸ“‹ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø£Ù†Ø¯ÙŠØ©:\n${sampleClubs.slice(0, 5).map(club => `  â€¢ ${club}`).join('\n')}\n\n`;

                        } catch (error) {
                            report += `âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}\n\n`;
                        }
                    }

                    if (!arabicMappings) {
                        report += 'âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ±Ø¬Ù…Ø§Øª Ø¹Ø±Ø¨ÙŠØ© Ù…Ø­ÙÙˆØ¸Ø©\n';
                    } else {
                        try {
                            const mappings = JSON.parse(arabicMappings);
                            report += `âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${Object.keys(mappings).length} ØªØ±Ø¬Ù…Ø© Ø¹Ø±Ø¨ÙŠØ©\n\n`;
                        } catch (error) {
                            report += `âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª: ${error.message}\n\n`;
                        }
                    }

                    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                    report += 'ðŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:\n';
                    const testClubs = ['Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯', 'Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©', 'Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠ', 'Ø§Ù„Ù‡Ù„Ø§Ù„'];
                    let foundCount = 0;

                    for (const clubName of testClubs) {
                        const logo = await this.getClubLogo(clubName);
                        if (logo) {
                            report += `  âœ… ${clubName}: ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø±\n`;
                            foundCount++;
                        } else {
                            report += `  âŒ ${clubName}: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¹Ø§Ø±\n`;
                        }
                    }

                    report += `\nðŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${foundCount}/${testClubs.length} Ø£Ù†Ø¯ÙŠØ© ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø´Ø¹Ø§Ø±Ø§ØªÙ‡Ø§\n`;

                    if (foundCount === 0) {
                        report += '\nðŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù„Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:\n';
                        report += '1. Ø§ÙØªØ­ real-verified-extractor-fixed.html\n';
                        report += '2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø°ÙƒÙŠ"\n';
                        report += '3. Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø£Ù†Ø¯ÙŠØ©\n';
                        report += '4. Ø¹Ø¯ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ÙˆØ¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰\n';
                    }

                    console.log(report);
                    alert(report);

                    const notificationType = foundCount > testClubs.length / 2 ? 'success' :
                                           foundCount > 0 ? 'warning' : 'error';
                    this.showNotification(`ðŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø¨Ø·: ${foundCount}/${testClubs.length} Ù†Ø¬Ø­`, notificationType);

                } catch (error) {
                    console.error('ðŸš¨ Error testing direct connection:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'error');
                }
            }

            // ðŸŽ® Create Test Player with Guaranteed Logos
            async createTestPlayer() {
                console.log('ðŸŽ® Creating test player with guaranteed logos...');

                this.showProfessionalLoader();

                // Create test player data with guaranteed logos
                const testPlayerData = {
                    arabicName: 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­',
                    englishName: 'Mohamed Salah',
                    currentClub: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„',
                    targetClub: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯',
                    imageUrl: 'https://img.a.transfermarkt.technology/portrait/big/148455-1694609670.jpg?lm=1',
                    currentClubLogo: await this.getClubLogo('Ù„ÙŠÙØ±Ø¨ÙˆÙ„'),
                    targetClubLogo: await this.getClubLogo('Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯'),
                    probability: {
                        percentage: 75,
                        display: '75%',
                        factors: ['Ù†Ø¬Ù… Ø¹Ø§Ù„Ù…ÙŠ', 'Ø¹Ù‚Ø¯ ÙŠÙ†ØªÙ‡ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'Ø§Ù‡ØªÙ…Ø§Ù… Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯'],
                        confidence: 'Ø¹Ø§Ù„ÙŠØ©',
                        trend: 'Ù…Ø­ØªÙ…Ù„ Ø¬Ø¯Ø§Ù‹'
                    },
                    position: 'RW',
                    age: 32,
                    marketValue: 'â‚¬60M',
                    contractExpiry: '2025',
                    nationality: 'Ù…ØµØ±',
                    height: '175 Ø³Ù…',
                    foot: 'Ø£ÙŠØ³Ø±',
                    rating: 89,
                    allRumors: []
                };

                console.log('ðŸ† Test player data with logos:', testPlayerData);

                // Store as current player
                this.currentPlayer = testPlayerData;

                // Generate FIFA 26 visualization
                const visualizationHTML = this.createFIFA26CardHTML(testPlayerData);
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                if (placeholder) {
                    placeholder.style.display = 'none';
                }

                previewContent.innerHTML = visualizationHTML;

                // Initialize effects
                this.initializeParticleEffects();
                this.startFIFAAnimations();
                this.playCreationSound();

                this.hideProfessionalLoader();
                this.showNotification('ðŸŽ® ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù„Ø§Ø¹Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ø¹ Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ø¶Ù…ÙˆÙ†Ø©!', 'success');
            }

            // ðŸ’° Create Financial Particles for Background
            createFinancialParticles() {
                // Remove existing particles
                const existingParticles = document.querySelectorAll('.financial-bg-particle');
                existingParticles.forEach(p => p.remove());

                const body = document.body;
                const symbols = ['$', 'â‚¬', 'Â£', 'Â¥', 'â‚¹', '%', 'âˆ‘', 'âˆ†', 'âˆž', 'Â±'];

                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'financial-bg-particle';
                    particle.style.cssText = `
                        position: fixed;
                        font-size: ${Math.random() * 30 + 15}px;
                        color: rgba(255, 215, 0, ${Math.random() * 0.3 + 0.1});
                        pointer-events: none;
                        z-index: 1;
                        left: ${Math.random() * 100}vw;
                        top: ${Math.random() * 100}vh;
                        animation: financialBgFloat ${Math.random() * 20 + 30}s linear infinite;
                        animation-delay: ${Math.random() * 10}s;
                    `;
                    particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    body.appendChild(particle);
                }

                // Add CSS for financial particles
                if (!document.getElementById('financialBgStyles')) {
                    const style = document.createElement('style');
                    style.id = 'financialBgStyles';
                    style.textContent = `
                        @keyframes financialBgFloat {
                            0% {
                                transform: translateY(0px) rotate(0deg);
                                opacity: 0;
                            }
                            10% {
                                opacity: 1;
                            }
                            90% {
                                opacity: 1;
                            }
                            100% {
                                transform: translateY(-100vh) rotate(360deg);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            // ðŸ”¢ Create Matrix Effect
            createMatrixEffect() {
                // Remove existing matrix
                const existingMatrix = document.querySelectorAll('.matrix-char');
                existingMatrix.forEach(m => m.remove());

                const body = document.body;
                const chars = '01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒŽãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒžãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ²ãƒ³';

                for (let i = 0; i < 50; i++) {
                    const char = document.createElement('div');
                    char.className = 'matrix-char';
                    char.style.cssText = `
                        position: fixed;
                        font-family: 'Courier New', monospace;
                        font-size: ${Math.random() * 20 + 10}px;
                        color: rgba(0, 255, 0, ${Math.random() * 0.8 + 0.2});
                        pointer-events: none;
                        z-index: 1;
                        left: ${Math.random() * 100}vw;
                        top: -50px;
                        animation: matrixFall ${Math.random() * 10 + 5}s linear infinite;
                        animation-delay: ${Math.random() * 5}s;
                    `;
                    char.textContent = chars[Math.floor(Math.random() * chars.length)];
                    body.appendChild(char);
                }

                // Add CSS for matrix effect
                if (!document.getElementById('matrixStyles')) {
                    const style = document.createElement('style');
                    style.id = 'matrixStyles';
                    style.textContent = `
                        @keyframes matrixFall {
                            0% {
                                transform: translateY(-50px);
                                opacity: 0;
                            }
                            10% {
                                opacity: 1;
                            }
                            90% {
                                opacity: 1;
                            }
                            100% {
                                transform: translateY(100vh);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            initializeManualMode() {
                console.log('âœï¸ Manual mode initialized');
            }

            // ðŸŽ­ Multi Players Mode
            initializeMultiMode() {
                console.log('ðŸ‘¥ Multi players mode initialized');
                this.setupMultiDisplayMode();
                // Reset sequence settings visibility
                this.toggleSequenceSettings('all');
            }

            // Toggle sequence settings visibility
            toggleSequenceSettings(mode) {
                const sequenceSettings = document.getElementById('sequenceSettings');
                if (sequenceSettings) {
                    if (mode === 'sequence') {
                        sequenceSettings.style.display = 'block';
                        sequenceSettings.style.animation = 'slideInRight 0.5s ease-out';
                    } else {
                        sequenceSettings.style.display = 'none';
                    }
                }
            }

            setupMultiDisplayMode() {
                const displayMode = document.getElementById('multiDisplayMode');
                const sequenceSettings = document.getElementById('sequenceSettings');

                displayMode.addEventListener('change', (e) => {
                    if (e.target.value === 'sequence') {
                        sequenceSettings.style.display = 'block';
                    } else {
                        sequenceSettings.style.display = 'none';
                    }
                });
            }

            addMultiPlayer() {
                const container = document.getElementById('multiPlayersContainer');
                const playerCount = container.children.length;

                if (playerCount >= 10) {
                    this.showNotification('ðŸš¨ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù„Ø§Ø¹Ø¨ÙŠÙ†', 'warning');
                    return;
                }

                const playerDiv = document.createElement('div');
                playerDiv.className = 'multi-player-input';
                playerDiv.style.cssText = `
                    background: rgba(255, 255, 255, 0.05);
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 15px;
                    transition: all 0.3s ease;
                    animation: slideInRight 0.5s ease-out;
                `;

                playerDiv.innerHTML = `
                    <div class="player-header" style="
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        margin-bottom: 15px;
                        color: #00d4ff;
                        font-weight: 600;
                    ">
                        <div>
                            <i class="fas fa-user-circle" style="margin-left: 10px; font-size: 1.2rem;"></i>
                            Ø§Ù„Ù„Ø§Ø¹Ø¨ ${playerCount + 1}
                        </div>
                        <button type="button" onclick="ultimateStudio.removeSpecificPlayer(this)" style="
                            background: linear-gradient(135deg, #ff4757, #ff3838);
                            border: none;
                            border-radius: 50%;
                            width: 30px;
                            height: 30px;
                            color: white;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Player Name -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input multi-player-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
                        <i class="fas fa-user input-icon"></i>
                    </div>

                    <!-- Current Club -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input multi-player-current-club"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
                               autocomplete="off"
                               oninput="ultimateStudio.handleMultiClubInput(this, 'current')"
                               onfocus="ultimateStudio.showMultiClubSuggestions(this, 'current')"
                               onblur="ultimateStudio.hideMultiClubSuggestions(this, 'current')">
                        <i class="fas fa-shield-alt input-icon"></i>
                        <div class="club-suggestions-container multi-club-suggestions"></div>
                        <div class="club-logo-preview multi-club-logo-preview"></div>
                    </div>

                    <!-- Target Club -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input multi-player-target-club"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
                               autocomplete="off"
                               oninput="ultimateStudio.handleMultiClubInput(this, 'target')"
                               onfocus="ultimateStudio.showMultiClubSuggestions(this, 'target')"
                               onblur="ultimateStudio.hideMultiClubSuggestions(this, 'target')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container multi-club-suggestions"></div>
                        <div class="club-logo-preview multi-club-logo-preview"></div>
                    </div>

                    <!-- Player Image URL -->
                    <div class="ultimate-input-group">
                        <input type="url" class="ultimate-input multi-player-image" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                        <i class="fas fa-image input-icon"></i>
                    </div>
                `;

                container.appendChild(playerDiv);
                this.showNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ ${playerCount + 1}`, 'success');
            }

            removeMultiPlayer() {
                const container = document.getElementById('multiPlayersContainer');
                const playerCount = container.children.length;

                if (playerCount <= 1) {
                    this.showNotification('ðŸš¨ ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù„Ø§Ø¹Ø¨ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                    return;
                }

                container.removeChild(container.lastElementChild);
                this.updatePlayerNumbers();
                this.showNotification(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨`, 'success');
            }

            removeSpecificPlayer(button) {
                const container = document.getElementById('multiPlayersContainer');
                const playerCount = container.children.length;

                if (playerCount <= 1) {
                    this.showNotification('ðŸš¨ ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù„Ø§Ø¹Ø¨ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                    return;
                }

                const playerDiv = button.closest('.multi-player-input');
                playerDiv.style.animation = 'slideOutLeft 0.3s ease-in';

                setTimeout(() => {
                    container.removeChild(playerDiv);
                    this.updatePlayerNumbers();
                    this.showNotification(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨`, 'success');
                }, 300);
            }

            updatePlayerNumbers() {
                const container = document.getElementById('multiPlayersContainer');
                const players = container.children;

                Array.from(players).forEach((player, index) => {
                    const header = player.querySelector('.player-header div');
                    if (header) {
                        header.innerHTML = `
                            <i class="fas fa-user-circle" style="margin-left: 10px; font-size: 1.2rem;"></i>
                            Ø§Ù„Ù„Ø§Ø¹Ø¨ ${index + 1}
                        `;
                    }
                });
            }

            // Initialize multi-player section with mixed mode
            initializeMultiMode() {
                const container = document.getElementById('multiPlayersContainer');
                if (!container) return;

                // Clear existing players
                container.innerHTML = '';

                // Add first manual player by default
                this.addManualMultiPlayer();

                this.showNotification('ðŸ”„ Ù†Ù…Ø· Ù…Ø®ØªÙ„Ø· Ø¬Ø§Ù‡Ø² - ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†', 'success');
            }

            // Add manual input player
            addManualMultiPlayer() {
                const container = document.getElementById('multiPlayersContainer');
                const playerCount = container.children.length;

                if (playerCount >= 10) {
                    this.showNotification('ðŸš¨ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù„Ø§Ø¹Ø¨ÙŠÙ†', 'warning');
                    return;
                }

                const playerDiv = document.createElement('div');
                playerDiv.className = 'multi-player-input';
                playerDiv.style.cssText = `
                    background: rgba(255, 255, 255, 0.05);
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 15px;
                    transition: all 0.3s ease;
                    animation: slideInRight 0.5s ease-out;
                `;

                playerDiv.innerHTML = `
                    <div class="player-header" style="
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        margin-bottom: 15px;
                        color: #00d4ff;
                        font-weight: 600;
                    ">
                        <div>
                            <i class="fas fa-edit" style="margin-left: 10px; font-size: 1.2rem; color: #00d4ff;"></i>
                            Ø§Ù„Ù„Ø§Ø¹Ø¨ ${playerCount + 1} - Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ
                        </div>
                        <button type="button" onclick="ultimateStudio.removeSpecificPlayer(this)" style="
                            background: linear-gradient(135deg, #ff4757, #ff3838);
                            border: none;
                            border-radius: 50%;
                            width: 30px;
                            height: 30px;
                            color: white;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Player Name -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input multi-player-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
                        <i class="fas fa-user input-icon"></i>
                    </div>

                    <!-- Current Club -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input multi-player-current-club"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
                               autocomplete="off"
                               oninput="ultimateStudio.handleMultiClubInput(this, 'current')"
                               onfocus="ultimateStudio.showMultiClubSuggestions(this, 'current')"
                               onblur="ultimateStudio.hideMultiClubSuggestions(this, 'current')">
                        <i class="fas fa-shield-alt input-icon"></i>
                        <div class="club-suggestions-container multi-club-suggestions"></div>
                        <div class="club-logo-preview multi-club-logo-preview"></div>
                    </div>

                    <!-- Target Club -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input multi-player-target-club"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
                               autocomplete="off"
                               oninput="ultimateStudio.handleMultiClubInput(this, 'target')"
                               onfocus="ultimateStudio.showMultiClubSuggestions(this, 'target')"
                               onblur="ultimateStudio.hideMultiClubSuggestions(this, 'target')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container multi-club-suggestions"></div>
                        <div class="club-logo-preview multi-club-logo-preview"></div>
                    </div>

                    <!-- Player Image URL -->
                    <div class="ultimate-input-group">
                        <input type="url" class="ultimate-input multi-player-image" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                        <i class="fas fa-image input-icon"></i>
                    </div>
                `;

                container.appendChild(playerDiv);
                this.showNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ ÙŠØ¯ÙˆÙŠ ${playerCount + 1}`, 'success');
            }

            // Add saved player selection
            async addSavedMultiPlayer() {
                const container = document.getElementById('multiPlayersContainer');
                const playerCount = container.children.length;

                if (playerCount >= 10) {
                    this.showNotification('ðŸš¨ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù„Ø§Ø¹Ø¨ÙŠÙ†', 'warning');
                    return;
                }

                // Load saved players if not already loaded
                await this.loadSavedPlayers();

                const playerDiv = document.createElement('div');
                playerDiv.className = 'multi-player-input';
                playerDiv.style.cssText = `
                    background: rgba(0, 212, 255, 0.05);
                    border: 2px solid rgba(0, 212, 255, 0.3);
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 15px;
                    transition: all 0.3s ease;
                    animation: slideInRight 0.5s ease-out;
                `;

                // Get saved players list
                const savedPlayersSelect = document.getElementById('savedPlayersList');
                const savedPlayersOptions = savedPlayersSelect ? savedPlayersSelect.innerHTML : '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø­ÙÙˆØ¸ÙŠÙ†</option>';

                playerDiv.innerHTML = `
                    <div class="player-header" style="
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        margin-bottom: 15px;
                        color: #00d4ff;
                        font-weight: 600;
                    ">
                        <div>
                            <i class="fas fa-database" style="margin-left: 10px; font-size: 1.2rem; color: #00d4ff;"></i>
                            Ø§Ù„Ù„Ø§Ø¹Ø¨ ${playerCount + 1} - Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†
                        </div>
                        <button type="button" onclick="ultimateStudio.removeSpecificPlayer(this)" style="
                            background: linear-gradient(135deg, #ff4757, #ff3838);
                            border: none;
                            border-radius: 50%;
                            width: 30px;
                            height: 30px;
                            color: white;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Saved Player Selection -->
                    <div class="ultimate-input-group">
                        <select class="ultimate-select multi-saved-player" onchange="ultimateStudio.loadSelectedSavedPlayer(this)">
                            ${savedPlayersOptions}
                        </select>
                        <i class="fas fa-database input-icon"></i>
                    </div>

                    <!-- Target Club -->
                    <div class="ultimate-input-group">
                        <input type="text" class="ultimate-input smart-club-input multi-player-target-club"
                               placeholder="Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
                               autocomplete="off"
                               oninput="ultimateStudio.handleMultiClubInput(this, 'target')"
                               onfocus="ultimateStudio.showMultiClubSuggestions(this, 'target')"
                               onblur="ultimateStudio.hideMultiClubSuggestions(this, 'target')">
                        <i class="fas fa-bullseye input-icon"></i>
                        <div class="club-suggestions-container multi-club-suggestions"></div>
                        <div class="club-logo-preview multi-club-logo-preview"></div>
                    </div>

                    <!-- Hidden fields for player data -->
                    <input type="hidden" class="multi-player-name" value="">
                    <input type="hidden" class="multi-player-current-club" value="">
                    <input type="hidden" class="multi-player-image" value="">
                `;

                container.appendChild(playerDiv);
                this.showNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ† ${playerCount + 1}`, 'success');
            }

            // Load selected saved player data into multi-player form
            async loadSelectedSavedPlayer(selectElement) {
                const selectedValue = selectElement.value;
                if (!selectedValue) return;

                try {
                    const player = JSON.parse(selectedValue);
                    const playerContainer = selectElement.closest('.multi-player-input');

                    // Update hidden fields
                    playerContainer.querySelector('.multi-player-name').value = player.arabicName || player.name || '';
                    playerContainer.querySelector('.multi-player-current-club').value = player.currentClub || '';
                    playerContainer.querySelector('.multi-player-image').value = player.playerImage || player.imageUrl || '';

                    // Update header to show selected player with image
                    const header = playerContainer.querySelector('.player-header div');
                    if (header) {
                        const playerImageUrl = player.playerImage || player.imageUrl || this.getFallbackImageUrl(player.arabicName || player.name);
                        header.innerHTML = `
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <img src="${playerImageUrl}"
                                     alt="${player.arabicName || player.name}"
                                     style="
                                        width: 40px;
                                        height: 40px;
                                        border-radius: 50%;
                                        border: 2px solid #00d4ff;
                                        object-fit: cover;
                                        box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
                                     "
                                     onerror="this.src='${this.getFallbackImageUrl(player.arabicName || player.name)}'">
                                <div>
                                    <div style="color: #00d4ff; font-weight: 700;">
                                        <i class="fas fa-database" style="margin-left: 8px;"></i>
                                        ${player.arabicName || player.name}
                                    </div>
                                    <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; margin-top: 2px;">
                                        ${player.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} - Ù…Ø­ÙÙˆØ¸
                                    </div>
                                </div>
                            </div>
                        `;
                    }

                    this.showNotification(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${player.arabicName || player.name} Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸ÙŠÙ†`, 'success');
                } catch (error) {
                    console.error('Error loading saved player:', error);
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨', 'error');
                }
            }

            // Legacy function - now defaults to manual
            addMultiPlayer() {
                this.addManualMultiPlayer();
            }

            // Generic function for adding multi-player input (used by import system)
            addMultiPlayerInput() {
                this.addManualMultiPlayer();
            }

            // Update image size display and apply to all modes
            updateImageSizeDisplay(value) {
                document.getElementById('imageSizeValue').textContent = value;
                this.settings.playerImageSize = value;
                this.saveSettings();

                // Apply to all existing images in all modes
                const allImages = document.querySelectorAll('img[alt*="Ø§Ù„Ù„Ø§Ø¹Ø¨"], img[src*="player"], .player-image, img[style*="border-radius: 50%"]');
                allImages.forEach(img => {
                    // Skip very small images (like icons)
                    const currentWidth = parseInt(img.style.width) || img.offsetWidth;
                    if (currentWidth > 50) {
                        img.style.width = value + 'px';
                        img.style.height = value + 'px';
                        img.style.transition = 'all 0.3s ease';
                    }
                });

                // Show visual feedback
                this.showNotification(`ðŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± Ø¥Ù„Ù‰ ${value}px`, 'success');

                // Force OBS refresh for live streaming
                this.forceOBSRefresh();

                // Auto-sync with stream if active
                this.autoSyncWithStream();
            }

            // Unified logo size update - applies to all club logos intelligently
            updateUnifiedLogoSize(value) {
                document.getElementById('logoSizeValue').textContent = value;
                this.settings.clubLogoSize = parseInt(value);
                this.saveSettings();

                // Calculate proportional sizes for different contexts
                const baseSize = parseInt(value);
                const smallSize = Math.max(16, baseSize - 8);  // For small contexts
                const mediumSize = baseSize;                   // For normal contexts
                const largeSize = Math.min(80, baseSize + 20); // For large contexts

                // COMPREHENSIVE SEARCH: Find ALL possible club logos
                const logoSelectors = [
                    'img[src*="logo"]',
                    'img[src*="crest"]',
                    'img[src*="badge"]',
                    'img[alt*="Ø§Ù„Ù†Ø§Ø¯ÙŠ"]',
                    'img[alt*="Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"]',
                    'img[alt*="club"]',
                    'img[alt*="Club"]',
                    'img[alt*="logo"]',
                    'img[alt*="Logo"]'
                ];

                let totalLogosFound = 0;

                logoSelectors.forEach(selector => {
                    const logos = document.querySelectorAll(selector);
                    console.log(`ðŸ” Selector "${selector}" found ${logos.length} logos`);

                    logos.forEach((img, index) => {
                        // Skip if it's clearly a player image (circular or very large)
                        const isPlayerImage = img.style.borderRadius === '50%' ||
                                            img.classList.contains('player-image') ||
                                            (img.offsetWidth > 100 && img.offsetHeight > 100);

                        if (!isPlayerImage) {
                            let targetSize = mediumSize;

                            // Determine context and apply appropriate size
                            if (img.closest('.target-club-logo-large')) {
                                targetSize = largeSize;
                            } else if (img.classList.contains('club-logo-small') || img.closest('.card-footer')) {
                                targetSize = smallSize;
                            } else if (img.classList.contains('target-club-logo') || img.alt?.includes('Ø§Ù„Ù…Ø·Ù„ÙˆØ¨')) {
                                targetSize = mediumSize + 4;
                            }

                            // Apply the size with important flag to override any existing styles
                            img.style.setProperty('width', targetSize + 'px', 'important');
                            img.style.setProperty('height', targetSize + 'px', 'important');
                            img.style.setProperty('transition', 'all 0.3s ease', 'important');

                            totalLogosFound++;
                            console.log(`ðŸ† Logo ${totalLogosFound}: ${img.alt || img.src.split('/').pop() || 'Unknown'} â†’ ${targetSize}px`);
                        }
                    });
                });

                // FORCE UPDATE: Also update any logos in preview content with force
                const previewContent = document.getElementById('previewContent');
                if (previewContent) {
                    const previewLogos = previewContent.querySelectorAll('img');
                    let previewLogosUpdated = 0;

                    previewLogos.forEach(img => {
                        const src = img.src.toLowerCase();
                        const alt = (img.alt || '').toLowerCase();

                        // Check if it's a club logo
                        if (src.includes('logo') || src.includes('crest') || src.includes('badge') ||
                            alt.includes('Ù†Ø§Ø¯ÙŠ') || alt.includes('club') || alt.includes('logo')) {

                            img.style.setProperty('width', mediumSize + 'px', 'important');
                            img.style.setProperty('height', mediumSize + 'px', 'important');
                            img.style.setProperty('transition', 'all 0.3s ease', 'important');
                            previewLogosUpdated++;
                        }
                    });
                    console.log(`ðŸ“º FORCE UPDATED ${previewLogosUpdated} logos in preview content`);
                }

                // Update CSS custom properties for dynamic sizing
                document.documentElement.style.setProperty('--club-logo-size', mediumSize + 'px');
                document.documentElement.style.setProperty('--club-logo-small', smallSize + 'px');
                document.documentElement.style.setProperty('--club-logo-large', largeSize + 'px');

                // Update settings for backward compatibility
                this.settings.targetClubLogoSize = mediumSize + 4;
                this.settings.targetClubLogoLargeSize = largeSize;

                // Show visual feedback with size breakdown
                this.showNotification(`ðŸ† ØªÙ… ØªØ­Ø¯ÙŠØ« ${totalLogosFound} Ø´Ø¹Ø§Ø± - Ø§Ù„Ø­Ø¬Ù…: ${mediumSize}px`, 'info');

                // Force OBS refresh for live streaming
                this.forceOBSRefresh();

                // Auto-sync with stream if active
                this.autoSyncWithStream();

                // Force re-render if in multi-player mode
                setTimeout(() => {
                    if (document.getElementById('previewContent').innerHTML.trim()) {
                        console.log('ðŸ”„ Forcing re-render to apply new logo sizes');
                        const currentMode = document.getElementById('inputMode').value;
                        if (currentMode === 'multi') {
                            // Trigger a refresh of the current display
                            const refreshBtn = document.querySelector('[onclick*="generateMultiVisualization"]');
                            if (refreshBtn) {
                                refreshBtn.click();
                            }
                        }
                    }
                }, 500);
            }

            // Keep old functions for backward compatibility
            updateLogoSizeDisplay(value) {
                this.updateUnifiedLogoSize(value);
            }

            // Keep old functions for backward compatibility
            updateTargetLogoSizeDisplay(value) {
                this.updateUnifiedLogoSize(document.getElementById('clubLogoSize').value);
            }

            updateTargetLogoLargeSizeDisplay(value) {
                this.updateUnifiedLogoSize(document.getElementById('clubLogoSize').value);
            }

            // Force OBS refresh for live streaming updates
            forceOBSRefresh() {
                try {
                    console.log('ðŸ”„ Forcing OBS refresh for live streaming...');

                    // Method 1: Add a temporary invisible element to trigger DOM change
                    const refreshTrigger = document.createElement('div');
                    refreshTrigger.style.cssText = 'position:absolute;top:-1px;left:-1px;width:1px;height:1px;opacity:0;pointer-events:none;';
                    refreshTrigger.textContent = Date.now().toString();
                    document.body.appendChild(refreshTrigger);

                    // Remove it after a brief moment
                    setTimeout(() => {
                        if (refreshTrigger.parentNode) {
                            refreshTrigger.parentNode.removeChild(refreshTrigger);
                        }
                    }, 100);

                    // Method 2: Force repaint by temporarily changing a CSS property
                    const cardElement = document.querySelector('.fifa-card, .financial-card');
                    if (cardElement) {
                        const originalTransform = cardElement.style.transform;
                        cardElement.style.transform = 'translateZ(0.1px)';

                        // Force reflow
                        cardElement.offsetHeight;

                        // Restore original transform
                        setTimeout(() => {
                            cardElement.style.transform = originalTransform || 'translateZ(0)';
                        }, 50);
                    }

                    // Method 3: Update stream content with new sizes
                    this.updateStreamContentSizes();

                    // Method 4: Dispatch custom event for OBS integration
                    window.dispatchEvent(new CustomEvent('obsRefresh', {
                        detail: {
                            timestamp: Date.now(),
                            source: 'pro-studio-v4-ultimate',
                            type: 'layout-update'
                        }
                    }));

                    console.log('âœ… OBS refresh triggered successfully');

                } catch (error) {
                    console.warn('âš ï¸ OBS refresh failed:', error);
                }
            }

            // Update stream content with current size settings
            updateStreamContentSizes() {
                try {
                    const currentStreamData = localStorage.getItem('directStreamContent');
                    if (currentStreamData) {
                        const streamData = JSON.parse(currentStreamData);
                        if (streamData.html) {
                            // Apply current sizes to the stream content
                            const updatedHTML = window.applyCurrentSizesToContent(streamData.html);

                            const newStreamData = {
                                ...streamData,
                                html: updatedHTML,
                                timestamp: Date.now(),
                                sizesUpdated: true
                            };

                            localStorage.setItem('directStreamContent', JSON.stringify(newStreamData));
                            localStorage.setItem('directStreamContentChanged', Date.now().toString());

                            console.log('ðŸ“º Stream content sizes updated for OBS');
                        }
                    }
                } catch (error) {
                    console.error('âŒ Error updating stream content sizes:', error);
                }
            }

            // Auto-sync with stream when sizes change
            autoSyncWithStream() {
                try {
                    console.log('ðŸ”„ Auto-syncing with stream...');

                    // Check if direct stream is active
                    const isStreamActive = window.directStreamActive || localStorage.getItem('directStreamActive') === 'true';

                    if (!isStreamActive) {
                        console.log('ðŸ“º Stream not active, skipping sync');
                        return;
                    }

                    // Check if there's content to sync
                    const previewContent = document.getElementById('previewContent');
                    if (!previewContent || !previewContent.innerHTML.trim()) {
                        console.log('ðŸ“º No content to sync');
                        return;
                    }

                    console.log('ðŸ“º Syncing current content with updated sizes...');

                    // Auto-send updated content to stream
                    if (typeof window.sendToDirectStream === 'function') {
                        setTimeout(() => {
                            window.sendToDirectStream();
                            console.log('âœ… Content synced with stream');
                        }, 500); // Small delay to ensure size changes are applied
                    } else {
                        console.warn('âš ï¸ sendToDirectStream function not available');
                    }

                } catch (error) {
                    console.warn('âš ï¸ Auto-sync with stream failed:', error);
                }
            }

            // ðŸŽ¬ Card Transition Management
            changeCardTransition(transition) {
                console.log(`ðŸŽ¬ Changing card transition to: ${transition}`);

                this.settings.cardTransition = transition;
                this.saveSettingsOnly();

                // Update CSS custom property immediately
                document.documentElement.style.setProperty('--current-transition', transition);

                const transitionName = this.getTransitionNameArabic(transition);
                this.showNotification(`ðŸŽ¬ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ù„Ù‰ ${transitionName}`, 'success');

                // Auto-test the transition if there's a card visible
                this.autoTestTransition();
            }

            // ðŸ§ª Auto-test transition when changed
            autoTestTransition() {
                const cardElement = document.querySelector('.fifa-card, .financial-card');
                if (cardElement && cardElement.style.visibility !== 'hidden') {
                    console.log('ðŸ§ª Auto-testing new transition...');
                    setTimeout(() => {
                        this.hideCard();
                        setTimeout(() => {
                            this.showCard();
                        }, (this.settings.transitionDuration || 1.0) * 1000 + 300);
                    }, 500);
                }
            }

            // ðŸŽ­ Test current transition manually
            testCurrentTransition() {
                const cardElement = document.querySelector('.fifa-card, .financial-card');

                if (!cardElement) {
                    this.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø© Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ - Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹', 'warning');
                    return;
                }

                const transitionType = this.settings?.cardTransition || 'fadeIn';
                const transitionDuration = this.settings?.transitionDuration || 1.0;
                const transitionName = this.getTransitionNameArabic(transitionType);

                this.showNotification(`ðŸŽ­ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù†ØªÙ‚Ø§Ù„: ${transitionName} (${transitionDuration}s)`, 'info');
                console.log(`ðŸŽ­ Testing transition: ${transitionType} (${transitionDuration}s)`);

                // Test sequence: Hide -> Show
                this.hideCard();
                setTimeout(() => {
                    this.showCard();
                }, (transitionDuration * 1000) + 400); // Add buffer time
            }

            // ðŸš€ Show card initially with modern entrance
            showCardInitially() {
                setTimeout(() => {
                    const cardElement = document.querySelector('.fifa-card, .financial-card');
                    if (cardElement) {
                        // CRITICAL FIX: Ensure card is visible
                        cardElement.style.visibility = 'visible';
                        cardElement.style.opacity = '1';

                        // Modern fast entrance
                        cardElement.style.willChange = 'transform, opacity';
                        cardElement.style.opacity = '0';
                        cardElement.style.visibility = 'visible';
                        cardElement.classList.add('card-entering');

                        requestAnimationFrame(() => {
                            cardElement.style.animation = 'modernFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards';
                        });

                        // Clean up after animation
                        setTimeout(() => {
                            cardElement.classList.remove('card-entering');
                            cardElement.style.animation = 'none';
                            cardElement.style.opacity = '1';
                            cardElement.style.willChange = 'auto';

                            // Auto-send to direct stream if enabled
                            if (typeof window.checkAutoSendToDirectStream === 'function') {
                                window.checkAutoSendToDirectStream();
                            }

                            // Auto-send to OBS File System if enabled
                            if (typeof window.checkAutoSendToOBSFileSystem === 'function') {
                                window.checkAutoSendToOBSFileSystem();
                            }
                        }, 350);
                    }
                }, 300); // Faster initial delay
            }

            // ðŸš€ Get modern entrance animation name
            getModernEntranceAnimation(transitionType) {
                const animationMap = {
                    'fadeIn': 'modernFadeIn',
                    'wipeUp': 'modernSlideUp',
                    'wipeDown': 'modernSlideDown',
                    'wipeLeft': 'modernSlideLeft',
                    'wipeRight': 'modernSlideRight',
                    'slideFromBelow': 'modernSlideUp',
                    'slideFromAbove': 'modernSlideDown',
                    'slideFromLeft': 'modernSlideLeft',
                    'slideFromRight': 'modernSlideRight',
                    'slideFadeBelow': 'modernSlideUp',
                    'slideFadeAbove': 'modernSlideDown',
                    'slideFadeLeft': 'modernSlideLeft',
                    'slideFadeRight': 'modernSlideRight',
                    'irisWipe': 'modernScale',
                    'flipVertical': 'modernFlip',
                    'flipHorizontal': 'modernFlip',
                    'expandIn': 'modernScale',
                    'bounceExpand': 'modernBounce'
                };
                return animationMap[transitionType] || 'modernFadeIn';
            }

            // ðŸš€ Get modern exit animation name
            getModernExitAnimation(transitionType) {
                const animationMap = {
                    'fadeIn': 'modernFadeOut',
                    'wipeUp': 'modernSlideOutUp',
                    'wipeDown': 'modernSlideOutDown',
                    'wipeLeft': 'modernSlideOutLeft',
                    'wipeRight': 'modernSlideOutRight',
                    'slideFromBelow': 'modernSlideOutDown',
                    'slideFromAbove': 'modernSlideOutUp',
                    'slideFromLeft': 'modernSlideOutLeft',
                    'slideFromRight': 'modernSlideOutRight',
                    'slideFadeBelow': 'modernSlideOutDown',
                    'slideFadeAbove': 'modernSlideOutUp',
                    'slideFadeLeft': 'modernSlideOutLeft',
                    'slideFadeRight': 'modernSlideOutRight',
                    'irisWipe': 'modernScaleOut',
                    'flipVertical': 'modernFlipOut',
                    'flipHorizontal': 'modernFlipOut',
                    'expandIn': 'modernScaleOut',
                    'bounceExpand': 'modernBounceOut'
                };
                return animationMap[transitionType] || 'modernFadeOut';
            }

            // ðŸŽ¯ Get initial transform for transition type
            getInitialTransform(transitionType) {
                switch(transitionType) {
                    case 'slideFromBelow': return 'translateY(100%)';
                    case 'slideFromAbove': return 'translateY(-100%)';
                    case 'slideFromLeft': return 'translateX(-100%)';
                    case 'slideFromRight': return 'translateX(100%)';
                    case 'slideFadeBelow': return 'translateY(50%) scale(0.8)';
                    case 'slideFadeAbove': return 'translateY(-50%) scale(0.8)';
                    case 'slideFadeLeft': return 'translateX(-50%) scale(0.8)';
                    case 'slideFadeRight': return 'translateX(50%) scale(0.8)';
                    case 'flipVertical': return 'rotateX(-90deg)';
                    case 'flipHorizontal': return 'rotateY(-90deg)';
                    case 'expandIn': return 'scale(0)';
                    case 'bounceExpand': return 'scale(0)';
                    default: return 'none';
                }
            }

            // ðŸŽ¯ Get initial clip-path for transition type
            getInitialClipPath(transitionType) {
                switch(transitionType) {
                    case 'wipeUp': return 'inset(100% 0 0 0)';
                    case 'wipeDown': return 'inset(0 0 100% 0)';
                    case 'wipeLeft': return 'inset(0 100% 0 0)';
                    case 'wipeRight': return 'inset(0 0 0 100%)';
                    case 'irisWipe': return 'circle(0% at 50% 50%)';
                    default: return 'none';
                }
            }

            // ðŸšª Get exit transform for transition type
            getExitTransform(transitionType) {
                switch(transitionType) {
                    case 'slideFromBelow': return 'translateY(100%)';
                    case 'slideFromAbove': return 'translateY(-100%)';
                    case 'slideFromLeft': return 'translateX(-100%)';
                    case 'slideFromRight': return 'translateX(100%)';
                    case 'slideFadeBelow': return 'translateY(50%) scale(0.8)';
                    case 'slideFadeAbove': return 'translateY(-50%) scale(0.8)';
                    case 'slideFadeLeft': return 'translateX(-50%) scale(0.8)';
                    case 'slideFadeRight': return 'translateX(50%) scale(0.8)';
                    case 'flipVertical': return 'rotateX(90deg)';
                    case 'flipHorizontal': return 'rotateY(90deg)';
                    case 'expandIn': return 'scale(0)';
                    case 'bounceExpand': return 'scale(0)';
                    default: return 'none';
                }
            }

            // ðŸšª Get exit clip-path for transition type
            getExitClipPath(transitionType) {
                switch(transitionType) {
                    case 'wipeUp': return 'inset(0 0 100% 0)';
                    case 'wipeDown': return 'inset(100% 0 0 0)';
                    case 'wipeLeft': return 'inset(0 0 0 100%)';
                    case 'wipeRight': return 'inset(0 100% 0 0)';
                    case 'irisWipe': return 'circle(0% at 50% 50%)';
                    default: return 'none';
                }
            }

            updateTransitionDuration(duration) {
                const durationFloat = parseFloat(duration);

                // Update display value
                document.getElementById('transitionDurationValue').textContent = duration;

                // Update settings
                this.settings.transitionDuration = durationFloat;
                this.saveSettingsOnly();

                // Update CSS custom property immediately
                document.documentElement.style.setProperty('--transition-duration', `${durationFloat}s`);

                this.showNotification(`â±ï¸ ØªÙ… ØªØ­Ø¯ÙŠØ« Ù…Ø¯Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ${duration} Ø«Ø§Ù†ÙŠØ©`, 'success');

                console.log(`â±ï¸ Transition duration changed to: ${durationFloat}s`);
            }

            getTransitionNameArabic(transition) {
                const names = {
                    'fadeIn': 'ØªÙ„Ø§Ø´ÙŠ ØªØ¯Ø±ÙŠØ¬ÙŠ',
                    'wipeUp': 'Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„Ø£Ø¹Ù„Ù‰',
                    'wipeDown': 'Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„Ø£Ø³ÙÙ„',
                    'wipeLeft': 'Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„ÙŠØ³Ø§Ø±',
                    'wipeRight': 'Ù…Ø³Ø­ Ø®Ø·ÙŠ Ù„Ù„ÙŠÙ…ÙŠÙ†',
                    'irisWipe': 'Ù…Ø³Ø­ Ø¯Ø§Ø¦Ø±ÙŠ',
                    'slideFromBelow': 'Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„',
                    'slideFromAbove': 'Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰',
                    'slideFromLeft': 'Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø±',
                    'slideFromRight': 'Ø§Ù†Ø²Ù„Ø§Ù‚ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†',
                    'slideFadeBelow': 'Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„',
                    'slideFadeAbove': 'Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰',
                    'slideFadeLeft': 'Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø±',
                    'slideFadeRight': 'Ø§Ù†Ø²Ù„Ø§Ù‚ ÙˆØªÙ„Ø§Ø´ÙŠ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†',
                    'flipVertical': 'Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ',
                    'flipHorizontal': 'Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ',
                    'expandIn': 'ØªÙˆØ³Ø¹ ØªØ¯Ø±ÙŠØ¬ÙŠ',
                    'bounceExpand': 'Ø§Ø±ØªØ¯Ø§Ø¯ ÙˆØªÙˆØ³Ø¹'
                };
                return names[transition] || transition;
            }

            // ðŸ¤– LM Studio Configuration Functions
            updateLMStudioURL(url) {
                if (!url || url.trim() === '') {
                    this.showNotification('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· LM Studio ØµØ­ÙŠØ­', 'warning');
                    return;
                }

                // Validate URL format
                try {
                    new URL(url);
                } catch (e) {
                    this.showNotification('âŒ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­ - Ø§Ø³ØªØ®Ø¯Ù…: http://IP:PORT', 'warning');
                    return;
                }

                // Save to settings
                this.settings.lmStudioURL = url.trim();
                this.saveSettings();

                this.showNotification(`ðŸ¤– ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· LM Studio: ${url}`, 'success');
                console.log(`ðŸ¤– LM Studio URL updated: ${url}`);
            }

            async testLMStudioConnection() {
                const url = this.settings.lmStudioURL || document.getElementById('lmStudioURL').value;
                const statusDiv = document.getElementById('lmStudioStatus');

                if (!url) {
                    this.showNotification('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· LM Studio Ø£ÙˆÙ„Ø§Ù‹', 'warning');
                    return;
                }

                // Show testing status
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(59, 130, 246, 0.2)';
                statusDiv.style.color = '#60a5fa';
                statusDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...';

                try {
                    // Extract IP and port from URL
                    const urlObj = new URL(url);
                    const ip = urlObj.hostname;
                    const port = urlObj.port || '12345';

                    const response = await fetch('/api/network/test-lm-studio', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ ip, port })
                    });

                    const data = await response.json();

                    if (data.success) {
                        statusDiv.style.background = 'rgba(34, 197, 94, 0.2)';
                        statusDiv.style.color = '#4ade80';
                        statusDiv.innerHTML = '<i class="fas fa-check-circle"></i> Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­ - LM Studio ÙŠØ¹Ù…Ù„!';
                        this.showNotification('âœ… Ø§ØªØµØ§Ù„ LM Studio Ù†Ø§Ø¬Ø­', 'success');
                    } else {
                        statusDiv.style.background = 'rgba(239, 68, 68, 0.2)';
                        statusDiv.style.color = '#f87171';
                        statusDiv.innerHTML = '<i class="fas fa-times-circle"></i> ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ - ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·';
                        this.showNotification('âŒ ÙØ´Ù„ Ø§ØªØµØ§Ù„ LM Studio - ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ù„Ù…Ù†ÙØ°', 'error');
                    }
                } catch (error) {
                    statusDiv.style.background = 'rgba(239, 68, 68, 0.2)';
                    statusDiv.style.color = '#f87171';
                    statusDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±';
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„: ' + error.message, 'error');
                }
            }

            async autoDetectLMStudio() {
                const statusDiv = document.getElementById('lmStudioStatus');
                const urlInput = document.getElementById('lmStudioURL');

                // Show searching status
                statusDiv.style.display = 'block';
                statusDiv.style.background = 'rgba(59, 130, 246, 0.2)';
                statusDiv.style.color = '#60a5fa';
                statusDiv.innerHTML = '<i class="fas fa-search fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† LM Studio...';

                try {
                    const response = await fetch('/api/network/find-lm-studio', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    const data = await response.json();

                    if (data.success && data.url) {
                        // Update URL input
                        urlInput.value = data.url;
                        this.updateLMStudioURL(data.url);

                        statusDiv.style.background = 'rgba(34, 197, 94, 0.2)';
                        statusDiv.style.color = '#4ade80';
                        statusDiv.innerHTML = '<i class="fas fa-check-circle"></i> ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ LM Studio!';
                        this.showNotification(`ðŸŽ¯ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ LM Studio: ${data.url}`, 'success');
                    } else {
                        statusDiv.style.background = 'rgba(245, 158, 11, 0.2)';
                        statusDiv.style.color = '#fbbf24';
                        statusDiv.innerHTML = '<i class="fas fa-search"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ LM Studio';
                        this.showNotification('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ LM Studio - ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„Ù‡', 'warning');
                    }
                } catch (error) {
                    statusDiv.style.background = 'rgba(239, 68, 68, 0.2)';
                    statusDiv.style.color = '#f87171';
                    statusDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«';
                    this.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ: ' + error.message, 'error');
                }
            }

            // ðŸš€ MODERN 2024: Fast and Smooth Card Controls
            showCard() {
                console.log('ðŸš€ Starting modern showCard...');

                const cardElement = document.querySelector('.fifa-card, .financial-card');

                if (!cardElement) {
                    this.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø±Ù‡Ø§ - Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹', 'warning');
                    return;
                }

                // ðŸŽ¬ AUTO SEND TO STREAM - Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                this.autoSendToStream();

                // Get current settings - shorter duration for modern feel
                const transitionType = this.settings?.cardTransition || document.getElementById('cardTransition')?.value || 'fadeIn';
                const transitionDuration = Math.min(this.settings?.transitionDuration || parseFloat(document.getElementById('transitionDuration')?.value) || 0.3, 0.4); // Max 400ms

                console.log(`ðŸš€ Modern transition: ${transitionType}, duration: ${transitionDuration}s`);

                // ðŸš€ Modern performance optimizations - only what we need
                cardElement.style.willChange = 'transform, opacity';

                // Reset all states
                cardElement.className = cardElement.className.replace(/card-(entering|exiting)/g, '');
                cardElement.style.animation = 'none';
                cardElement.style.opacity = '0';
                cardElement.style.visibility = 'visible';
                cardElement.style.transform = 'translateZ(0)';

                // Force reflow
                cardElement.offsetHeight;

                // Add entering class
                cardElement.classList.add('card-entering');

                // Use requestAnimationFrame for perfect timing
                requestAnimationFrame(() => {
                    const animationName = this.getModernEntranceAnimation(transitionType);
                    const timingFunction = 'cubic-bezier(0.4, 0, 0.2, 1)'; // Material Design easing
                    cardElement.style.animation = `${animationName} ${transitionDuration}s ${timingFunction} forwards`;
                    console.log(`âœ… Applied modern animation: ${animationName}`);
                });

                // Clean up after animation
                setTimeout(() => {
                    cardElement.classList.remove('card-entering');
                    cardElement.style.animation = 'none';
                    cardElement.style.opacity = '1';
                    cardElement.style.transform = 'translateZ(0)';
                    cardElement.style.willChange = 'auto'; // Reset for performance

                    // Auto-send to direct stream if enabled
                    if (typeof window.checkAutoSendToDirectStream === 'function') {
                        window.checkAutoSendToDirectStream();
                    }

                    // Auto-send to OBS File System if enabled
                    if (typeof window.checkAutoSendToOBSFileSystem === 'function') {
                        window.checkAutoSendToOBSFileSystem();
                    }
                }, (transitionDuration * 1000) + 50);

                const transitionName = this.getTransitionNameArabic(transitionType);
                this.showNotification(`ðŸš€ Ø¥Ø¸Ù‡Ø§Ø± Ø¹ØµØ±ÙŠ: ${transitionName} (${transitionDuration}s)`, 'success');
            }

            hideCard() {
                console.log('ðŸš€ Starting modern hideCard...');

                const cardElement = document.querySelector('.fifa-card, .financial-card');

                if (!cardElement) {
                    this.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø© Ù„Ø¥Ø®ÙØ§Ø¦Ù‡Ø§', 'warning');
                    return;
                }

                // Get current settings - shorter duration for modern feel
                const transitionType = this.settings?.cardTransition || document.getElementById('cardTransition')?.value || 'fadeIn';
                const transitionDuration = Math.min(this.settings?.transitionDuration || parseFloat(document.getElementById('transitionDuration')?.value) || 0.3, 0.4); // Max 400ms

                console.log(`ðŸš€ Modern exit: ${transitionType}, duration: ${transitionDuration}s`);

                // ðŸš€ Modern performance optimizations - only what we need
                cardElement.style.willChange = 'transform, opacity';

                // Reset states
                cardElement.className = cardElement.className.replace(/card-(entering|exiting)/g, '');
                cardElement.style.animation = 'none';
                cardElement.style.opacity = '1';
                cardElement.style.visibility = 'visible';
                cardElement.style.transform = 'translateZ(0)';

                // Force reflow
                cardElement.offsetHeight;

                // Add exiting class
                cardElement.classList.add('card-exiting');

                // Use requestAnimationFrame for perfect timing
                requestAnimationFrame(() => {
                    const animationName = this.getModernExitAnimation(transitionType);
                    const timingFunction = 'cubic-bezier(0.4, 0, 1, 1)'; // Sharp exit
                    cardElement.style.animation = `${animationName} ${transitionDuration}s ${timingFunction} forwards`;
                    console.log(`âœ… Applied modern exit: ${animationName}`);
                });

                // Hide completely after animation
                setTimeout(() => {
                    cardElement.classList.remove('card-exiting');
                    cardElement.style.animation = 'none';
                    cardElement.style.visibility = 'hidden';
                    cardElement.style.opacity = '0';
                    cardElement.style.willChange = 'auto'; // Reset for performance
                    console.log('ðŸš€ Card hidden after modern exit');
                }, (transitionDuration * 1000) + 50);

                const transitionName = this.getTransitionNameArabic(transitionType);
                this.showNotification(`ðŸš€ Ø¥Ø®ÙØ§Ø¡ Ø¹ØµØ±ÙŠ: ${transitionName} (${transitionDuration}s)`, 'info');
            }

            // Apply card transition with duration - TARGET CARD ONLY
            applyCardTransition(containerElement, transition = null, duration = null) {
                if (!containerElement) return;

                // Find the actual card element inside the container
                const cardElement = containerElement.querySelector('.fifa-card, .financial-card') || containerElement;

                if (!cardElement) {
                    console.warn('âš ï¸ No card element found for transition');
                    return;
                }

                const transitionType = transition || this.settings.cardTransition || 'fadeIn';
                const transitionDuration = duration || this.settings.transitionDuration || 1.0;

                // Set CSS custom property for duration
                document.documentElement.style.setProperty('--transition-duration', `${transitionDuration}s`);

                // Remove any existing transition and exit classes from the card
                cardElement.classList.remove(
                    // Entry transitions
                    'card-transition-fadeIn', 'card-transition-wipeUp', 'card-transition-wipeDown',
                    'card-transition-wipeLeft', 'card-transition-wipeRight', 'card-transition-irisWipe',
                    'card-transition-slideFromBelow', 'card-transition-slideFromAbove',
                    'card-transition-slideFromLeft', 'card-transition-slideFromRight',
                    'card-transition-slideFadeBelow', 'card-transition-slideFadeAbove',
                    'card-transition-slideFadeLeft', 'card-transition-slideFadeRight',
                    'card-transition-flipVertical', 'card-transition-flipHorizontal',
                    'card-transition-expandIn', 'card-transition-bounceExpand',
                    // Exit transitions
                    'card-exit-fadeIn', 'card-exit-wipeUp', 'card-exit-wipeDown',
                    'card-exit-wipeLeft', 'card-exit-wipeRight', 'card-exit-irisWipe',
                    'card-exit-slideFromBelow', 'card-exit-slideFromAbove',
                    'card-exit-slideFromLeft', 'card-exit-slideFromRight',
                    'card-exit-slideFadeBelow', 'card-exit-slideFadeAbove',
                    'card-exit-slideFadeLeft', 'card-exit-slideFadeRight',
                    'card-exit-flipVertical', 'card-exit-flipHorizontal',
                    'card-exit-expandIn', 'card-exit-bounceExpand'
                );

                // Reset any inline styles that might interfere
                cardElement.style.opacity = '';
                cardElement.style.visibility = '';
                cardElement.style.transform = '';
                cardElement.style.clipPath = '';

                // Apply new transition class to the card only
                cardElement.classList.add(`card-transition-${transitionType}`);

                console.log(`ðŸŽ¬ Applied transition to CARD: ${transitionType} (${transitionDuration}s)`);
            }

            // Apply card exit transition - TARGET CARD ONLY
            applyCardExitTransition(containerElement, transition = null, duration = null) {
                if (!containerElement) return Promise.resolve();

                // Find the actual card element inside the container
                const cardElement = containerElement.querySelector('.fifa-card, .financial-card') || containerElement;

                if (!cardElement) {
                    console.warn('âš ï¸ No card element found for exit transition');
                    return Promise.resolve();
                }

                const transitionType = transition || this.settings.cardTransition || 'fadeIn';
                const transitionDuration = duration || this.settings.transitionDuration || 1.0;

                return new Promise(resolve => {
                    // Set CSS custom property for duration
                    document.documentElement.style.setProperty('--transition-duration', `${transitionDuration}s`);

                    // Remove any existing transition classes first
                    cardElement.classList.remove(
                        // Entry transitions
                        'card-transition-fadeIn', 'card-transition-wipeUp', 'card-transition-wipeDown',
                        'card-transition-wipeLeft', 'card-transition-wipeRight', 'card-transition-irisWipe',
                        'card-transition-slideFromBelow', 'card-transition-slideFromAbove',
                        'card-transition-slideFromLeft', 'card-transition-slideFromRight',
                        'card-transition-slideFadeBelow', 'card-transition-slideFadeAbove',
                        'card-transition-slideFadeLeft', 'card-transition-slideFadeRight',
                        'card-transition-flipVertical', 'card-transition-flipHorizontal',
                        'card-transition-expandIn', 'card-transition-bounceExpand',
                        // Exit transitions
                        'card-exit-fadeIn', 'card-exit-wipeUp', 'card-exit-wipeDown',
                        'card-exit-wipeLeft', 'card-exit-wipeRight', 'card-exit-irisWipe',
                        'card-exit-slideFromBelow', 'card-exit-slideFromAbove',
                        'card-exit-slideFromLeft', 'card-exit-slideFromRight',
                        'card-exit-slideFadeBelow', 'card-exit-slideFadeAbove',
                        'card-exit-slideFadeLeft', 'card-exit-slideFadeRight',
                        'card-exit-flipVertical', 'card-exit-flipHorizontal',
                        'card-exit-expandIn', 'card-exit-bounceExpand'
                    );

                    // Reset any inline styles
                    cardElement.style.transform = '';
                    cardElement.style.clipPath = '';

                    // Apply exit transition class to the card only
                    cardElement.classList.add(`card-exit-${transitionType}`);

                    // Wait for animation to complete
                    setTimeout(() => {
                        resolve();
                    }, transitionDuration * 1000);

                    console.log(`ðŸŽ¬ Applied exit transition to CARD: ${transitionType} (${transitionDuration}s)`);
                });
            }

            async createMultiVisualization() {
                if (this.isProcessing) {
                    this.showNotification('âš¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù…...', 'warning');
                    return;
                }

                const defaultTargetClub = document.getElementById('multiTargetClub').value.trim();
                const playerContainers = document.querySelectorAll('.multi-player-input');
                const displayMode = document.getElementById('multiDisplayMode').value;

                // Collect player data from enhanced inputs
                const playersInputData = [];
                let hasValidPlayer = false;

                playerContainers.forEach((container, index) => {
                    // Check if this is a saved player or manual input
                    const savedPlayerSelect = container.querySelector('.multi-saved-player');
                    let name, currentClub, imageUrl;

                    if (savedPlayerSelect && savedPlayerSelect.value) {
                        // This is a saved player
                        try {
                            const savedPlayer = JSON.parse(savedPlayerSelect.value);
                            name = savedPlayer.arabicName || savedPlayer.name || '';
                            currentClub = savedPlayer.currentClub || '';
                            imageUrl = savedPlayer.playerImage || savedPlayer.imageUrl || '';
                        } catch (error) {
                            console.error('Error parsing saved player data:', error);
                            name = '';
                        }
                    } else {
                        // This is manual input
                        name = container.querySelector('.multi-player-name').value.trim();
                        currentClub = container.querySelector('.multi-player-current-club').value.trim();
                        imageUrl = container.querySelector('.multi-player-image').value.trim();
                    }

                    const targetClub = container.querySelector('.multi-player-target-club').value.trim();

                    if (name) {
                        hasValidPlayer = true;
                        playersInputData.push({
                            playerName: name,
                            currentClub: currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                            targetClub: targetClub || defaultTargetClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                            playerImage: imageUrl
                        });
                    }
                });

                if (!hasValidPlayer) {
                    this.showNotification('ðŸš¨ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù„Ø§Ø¹Ø¨ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                    return;
                }

                // Validate that at least one player has a target club
                const hasTargetClub = playersInputData.some(player => player.targetClub !== 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
                if (!hasTargetClub) {
                    this.showNotification('ðŸš¨ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ø£Ø­Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                    return;
                }

                this.isProcessing = true;
                this.updateSystemStatus('Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ÙŠÙ†...');

                try {
                    // Get enhanced data for all players
                    const playersData = [];
                    for (const playerInput of playersInputData) {
                        const playerData = await this.getEnhancedPlayerData(playerInput);
                        playersData.push(playerData);
                    }

                    this.multiPlayers = playersData;

                    if (displayMode === 'all') {
                        await this.generateMultiAllVisualization(playersData);
                    } else {
                        await this.generateMultiSequenceVisualization(playersData);
                    }

                    // Check auto-send to overlay for multi-player
                    checkAutoSendToOverlay();

                    // Check auto-stream for multi-player
                    checkAutoStreamPlayer();

                    // Check auto-send to direct stream for multi-player
                    checkAutoSendToDirectStream();

                    // Check auto-send to OBS File System for multi-player
                    checkAutoSendToOBSFileSystem();

                    const layoutConfig = this.getSmartLayoutConfig(playersData.length);
                    this.showNotification(`ðŸŒŸ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ ${playersData.length} Ù„Ø§Ø¹Ø¨ÙŠÙ†! ðŸ“ ${layoutConfig.description}`, 'success');

                } catch (error) {
                    console.error('ðŸš¨ Multi visualization error:', error);
                    this.showNotification('âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯', 'error');
                } finally {
                    this.isProcessing = false;
                    this.updateSystemStatus('Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¨Ø¯Ø§Ø¹');
                }
            }

            async generateMultiAllVisualization(playersData, targetClub) {
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                if (placeholder) {
                    placeholder.style.display = 'none';
                }

                // Create grid of FIFA 26 cards like individual input
                const multiHTML = this.createMultiGridHTML(playersData);
                previewContent.innerHTML = multiHTML;

                // Apply entrance transition to each individual card in the grid
                const cards = previewContent.querySelectorAll('.fifa-card');
                cards.forEach((card, index) => {
                    // Set initial state (hidden) for each card
                    card.style.opacity = '0';

                    // Apply staggered transitions to each card
                    setTimeout(() => {
                        this.applyCardTransition(card);
                    }, 100 + (index * 150)); // Staggered by 150ms each
                });

                this.initializeParticleEffects();
                this.startFIFAAnimations();
                this.playCreationSound();
            }

            async generateMultiSequenceVisualization(playersData, targetClub) {
                const interval = parseInt(document.getElementById('sequenceInterval').value) || 3;

                this.currentSequenceIndex = 0;
                this.showSequencePlayer(playersData[0]);

                // Add stop button to the visualization
                this.addSequenceStopButton();

                this.sequenceTimer = setInterval(() => {
                    this.currentSequenceIndex++;
                    if (this.currentSequenceIndex >= playersData.length) {
                        this.currentSequenceIndex = 0;
                    }
                    this.showSequencePlayer(playersData[this.currentSequenceIndex]);
                }, interval * 1000);

                this.showNotification(`â±ï¸ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ Ø¨Ø¯Ø£ - ${interval} Ø«ÙˆØ§Ù†ÙŠ Ù„ÙƒÙ„ Ù„Ø§Ø¹Ø¨ - Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ù„Ù„ØªÙˆÙ‚Ù`, 'info');
            }

            addSequenceStopButton() {
                const previewContent = document.getElementById('previewContent');
                if (previewContent) {
                    // Add floating stop button
                    const stopButton = document.createElement('div');
                    stopButton.id = 'sequenceStopButton';
                    stopButton.innerHTML = `
                        <button onclick="ultimateStudio.stopSequence()" style="
                            position: fixed;
                            top: 20px;
                            right: 20px;
                            z-index: 1000;
                            background: linear-gradient(135deg, #ff4757, #ff3838);
                            border: none;
                            border-radius: 50px;
                            padding: 15px 25px;
                            color: white;
                            font-weight: 700;
                            font-size: 1rem;
                            cursor: pointer;
                            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.4);
                            transition: all 0.3s ease;
                            animation: pulseStop 2s ease-in-out infinite;
                        " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                            <i class="fas fa-stop me-2"></i>
                            Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ
                        </button>
                        <style>
                            @keyframes pulseStop {
                                0%, 100% { box-shadow: 0 8px 25px rgba(255, 71, 87, 0.4); }
                                50% { box-shadow: 0 8px 35px rgba(255, 71, 87, 0.7); }
                            }
                        </style>
                    `;
                    document.body.appendChild(stopButton);
                }
            }

            async showSequencePlayer(playerData) {
                const previewContent = document.getElementById('previewContent');
                const placeholder = document.getElementById('previewPlaceholder');

                // Apply exit transition to existing card if any (except for first player)
                if (this.currentSequenceIndex > 0) {
                    const existingCard = previewContent.querySelector('.fifa-card');
                    if (existingCard) {
                        await this.applyCardExitTransition(existingCard);
                    }
                }

                if (placeholder) {
                    placeholder.style.display = 'none';
                }

                // Use FIFA 26 card for sequence display
                const playerHTML = this.createFIFA26CardHTML(playerData);
                previewContent.innerHTML = playerHTML;

                // Apply entrance transition to new card
                const newCard = previewContent.querySelector('.fifa-card');
                if (newCard) {
                    // Set initial state for smooth transition
                    newCard.style.opacity = '0';
                    newCard.style.visibility = 'visible';
                    newCard.style.transform = '';
                    newCard.style.clipPath = '';

                    // Apply transition after a small delay to the card only
                    setTimeout(() => {
                        this.applyCardTransition(previewContent); // Pass container, function will find the card
                    }, 100);
                }

                // Background effects continue normally
                this.initializeParticleEffects();
                this.startFIFAAnimations();

                // Play different sound for sequence
                if (this.currentSequenceIndex === 0) {
                    this.playCreationSound(); // First player gets full sound
                } else {
                    this.playSequenceTransitionSound(); // Others get transition sound
                }

                // Show sequence progress
                this.showNotification(`ðŸŽ® Ø¹Ø±Ø¶ ${playerData.arabicName} (${this.currentSequenceIndex + 1}/${this.multiPlayers.length})`, 'info');
            }

            stopSequence() {
                if (this.sequenceTimer) {
                    clearInterval(this.sequenceTimer);
                    this.sequenceTimer = null;

                    // Remove stop button
                    const stopButton = document.getElementById('sequenceStopButton');
                    if (stopButton) {
                        stopButton.remove();
                    }

                    // Clear preview and show placeholder
                    this.clearPreviewContent();
                    const placeholder = document.getElementById('previewPlaceholder');
                    if (placeholder) {
                        placeholder.style.display = 'flex';
                        placeholder.innerHTML = `
                            <div style="text-align: center;">
                                <i class="fas fa-stop-circle" style="font-size: 4rem; color: #ff4757; margin-bottom: 20px;"></i>
                                <h3 style="color: white; margin-bottom: 10px;">ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ</h3>
                                <p style="color: rgba(255, 255, 255, 0.7);">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø®ØªÙŠØ§Ø± Ù†Ù…Ø· Ø¢Ø®Ø± Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ ØªØµÙˆØ± Ø¬Ø¯ÙŠØ¯</p>
                            </div>
                        `;
                    }

                    this.showNotification('â¹ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ - ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø®Ø±Ù‰', 'success');
                }
            }

            // Enhanced Layout System - Stream & Details Optimized
            getIntelligentLayout(playersCount) {
                // Enhanced quality tiers with better detail preservation
                const qualityTiers = {
                    premium: { minWidth: 450, minHeight: 650, maxPlayers: 2 },
                    high: { minWidth: 380, minHeight: 550, maxPlayers: 4 },
                    medium: { minWidth: 320, minHeight: 480, maxPlayers: 6 },
                    compact: { minWidth: 280, minHeight: 420, maxPlayers: 8 }
                };

                // Optimized layout configurations for better detail visibility
                const layouts = {
                    1: {
                        cardWidth: 500, cardHeight: 700, gap: 0,
                        columns: '1fr', maxWidth: '550px',
                        description: 'Ù„Ø§Ø¹Ø¨ ÙˆØ§Ø­Ø¯ - Ø¹Ø±Ø¶ Ù…Ù…ÙŠØ² ÙƒØ§Ù…Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„',
                        tier: 'premium', layout: 'centered'
                    },
                    2: {
                        cardWidth: 450, cardHeight: 650, gap: 40,
                        columns: 'repeat(2, 1fr)', maxWidth: '980px',
                        description: 'Ù„Ø§Ø¹Ø¨Ø§Ù† - Ø¹Ø±Ø¶ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©',
                        tier: 'premium', layout: 'side-by-side'
                    },
                    3: {
                        cardWidth: 400, cardHeight: 580, gap: 35,
                        columns: 'repeat(3, 1fr)', maxWidth: '1270px',
                        description: 'Ø«Ù„Ø§Ø«Ø© Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ø¬ÙˆØ¯Ø© Ù…Ù…ØªØ§Ø²Ø©',
                        tier: 'high', layout: 'single-row'
                    },
                    4: {
                        cardWidth: 380, cardHeight: 550, gap: 30,
                        columns: 'repeat(2, 1fr)', maxWidth: '840px',
                        description: 'Ø£Ø±Ø¨Ø¹Ø© Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ø´Ø¨ÙƒØ© 2Ã—2',
                        tier: 'high', layout: 'grid-2x2'
                    },
                    5: {
                        cardWidth: 320, cardHeight: 480, gap: 25,
                        columns: 'repeat(5, 1fr)', maxWidth: '1650px',
                        description: 'Ø®Ù…Ø³Ø© Ù„Ø§Ø¹Ø¨ÙŠÙ† - ØµÙ ÙˆØ§Ø­Ø¯',
                        tier: 'medium', layout: 'single-row'
                    },
                    6: {
                        cardWidth: 320, cardHeight: 480, gap: 25,
                        columns: 'repeat(3, 1fr)', maxWidth: '1020px',
                        description: 'Ø³ØªØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ø´Ø¨ÙƒØ© 3Ã—2',
                        tier: 'medium', layout: 'grid-3x2'
                    },
                    7: {
                        cardWidth: 280, cardHeight: 420, gap: 20,
                        columns: 'repeat(7, 1fr)', maxWidth: '2000px',
                        description: 'Ø³Ø¨Ø¹Ø© Ù„Ø§Ø¹Ø¨ÙŠÙ† - ØµÙ ÙˆØ§Ø­Ø¯',
                        tier: 'compact', layout: 'single-row'
                    },
                    8: {
                        cardWidth: 280, cardHeight: 420, gap: 20,
                        columns: 'repeat(4, 1fr)', maxWidth: '1160px',
                        description: 'Ø«Ù…Ø§Ù†ÙŠØ© Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ø´Ø¨ÙƒØ© 4Ã—2',
                        tier: 'compact', layout: 'grid-4x2'
                    }
                };

                const config = layouts[Math.min(playersCount, 8)] || layouts[8];

                return {
                    ...config,
                    cardWidth: `${config.cardWidth}px`,
                    cardHeight: `${config.cardHeight}px`,
                    gap: `${config.gap}px`,
                    obsOptimized: playersCount >= 4,
                    qualityTier: config.tier,
                    gridRows: this.calculateGridRows(playersCount, config.layout)
                };
            }

            // Calculate grid rows for better layout
            calculateGridRows(playersCount, layout) {
                const rowConfigs = {
                    'grid-2x2': 2,
                    'grid-3x2': 2,
                    'grid-4x2': 2,
                    'single-row': 1,
                    'centered': 1,
                    'side-by-side': 1
                };
                return rowConfigs[layout] || Math.ceil(playersCount / 4);
            }

            // Smart Layout Calculator - Intelligent Quality System
            getSmartLayoutConfig(playersCount) {
                return this.getIntelligentLayout(playersCount);
            }

            // Create grid of FIFA 26 cards for multi-player display - Enhanced
            createMultiGridHTML(playersData) {
                const playersCount = playersData.length;
                const layoutConfig = this.getSmartLayoutConfig(playersCount);

                // Smart Layout Styles for Different Player Counts
                let specialLayout = `
                    /* OBS Single Row Optimization */
                    .obs-single-row {
                        display: flex !important;
                        flex-direction: row !important;
                        justify-content: center !important;
                        align-items: center !important;
                        gap: ${layoutConfig.gap} !important;
                        max-width: 1920px !important;
                        width: 100% !important;
                        height: 100vh !important;
                        max-height: 1080px !important;
                        padding: 20px 50px !important;
                        margin: 0 auto !important;
                        overflow: hidden !important;
                        box-sizing: border-box !important;
                    }

                    .obs-single-row .fifa-card {
                        flex-shrink: 0 !important;
                        width: ${layoutConfig.cardWidth} !important;
                        height: ${layoutConfig.cardHeight} !important;
                        max-width: ${layoutConfig.cardWidth} !important;
                        max-height: ${layoutConfig.cardHeight} !important;
                    }
                `;

                if (playersCount === 4) {
                    specialLayout = `
                        /* 4 Players: Perfect 2x2 Grid - Enhanced Balance */
                        .players-grid-smart {
                            display: grid !important;
                            grid-template-columns: repeat(2, 1fr) !important;
                            grid-template-rows: repeat(2, 1fr) !important;
                            gap: 30px !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            justify-items: center !important;
                            padding: 30px !important;
                            place-content: center !important;
                            min-height: 100vh !important;
                            box-sizing: border-box !important;
                        }

                        /* Enhanced card spacing for 4 players */
                        .players-grid-smart .fifa-card {
                            margin: 10px !important;
                        }
                    `;
                } else if (playersCount === 5) {
                    specialLayout = `
                        /* 5 Players: 3 top + 2 bottom centered */
                        .players-grid-smart {
                            display: flex !important;
                            flex-direction: column !important;
                            gap: 25px !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            padding: 20px !important;
                        }
                        .players-row-top {
                            display: grid !important;
                            grid-template-columns: repeat(3, 1fr) !important;
                            gap: ${layoutConfig.gap} !important;
                            width: 100% !important;
                            justify-items: center !important;
                        }
                        .players-row-bottom {
                            display: grid !important;
                            grid-template-columns: repeat(2, 1fr) !important;
                            gap: ${layoutConfig.gap} !important;
                            width: 66.67% !important;
                            justify-items: center !important;
                            margin-top: 10px !important;
                        }
                    `;
                } else if (playersCount === 6) {
                    specialLayout = `
                        /* 6 Players: Perfect 3x2 Grid - Enhanced Balance */
                        .players-grid-smart {
                            display: grid !important;
                            grid-template-columns: repeat(3, 1fr) !important;
                            grid-template-rows: repeat(2, 1fr) !important;
                            gap: 25px !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            justify-items: center !important;
                            padding: 30px !important;
                            place-content: center !important;
                            min-height: 100vh !important;
                            box-sizing: border-box !important;
                        }

                        /* Enhanced card spacing for 6 players */
                        .players-grid-smart .fifa-card {
                            margin: 8px !important;
                        }
                    `;
                } else if (playersCount === 7) {
                    specialLayout = `
                        /* 7 Players: 4 top + 3 bottom */
                        .players-grid-smart {
                            display: flex !important;
                            flex-direction: column !important;
                            gap: 20px !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            padding: 20px !important;
                        }
                        .players-row-top {
                            display: grid !important;
                            grid-template-columns: repeat(4, 1fr) !important;
                            gap: ${layoutConfig.gap} !important;
                            width: 100% !important;
                            justify-items: center !important;
                        }
                        .players-row-bottom {
                            display: grid !important;
                            grid-template-columns: repeat(3, 1fr) !important;
                            gap: ${layoutConfig.gap} !important;
                            width: 75% !important;
                            justify-items: center !important;
                        }
                    `;
                } else if (playersCount === 8) {
                    specialLayout = `
                        /* 8 Players: Perfect 4x2 Grid - Enhanced Balance */
                        .players-grid-smart {
                            display: grid !important;
                            grid-template-columns: repeat(4, 1fr) !important;
                            grid-template-rows: repeat(2, 1fr) !important;
                            gap: 20px !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            justify-items: center !important;
                            padding: 25px !important;
                            place-content: center !important;
                            min-height: 100vh !important;
                            box-sizing: border-box !important;
                        }

                        /* Enhanced card spacing for 8 players */
                        .players-grid-smart .fifa-card {
                            margin: 5px !important;
                        }
                    `;
                }

                const gridHTML = `
                    <style>
                        ${specialLayout}
                        .multi-grid-container {
                            width: 100%;
                            height: 100%;
                            position: relative;
                            background: radial-gradient(circle at center, #0a0a0f 0%, #1a0b2e 100%);
                            overflow-y: auto;
                            padding: 20px;
                        }

                        /* Custom Title Styling */
                        .custom-title {
                            position: absolute;
                            top: 20px;
                            left: 50%;
                            transform: translateX(-50%);
                            z-index: 100;
                            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(147, 51, 234, 0.9));
                            color: white;
                            padding: 15px 30px;
                            border-radius: 25px;
                            font-size: 1.8rem;
                            font-weight: 700;
                            text-align: center;
                            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
                            backdrop-filter: blur(10px);
                            border: 2px solid rgba(255, 255, 255, 0.2);
                            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                            min-width: 300px;
                        }

                        /* Channel Rights Styling - Bottom Center */
                        .channel-rights {
                            position: absolute;
                            bottom: 25px;
                            left: 50%;
                            transform: translateX(-50%);
                            z-index: 100;
                            background: linear-gradient(135deg, rgba(0, 0, 0, 0.85), rgba(30, 30, 30, 0.85));
                            color: rgba(255, 255, 255, 0.95);
                            padding: 12px 25px;
                            border-radius: 20px;
                            font-size: 1.1rem;
                            font-weight: 600;
                            text-align: center;
                            box-shadow:
                                0 10px 30px rgba(0, 0, 0, 0.4),
                                0 0 20px rgba(102, 126, 234, 0.3),
                                inset 0 1px 0 rgba(255, 255, 255, 0.2);
                            backdrop-filter: blur(15px);
                            border: 2px solid rgba(255, 255, 255, 0.15);
                            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
                            min-width: 350px;
                            animation: rightsGlow 3s ease-in-out infinite;
                        }
                        .players-grid-smart {
                            position: relative;
                            z-index: 10;
                            display: grid;
                            grid-template-columns: ${layoutConfig.columns};
                            gap: ${layoutConfig.gap};
                            max-width: ${layoutConfig.maxWidth};
                            margin: 0 auto;
                            align-items: start;
                            justify-items: center;
                        }
                        /* Quality-Based Card Sizing */
                        .fifa-card {
                            width: ${layoutConfig.cardWidth} !important;
                            max-width: ${layoutConfig.cardWidth} !important;
                            height: ${layoutConfig.cardHeight} !important;
                            max-height: ${layoutConfig.cardHeight} !important;
                            transition: all 0.3s ease !important;
                        }

                        /* Quality Tier Styling */
                        .quality-${layoutConfig.qualityTier} .fifa-card {
                            ${layoutConfig.qualityTier === 'premium' ? `
                                box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6) !important;
                                border: 3px solid rgba(255, 255, 255, 0.3) !important;
                            ` : layoutConfig.qualityTier === 'high' ? `
                                box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5) !important;
                                border: 2px solid rgba(255, 255, 255, 0.25) !important;
                            ` : layoutConfig.qualityTier === 'medium' ? `
                                box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4) !important;
                                border: 2px solid rgba(255, 255, 255, 0.2) !important;
                            ` : `
                                box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3) !important;
                                border: 1px solid rgba(255, 255, 255, 0.15) !important;
                            `}
                        }

                        /* OBS Container Optimization */
                        .multi-grid-container {
                            max-height: 1080px !important;
                            overflow: hidden !important;
                            display: flex !important;
                            align-items: center !important;
                            justify-content: center !important;
                        }

                        /* Intelligent Grid System */
                        .players-grid-smart {
                            display: grid !important;
                            grid-template-columns: ${layoutConfig.columns} !important;
                            gap: ${layoutConfig.gap} !important;
                            max-width: ${layoutConfig.maxWidth} !important;
                            margin: 0 auto !important;
                            align-items: center !important;
                            justify-items: center !important;
                            padding: 30px !important;
                        }

                        /* Font Size Adaptation */
                        .quality-${layoutConfig.qualityTier} .fifa-card .player-name {
                            font-size: ${layoutConfig.qualityTier === 'premium' ? '2.2rem' :
                                        layoutConfig.qualityTier === 'high' ? '2rem' :
                                        layoutConfig.qualityTier === 'medium' ? '1.8rem' : '1.6rem'} !important;
                        }

                        .quality-${layoutConfig.qualityTier} .fifa-card .club-info {
                            font-size: ${layoutConfig.qualityTier === 'premium' ? '1.4rem' :
                                        layoutConfig.qualityTier === 'high' ? '1.2rem' :
                                        layoutConfig.qualityTier === 'medium' ? '1.1rem' : '1rem'} !important;
                        }

                        .quality-${layoutConfig.qualityTier} .fifa-card .probability-text {
                            font-size: ${layoutConfig.qualityTier === 'premium' ? '1.8rem' :
                                        layoutConfig.qualityTier === 'high' ? '1.6rem' :
                                        layoutConfig.qualityTier === 'medium' ? '1.4rem' : '1.2rem'} !important;
                        }
                    </style>
                    <div class="multi-grid-container">
                        <!-- Custom Title -->
                        <div class="custom-title" id="customTitle">
                            ${this.getCustomTitle()}
                        </div>

                        <!-- Particle Canvas -->
                        <canvas id="particleCanvas" style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 1;
                        "></canvas>



                        <!-- Players Grid - Smart Layout -->
                        ${this.createSmartPlayersGrid(playersData)}



                        <!-- Channel Rights -->
                        <div class="channel-rights" id="channelRights">
                            ${this.getChannelRights()}
                        </div>
                    </div>
                `;
                return gridHTML;
            }

            // Clean Players Grid Generator - Stream Optimized
            createSmartPlayersGrid(playersData) {
                const playersCount = playersData.length;
                const layoutConfig = this.getSmartLayoutConfig(playersCount);

                // NO INFO BOX - Direct to grid for clean streaming
                return `
                    <style>
                        .players-grid-clean {
                            display: grid;
                            grid-template-columns: ${layoutConfig.columns};
                            ${layoutConfig.gridRows > 1 ? `grid-template-rows: repeat(${layoutConfig.gridRows}, 1fr);` : ''}
                            gap: ${layoutConfig.gap};
                            max-width: ${layoutConfig.maxWidth};
                            margin: 0 auto;
                            align-items: center;
                            justify-items: center;
                            padding: clamp(20px, 4vh, 40px) clamp(15px, 3vw, 30px);
                            min-height: 100vh;
                            box-sizing: border-box;
                            place-content: center;
                        }

                        .clean-card {
                            width: ${layoutConfig.cardWidth};
                            height: ${layoutConfig.cardHeight};
                            max-width: ${layoutConfig.cardWidth};
                            max-height: ${layoutConfig.cardHeight};
                            min-width: 250px;
                            min-height: 350px;
                        }

                        /* Responsive adjustments */
                        @media (max-width: 1920px) {
                            .players-grid-clean {
                                gap: calc(${layoutConfig.gap} * 0.8);
                            }
                        }

                        @media (max-width: 1600px) {
                            .clean-card {
                                width: calc(${layoutConfig.cardWidth} * 0.9);
                                height: calc(${layoutConfig.cardHeight} * 0.9);
                            }
                        }

                        @media (max-width: 1200px) {
                            .clean-card {
                                width: calc(${layoutConfig.cardWidth} * 0.8);
                                height: calc(${layoutConfig.cardHeight} * 0.8);
                            }
                        }
                    </style>
                    <div class="players-grid-clean quality-${layoutConfig.qualityTier}">
                        ${playersData.map((player, index) => this.createCleanFIFA26CardHTML(player, index * 0.15)).join('')}
                    </div>
                `;
            }

            // Clean FIFA 26 Card HTML Generator - Stream Optimized
            createCleanFIFA26CardHTML(player, animationDelay = 0) {
                const probability = player.probability;
                const probabilityValue = probability.percentage;
                const probabilityColor = this.getProbabilityColor(probabilityValue);
                const cardGradient = this.getCardGradient(probabilityValue);
                const ratingColor = this.getRatingColor(player.rating);
                const gradientId = `gradient-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;

                return `
                    <div class="fifa-card clean-card" style="
                        animation-delay: ${animationDelay}s;
                        background: ${cardGradient};
                        border: 3px solid ${probabilityColor};
                        border-radius: 20px;
                        position: relative;
                        overflow: hidden;
                        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 0 30px ${probabilityColor}40;
                        transition: all 0.3s ease;
                        display: flex;
                        flex-direction: column;
                        justify-content: flex-start;
                        padding: clamp(15px, 3vw, 20px);
                        box-sizing: border-box;
                        min-height: 350px;
                        height: 100%;
                    ">
                        <!-- Background Effects -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%);
                            z-index: 1;
                        "></div>

                        <!-- Probability Badge -->
                        <div style="
                            position: absolute;
                            top: 15px;
                            right: 15px;
                            background: ${probabilityColor};
                            color: #000;
                            padding: 8px 15px;
                            border-radius: 15px;
                            font-weight: 900;
                            font-size: 1.4rem;
                            z-index: 10;
                            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                        ">${probabilityValue}%</div>

                        <!-- Player Name -->
                        <div style="
                            position: relative;
                            z-index: 5;
                            text-align: center;
                            margin-top: 5px;
                            padding: 0 10px;
                            min-height: 60px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        ">
                            <h3 style="
                                color: #ffffff;
                                font-size: clamp(1.2rem, 2.5vw, 1.6rem);
                                font-weight: 800;
                                margin: 0;
                                text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
                                line-height: 1.3;
                                word-wrap: break-word;
                                text-align: center;
                                overflow-wrap: break-word;
                                hyphens: auto;
                            ">${player.arabicName || player.name}</h3>
                        </div>

                        <!-- Player Image -->
                        <div style="
                            position: relative;
                            z-index: 5;
                            text-align: center;
                            margin: 10px 0;
                            flex: 0 0 auto;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            min-height: 100px;
                        ">
                            <img src="${player.imageUrl}" alt="${player.name}" style="
                                width: clamp(80px, 15vw, 110px);
                                height: clamp(80px, 15vw, 110px);
                                border-radius: 50%;
                                border: 3px solid rgba(255,255,255,0.3);
                                box-shadow: 0 8px 25px rgba(0,0,0,0.4);
                                object-fit: cover;
                            " onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(player.arabicName || player.name)}&size=110&background=667eea&color=fff&bold=true&format=png'">
                        </div>

                        <!-- Club Transfer Info -->
                        <div style="
                            position: relative;
                            z-index: 5;
                            text-align: center;
                            margin: 10px 0;
                            flex: 1 1 auto;
                            display: flex;
                            flex-direction: column;
                            justify-content: center;
                            min-height: 120px;
                        ">
                            <div style="
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: clamp(8px, 2vw, 15px);
                                margin-bottom: 8px;
                                flex-wrap: wrap;
                            ">
                                <!-- Current Club -->
                                <div style="
                                    text-align: center;
                                    flex: 0 0 auto;
                                    min-width: 60px;
                                ">
                                    <img src="${player.currentClubLogo}" alt="${player.currentClub}" style="
                                        width: clamp(30px, 6vw, 40px);
                                        height: clamp(30px, 6vw, 40px);
                                        border-radius: 6px;
                                        border: 2px solid rgba(255,255,255,0.3);
                                        background: rgba(255,255,255,0.1);
                                        padding: 2px;
                                        object-fit: contain;
                                    " onerror="this.style.display='none'">
                                    <p style="
                                        color: rgba(255,255,255,0.9);
                                        font-size: clamp(0.7rem, 1.5vw, 0.85rem);
                                        margin: 3px 0 0 0;
                                        font-weight: 600;
                                        line-height: 1.2;
                                        overflow: hidden;
                                        text-overflow: ellipsis;
                                        white-space: nowrap;
                                        max-width: 80px;
                                    ">${player.currentClub}</p>
                                </div>

                                <!-- Beautiful Modern Arrow -->
                                <div style="
                                    position: relative;
                                    flex: 0 0 auto;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    width: clamp(50px, 10vw, 80px);
                                    height: clamp(35px, 7vw, 50px);
                                    margin: 0 10px;
                                ">
                                    <!-- Arrow Container -->
                                    <div style="
                                        position: relative;
                                        width: 100%;
                                        height: 100%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        background: linear-gradient(135deg, ${probabilityColor}15, ${probabilityColor}25);
                                        border-radius: 25px;
                                        border: 2px solid ${probabilityColor}40;
                                        backdrop-filter: blur(10px);
                                        box-shadow:
                                            0 8px 25px rgba(0, 0, 0, 0.3),
                                            0 0 20px ${probabilityColor}30,
                                            inset 0 1px 0 rgba(255, 255, 255, 0.2);
                                        animation: arrowContainerGlow 3s ease-in-out infinite;
                                    ">
                                        <!-- Arrow SVG -->
                                        <svg width="24" height="16" viewBox="0 0 24 16" style="
                                            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.4));
                                        ">
                                            <defs>
                                                <linearGradient id="arrowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                    <stop offset="0%" style="stop-color:${probabilityColor};stop-opacity:0.8" />
                                                    <stop offset="50%" style="stop-color:${probabilityColor};stop-opacity:1" />
                                                    <stop offset="100%" style="stop-color:${probabilityColor};stop-opacity:0.8" />
                                                </linearGradient>
                                            </defs>
                                            <path d="M22 8 L8 8 M12 4 L8 8 L12 12"
                                                  stroke="url(#arrowGradient)"
                                                  stroke-width="2.5"
                                                  fill="none"
                                                  stroke-linecap="round"
                                                  stroke-linejoin="round"
                                                  style="animation: arrowDraw 2s ease-in-out infinite;" />
                                        </svg>

                                        <!-- Sparkle Effects -->
                                        <div style="
                                            position: absolute;
                                            top: 20%;
                                            right: 15%;
                                            width: 4px;
                                            height: 4px;
                                            background: ${probabilityColor};
                                            border-radius: 50%;
                                            animation: sparkle1 2s ease-in-out infinite;
                                        "></div>
                                        <div style="
                                            position: absolute;
                                            bottom: 25%;
                                            left: 20%;
                                            width: 3px;
                                            height: 3px;
                                            background: ${probabilityColor};
                                            border-radius: 50%;
                                            animation: sparkle2 2.5s ease-in-out infinite;
                                        "></div>
                                    </div>
                                </div>

                                <!-- Target Club -->
                                <div style="
                                    text-align: center;
                                    flex: 0 0 auto;
                                    min-width: 60px;
                                ">
                                    <img src="${player.targetClubLogo}" alt="${player.targetClub}" style="
                                        width: clamp(30px, 6vw, 40px);
                                        height: clamp(30px, 6vw, 40px);
                                        border-radius: 6px;
                                        border: 2px solid ${probabilityColor};
                                        background: rgba(255,255,255,0.1);
                                        padding: 2px;
                                        box-shadow: 0 0 10px ${probabilityColor}40;
                                        object-fit: contain;
                                    " onerror="this.style.display='none'">
                                    <p style="
                                        color: ${probabilityColor};
                                        font-size: clamp(0.7rem, 1.5vw, 0.85rem);
                                        margin: 3px 0 0 0;
                                        font-weight: 700;
                                        line-height: 1.2;
                                        overflow: hidden;
                                        text-overflow: ellipsis;
                                        white-space: nowrap;
                                        max-width: 80px;
                                    ">${player.targetClub}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Info -->
                        <div style="
                            position: relative;
                            z-index: 5;
                            text-align: center;
                            margin-top: auto;
                            flex: 0 0 auto;
                        ">
                            <div style="
                                background: rgba(0,0,0,0.4);
                                border-radius: 8px;
                                padding: 6px 10px;
                                margin-top: 8px;
                                border: 1px solid rgba(255,255,255,0.1);
                            ">
                                <p style="
                                    color: rgba(255,255,255,0.9);
                                    font-size: clamp(0.7rem, 1.4vw, 0.8rem);
                                    margin: 0;
                                    font-weight: 600;
                                    line-height: 1.3;
                                ">Ø§Ù„Ø¹Ù…Ø±: ${player.age || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Preview Layout Function
            previewLayout() {
                const playersInputs = document.querySelectorAll('.multi-player-input');
                const playersCount = Array.from(playersInputs).filter(input => input.value.trim()).length;

                if (playersCount === 0) {
                    this.showNotification('âš ï¸ Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØ®Ø·ÙŠØ·', 'warning');
                    return;
                }

                const layoutConfig = this.getSmartLayoutConfig(playersCount);

                const previewHTML = `
                    <div style="
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.9);
                        z-index: 10000;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        backdrop-filter: blur(10px);
                    " onclick="this.remove()">
                        <div style="
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            padding: 40px;
                            border-radius: 20px;
                            text-align: center;
                            max-width: 600px;
                            color: white;
                            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                        " onclick="event.stopPropagation()">
                            <h2 style="margin-bottom: 20px; font-size: 2rem;">ðŸ“ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØ®Ø·ÙŠØ·</h2>
                            <div style="
                                background: rgba(255, 255, 255, 0.1);
                                padding: 20px;
                                border-radius: 15px;
                                margin: 20px 0;
                                border: 2px solid rgba(255, 255, 255, 0.3);
                            ">
                                <h3 style="color: #ffff00; margin-bottom: 15px;">
                                    ${playersCount} Ù„Ø§Ø¹Ø¨
                                </h3>
                                <p style="font-size: 1.2rem; margin-bottom: 10px;">
                                    ${layoutConfig.description}
                                </p>
                                <div style="
                                    display: grid;
                                    grid-template-columns: repeat(2, 1fr);
                                    gap: 15px;
                                    margin-top: 20px;
                                    text-align: left;
                                ">
                                    <div>ðŸ“ <strong>Ø­Ø¬Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©:</strong> ${layoutConfig.cardSize}</div>
                                    <div>ðŸ“ <strong>Ø§Ù„Ù…Ø³Ø§ÙØ©:</strong> ${layoutConfig.gap}</div>
                                    <div>ðŸ“Š <strong>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚ØµÙ‰:</strong> ${layoutConfig.maxWidth}</div>
                                    <div>ðŸŽ¯ <strong>Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:</strong> ${layoutConfig.columns}</div>
                                </div>
                            </div>
                            <button onclick="this.parentElement.parentElement.remove()" style="
                                background: rgba(255, 255, 255, 0.2);
                                border: 2px solid rgba(255, 255, 255, 0.5);
                                color: white;
                                padding: 12px 30px;
                                border-radius: 10px;
                                font-size: 1.1rem;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'">
                                âœ… ÙÙ‡Ù…Øª
                            </button>
                        </div>
                    </div>
                `;

                document.body.insertAdjacentHTML('beforeend', previewHTML);
                this.showNotification(`ðŸ“ Ù…Ø¹Ø§ÙŠÙ†Ø© ØªØ®Ø·ÙŠØ· ${playersCount} Ù„Ø§Ø¹Ø¨ÙŠÙ†`, 'info');
            }

            createMultiAllVisualizationHTML(playersData, targetClub) {
                const averageProbability = playersData.reduce((sum, player) =>
                    sum + player.probability.percentage, 0) / playersData.length;

                const probabilityColor = this.getProbabilityColor(averageProbability);

                return `
                    <div class="multi-visualization" style="
                        width: 100%;
                        height: 100%;
                        position: relative;
                        background: radial-gradient(circle at center, #0a0a0f 0%, #1a0b2e 100%);
                        overflow-y: auto;
                        padding: 20px;
                    ">
                        <!-- Particle Canvas -->
                        <canvas id="particleCanvas" style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            z-index: 1;
                        "></canvas>



                            <!-- Average Probability -->
                            <div style="
                                display: inline-block;
                                background: rgba(255, 255, 255, 0.1);
                                backdrop-filter: blur(20px);
                                border: 2px solid ${probabilityColor};
                                border-radius: 15px;
                                padding: 15px 25px;
                                margin-bottom: 30px;
                            ">
                                <span style="
                                    font-size: 1.5rem;
                                    font-weight: 700;
                                    color: ${probabilityColor};
                                ">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©: ${Math.round(averageProbability)}%</span>
                            </div>
                        </div>

                        <!-- Players Grid -->
                        <div style="
                            position: relative;
                            z-index: 10;
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                            gap: 20px;
                            max-width: 1200px;
                            margin: 0 auto;
                        ">
                            ${playersData.map((player, index) => this.createPlayerCard(player, index)).join('')}
                        </div>

                        <!-- Control Panel -->
                        <div style="
                            position: relative;
                            z-index: 10;
                            text-align: center;
                            margin-top: 30px;
                        ">
                            <button onclick="ultimateStudio.stopSequence()" style="
                                background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                                border: none;
                                border-radius: 15px;
                                padding: 15px 30px;
                                color: white;
                                font-weight: 700;
                                font-size: 1.1rem;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform='translateY(0)'">
                                <i class="fas fa-stop me-2"></i>
                                Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶
                            </button>
                        </div>
                    </div>
                `;
            }

            createPlayerCard(player, index) {
                const probabilityColor = this.getProbabilityColor(player.probability.percentage);
                const delay = index * 0.2;

                return `
                    <div class="player-card" style="
                        background: rgba(255, 255, 255, 0.08);
                        backdrop-filter: blur(20px);
                        border: 2px solid rgba(255, 255, 255, 0.15);
                        border-radius: 20px;
                        padding: 25px;
                        text-align: center;
                        animation: cardEntrance 0.8s ease-out ${delay}s both;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.transform='translateY(-10px)'; this.style.borderColor='${probabilityColor}'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='rgba(255, 255, 255, 0.15)'">

                        <!-- Player Image -->
                        <div style="
                            position: relative;
                            display: inline-block;
                            margin-bottom: 20px;
                        ">
                            <img src="${this.getPlayerImageUrl(player)}"
                                 alt="${player.arabicName}"
                                 class="player-image"
                                 style="
                                    width: ${this.settings.playerImageSize || 150}px;
                                    height: ${this.settings.playerImageSize || 150}px;
                                    border-radius: 50%;
                                    border: 3px solid ${probabilityColor};
                                    object-fit: cover;
                                    box-shadow: 0 0 20px ${probabilityColor}40;
                                    transition: all 0.3s ease;
                                 "
                                 onerror="this.src='${this.getFallbackImageUrl(player.arabicName)}'">

                            <!-- Probability Badge -->
                            <div style="
                                position: absolute;
                                top: -10px;
                                right: -10px;
                                background: ${probabilityColor};
                                color: white;
                                border-radius: 50%;
                                width: 40px;
                                height: 40px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-weight: 900;
                                font-size: 0.9rem;
                                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
                            ">${player.probability.percentage}%</div>
                        </div>

                        <!-- Player Info -->
                        <h3 style="
                            font-size: 1.3rem;
                            font-weight: 700;
                            color: white;
                            margin-bottom: 10px;
                        ">${player.arabicName}</h3>

                        <p style="
                            font-size: 1rem;
                            color: rgba(255, 255, 255, 0.7);
                            margin-bottom: 15px;
                        ">${player.currentClub}</p>

                        <!-- Probability Bar -->
                        <div style="
                            background: rgba(255, 255, 255, 0.1);
                            border-radius: 10px;
                            height: 8px;
                            margin-bottom: 15px;
                            overflow: hidden;
                        ">
                            <div style="
                                background: linear-gradient(90deg, ${probabilityColor}, #ffffff);
                                height: 100%;
                                width: ${player.probability.percentage}%;
                                border-radius: 10px;
                                animation: progressFill 1.5s ease-out ${delay + 0.5}s both;
                            "></div>
                        </div>

                        <!-- Trend -->
                        <div style="
                            font-size: 0.9rem;
                            color: ${probabilityColor};
                            font-weight: 600;
                        ">${player.probability.trend}</div>
                    </div>
                `;
            }

            // ðŸ”— Player Data Extraction Functions
            initializeExtractMode() {
                console.log('ðŸ”— Initializing Extract Mode...');
                this.showNotification('ðŸ”— Ù†Ù…Ø· Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²', 'info');
            }

            async extractPlayerData() {
                const urlInput = document.getElementById('playerPageUrl');
                const targetClubInput = document.getElementById('extractTargetClub');
                const extractBtn = document.getElementById('extractBtn');
                const resultsDiv = document.getElementById('extractionResults');

                if (!urlInput.value.trim()) {
                    this.showNotification('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµÙØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨', 'warning');
                    urlInput.focus();
                    return;
                }

                // Validate URL
                try {
                    new URL(urlInput.value);
                } catch {
                    this.showNotification('âŒ Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                    urlInput.focus();
                    return;
                }

                // Show loading state
                extractBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬...';
                extractBtn.disabled = true;
                resultsDiv.style.display = 'none';

                try {
                    const response = await fetch('/api/extract-player-data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            url: urlInput.value.trim(),
                            targetClub: targetClubInput.value.trim()
                        })
                    });

                    const result = await response.json();

                    if (result.success) {
                        this.displayExtractionResults(result.data);
                        this.showNotification('âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    } else {
                        throw new Error(result.error || 'ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                    }

                } catch (error) {
                    console.error('âŒ Extraction error:', error);
                    this.showNotification(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬: ${error.message}`, 'error');
                } finally {
                    extractBtn.innerHTML = '<i class="fas fa-download"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹';
                    extractBtn.disabled = false;
                }
            }

            displayExtractionResults(data) {
                const resultsDiv = document.getElementById('extractionResults');
                const dataDiv = document.getElementById('extractedData');

                dataDiv.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨:</strong><br>
                            <span>${data.arabicName || data.englishName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong><br>
                            <span>${data.currentClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong><br>
                            <span>${data.targetClub || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ©:</strong><br>
                            <span>${data.marketValue || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ù„Ø¹Ù…Ø±:</strong><br>
                            <span>${data.age || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ù„Ù…Ø±ÙƒØ²:</strong><br>
                            <span>${data.position || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„:</strong><br>
                            <span style="color: #10b981; font-weight: bold;">${data.probability}%</span>
                        </div>
                        <div>
                            <strong style="color: #3b82f6;">Ø±Ø³ÙˆÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„:</strong><br>
                            <span>${data.transferFee || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                    </div>
                    <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 10px;">
                        <i class="fas fa-info-circle"></i>
                        ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù†: ${data.source || 'Ù…ØµØ¯Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'} |
                        ${new Date(data.extractedAt).toLocaleString('ar-SA')}
                    </div>
                `;

                // Store extracted data for later use
                this.extractedPlayerData = data;
                resultsDiv.style.display = 'block';
            }

            useExtractedData() {
                if (!this.extractedPlayerData) {
                    this.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø±Ø¬Ø©', 'error');
                    return;
                }

                const data = this.extractedPlayerData;

                // Fill manual input fields
                document.getElementById('playerName').value = data.arabicName || data.englishName || '';
                document.getElementById('currentClub').value = data.currentClub || '';
                document.getElementById('targetClub').value = data.targetClub || '';
                document.getElementById('transferFee').value = data.transferFee || '';

                // Switch to manual mode
                document.getElementById('inputMode').value = 'manual';
                this.switchMode('manual');

                this.showNotification('âœ… ØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù…Ø· Ø§Ù„ÙŠØ¯ÙˆÙŠ', 'success');
            }

            editExtractedData() {
                if (!this.extractedPlayerData) {
                    this.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø±Ø¬Ø©', 'error');
                    return;
                }

                // Switch to manual mode and fill data for editing
                this.useExtractedData();
                this.showNotification('ðŸ“ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù†Ù…Ø· Ø§Ù„ÙŠØ¯ÙˆÙŠ', 'info');
            }

            loadExample(type) {
                const examples = {
                    'salah': {
                        url: 'https://www.transfermarkt.com/mohamed-salah/profil/spieler/148455',
                        targetClub: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯'
                    },
                    'mbappe': {
                        url: 'https://www.transfermarkt.com/kylian-mbappe/profil/spieler/342229',
                        targetClub: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„'
                    }
                };

                const example = examples[type];
                if (example) {
                    document.getElementById('playerPageUrl').value = example.url;
                    document.getElementById('extractTargetClub').value = example.targetClub;
                    this.showNotification(`ðŸ“ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø«Ø§Ù„ ${type === 'salah' ? 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­' : 'Ù…Ø¨Ø§Ø¨ÙŠ'}`, 'info');
                }
            }
        }

        // Initialize Ultimate Studio
        const ultimateStudio = new UltimateStudio();
        console.log('ðŸŒŸ Ultimate Studio V4 - Ready for World-Class Creativity!');

        // ðŸŽ¬ Overlay Integration System
        class OverlayIntegration {
            constructor() {
                this.ws = null;
                this.overlayId = null;
                this.token = null;
                this.isConnected = false;
                this.reconnectAttempts = 0;
                this.maxReconnectAttempts = 5;

                this.init();
            }

            init() {
                this.generateCredentials();
                this.updateUI();
                console.log('ðŸŽ¬ Overlay Integration initialized');
            }

            generateCredentials() {
                this.overlayId = 'studio_' + Math.random().toString(36).substr(2, 9);
                this.token = 'token_' + Math.random().toString(36).substr(2, 16);
            }

            updateUI() {
                const baseUrl = window.location.origin.replace('8201', '8202'); // Use overlay server port
                const outputUrl = `${baseUrl}/obs-overlay.html?id=${this.overlayId}&token=${this.token}`;

                document.getElementById('obsOutputUrl').value = outputUrl;
                document.getElementById('overlayToken').value = this.token;
            }

            connectToOverlay() {
                try {
                    const wsUrl = `ws://localhost:8202/control-ws?id=${this.overlayId}&token=${this.token}`;
                    this.ws = new WebSocket(wsUrl);

                    this.ws.onopen = () => {
                        console.log('ðŸ”— Overlay WebSocket connected');
                        this.isConnected = true;
                        this.updateConnectionStatus(true);
                        this.reconnectAttempts = 0;
                        ultimateStudio.showNotification('âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ Overlay Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    };

                    this.ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        console.log('ðŸ“¨ Overlay message received:', data);
                    };

                    this.ws.onclose = () => {
                        console.log('ðŸ”Œ Overlay WebSocket disconnected');
                        this.isConnected = false;
                        this.updateConnectionStatus(false);
                        this.attemptReconnect();
                    };

                    this.ws.onerror = (error) => {
                        console.error('âŒ Overlay WebSocket error:', error);
                        this.isConnected = false;
                        this.updateConnectionStatus(false);
                        ultimateStudio.showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ Overlay', 'error');
                    };

                } catch (error) {
                    console.error('âŒ Failed to connect to Overlay:', error);
                    ultimateStudio.showNotification('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ Overlay', 'error');
                }
            }

            attemptReconnect() {
                if (this.reconnectAttempts < this.maxReconnectAttempts) {
                    this.reconnectAttempts++;
                    console.log(`ðŸ”„ Attempting to reconnect to Overlay... ${this.reconnectAttempts}`);
                    setTimeout(() => this.connectToOverlay(), 3000);
                }
            }

            updateConnectionStatus(connected) {
                const indicator = document.getElementById('overlayConnectionStatus');
                const text = document.getElementById('overlayConnectionText');

                if (connected) {
                    indicator.classList.add('connected');
                    text.textContent = 'Ù…ØªØµÙ„ Ø¨Ø§Ù„Ù€ Overlay';
                } else {
                    indicator.classList.remove('connected');
                    text.textContent = 'ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ù€ Overlay';
                }
            }

            sendCommand(type, data = {}) {
                if (this.ws && this.ws.readyState === WebSocket.OPEN) {
                    const message = {
                        type,
                        overlayId: this.overlayId,
                        token: this.token,
                        timestamp: Date.now(),
                        ...data
                    };

                    this.ws.send(JSON.stringify(message));
                    console.log('ðŸ“¤ Sent to Overlay:', message);
                    return true;
                } else {
                    ultimateStudio.showNotification('âŒ ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ù€ Overlay', 'error');
                    return false;
                }
            }

            sendCurrentPlayer() {
                // Get current player data from the form
                const playerData = this.getCurrentPlayerData();

                if (playerData && this.sendCommand('showPlayer', { playerData })) {
                    ultimateStudio.showNotification('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù€ Overlay', 'success');
                } else {
                    ultimateStudio.showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø¹Ø¨ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§', 'warning');
                }
            }

            hidePlayer() {
                if (this.sendCommand('hidePlayer')) {
                    ultimateStudio.showNotification('âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù† Ø§Ù„Ù€ Overlay', 'success');
                }
            }

            getCurrentPlayerData() {
                // Get data from the current form
                const arabicName = document.getElementById('arabicName')?.value;
                const currentClub = document.getElementById('currentClub')?.value;
                const targetClub = document.getElementById('targetClub')?.value;
                const probability = document.getElementById('probability')?.value;
                const transferFee = document.getElementById('transferFee')?.value;

                if (!arabicName || !currentClub || !targetClub) {
                    return null;
                }

                return {
                    arabicName: arabicName || 'Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    currentClub: currentClub || 'Ù†Ø§Ø¯ÙŠ ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    targetClub: targetClub || 'Ù†Ø§Ø¯ÙŠ ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    probability: probability || '50',
                    transferFee: transferFee || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
                };
            }

            testConnection() {
                if (this.isConnected) {
                    ultimateStudio.showNotification('âœ… Ø§Ù„Ø§ØªØµØ§Ù„ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ', 'success');
                } else {
                    ultimateStudio.showNotification('âŒ ØºÙŠØ± Ù…ØªØµÙ„ - Ø¬Ø±Ø¨ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
                }
            }

            openControlPanel() {
                const controlUrl = window.location.origin.replace('8201', '8202') + '/overlay-control';
                window.open(controlUrl, '_blank');
            }
        }

        // ðŸŽ¬ Initialize Overlay Integration
        const overlayIntegration = new OverlayIntegration();

        // ðŸŽ¯ Global Functions for Overlay Control
        function connectToOverlay() {
            overlayIntegration.connectToOverlay();
        }

        function sendCurrentPlayerToOverlay() {
            overlayIntegration.sendCurrentPlayer();
        }

        function hideOverlayPlayer() {
            overlayIntegration.hidePlayer();
        }

        function testOverlayConnection() {
            overlayIntegration.testConnection();
        }

        function openOverlayControl() {
            overlayIntegration.openControlPanel();
        }

        function copyOverlayUrl() {
            const urlInput = document.getElementById('obsOutputUrl');
            const url = urlInput.value;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ OBS', 'success');
                }).catch(() => {
                    // Fallback
                    urlInput.select();
                    document.execCommand('copy');
                    ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ OBS', 'success');
                });
            } else {
                urlInput.select();
                document.execCommand('copy');
                ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ OBS', 'success');
            }
        }

        function copyOverlayToken() {
            const tokenInput = document.getElementById('overlayToken');
            const token = tokenInput.value;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(token).then(() => {
                    ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù€ Token', 'success');
                }).catch(() => {
                    // Fallback
                    tokenInput.select();
                    document.execCommand('copy');
                    ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù€ Token', 'success');
                });
            } else {
                tokenInput.select();
                document.execCommand('copy');
                ultimateStudio.showNotification('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù€ Token', 'success');
            }
        }

        // ðŸŽ¯ Auto-send functionality
        function checkAutoSendToOverlay() {
            const autoSend = document.getElementById('autoSendToOverlay');
            if (autoSend && autoSend.checked && overlayIntegration.isConnected) {
                setTimeout(() => {
                    overlayIntegration.sendCurrentPlayer();
                }, 1000); // Wait 1 second after card creation
            }
        }

        // ðŸŽ¯ Expose for debugging
        window.overlayIntegration = overlayIntegration;














        // ðŸŽ¬ Global Stream Variables - Initialize at top
        var isStreamingActive = false;
        var streamUrl = 'http://localhost:8201/ultimate-stream-overlay';

        console.log('ðŸŽ¬ Ultimate Studio V4 Streaming System loading...');

        // ðŸŽ¯ Enhanced Stream Functions
        function startSimpleStream() {
            console.log('ðŸŽ¬ startSimpleStream called, current state:', isStreamingActive);

            try {
                // Toggle streaming state
                isStreamingActive = !isStreamingActive;

                console.log('ðŸ”„ New streaming state:', isStreamingActive);

                // Update UI immediately
                updateStreamUI();

                // Store stream state
                localStorage.setItem('streamingActive', isStreamingActive.toString());

                // Notify stream overlay about state change
                notifyStreamOverlay();

                // Show enhanced notification
                const message = isStreamingActive ?
                    'ðŸ”´ ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª' :
                    'â¹ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø« - ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±';
                const type = isStreamingActive ? 'success' : 'info';

                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, type);
                } else {
                    console.log(message);
                    alert(message);
                }

                // Auto-clear stream content when stopping
                if (!isStreamingActive) {
                    clearStream();
                }

                console.log('âœ… Stream toggle successful, active:', isStreamingActive);

            } catch (error) {
                console.error('âŒ Error in startSimpleStream:', error);
                const errorMsg = 'Ø®Ø·Ø£ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø«: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }
            }
        }

        // ðŸ”” Notify stream overlay about state changes
        function notifyStreamOverlay() {
            try {
                // Store stream state for overlay
                localStorage.setItem('streamingActive', isStreamingActive.toString());
                localStorage.setItem('streamStateChanged', Date.now().toString());

                // Dispatch custom event for real-time updates
                window.dispatchEvent(new CustomEvent('streamStateChanged', {
                    detail: { active: isStreamingActive, timestamp: Date.now() }
                }));

                console.log('ðŸ“¡ Stream overlay notified, state:', isStreamingActive);
            } catch (error) {
                console.error('âŒ Error notifying stream overlay:', error);
            }
        }

        function updateStreamUI() {
            console.log('ðŸ”„ Updating stream UI, active:', isStreamingActive);

            try {
                const indicator = document.getElementById('simpleStreamStatus');
                const text = document.getElementById('simpleStreamText');
                const button = document.getElementById('simpleStreamBtn');

                console.log('ðŸ” UI Elements found:', {
                    indicator: !!indicator,
                    text: !!text,
                    button: !!button
                });

                if (!indicator || !text || !button) {
                    console.error('âŒ Stream UI elements not found');
                    console.error('Missing elements:', {
                        indicator: !indicator ? 'simpleStreamStatus' : 'found',
                        text: !text ? 'simpleStreamText' : 'found',
                        button: !button ? 'simpleStreamBtn' : 'found'
                    });
                    return;
                }

                if (isStreamingActive) {
                    indicator.classList.add('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± <span style="color: #ff0000;">ðŸ”´</span>';
                    button.innerHTML = '<i class="fas fa-stop"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-danger-ultimate';
                    button.style.background = 'linear-gradient(135deg, #ff4757, #ff3838)';
                    console.log('âœ… UI updated to streaming ON');
                } else {
                    indicator.classList.remove('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…ØªÙˆÙ‚Ù <span style="color: #888;">âš«</span>';
                    button.innerHTML = '<i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-success-ultimate';
                    button.style.background = 'linear-gradient(135deg, #2ed573, #1e90ff)';
                    console.log('âœ… UI updated to streaming OFF');
                }

                // Update URL input to ensure it's correct
                const urlInput = document.getElementById('simpleStreamUrl');
                if (urlInput && urlInput.value !== streamUrl) {
                    urlInput.value = streamUrl;
                }

                console.log('âœ… Stream UI updated successfully');

            } catch (error) {
                console.error('âŒ Error updating stream UI:', error);
                const errorMsg = 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø«: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }
            }
        }

        function showPlayerInSimpleStream() {
            console.log('ðŸŽ¬ showPlayerInSimpleStream called');

            try {
                // Check if streaming is active
                if (!isStreamingActive) {
                    const message = 'âš ï¸ ÙŠØ¬Ø¨ Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†';
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification(message, 'warning');
                    } else {
                        alert(message);
                    }
                    return;
                }

                // Get current player data
                const playerData = getCurrentPlayerData();

                if (!playerData || !playerData.arabicName) {
                    const message = 'âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø¹Ø¨ Ù„Ø¹Ø±Ø¶Ù‡Ø§ - ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹';
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification(message, 'warning');
                    } else {
                        alert(message);
                    }
                    return;
                }

                // Enhanced player data with timestamp
                const enhancedPlayerData = {
                    ...playerData,
                    timestamp: Date.now(),
                    streamId: 'ultimate-studio-v4',
                    action: 'show'
                };

                // Store in localStorage for stream overlay
                localStorage.setItem('currentStreamPlayer', JSON.stringify(enhancedPlayerData));
                localStorage.setItem('playerDisplayChanged', Date.now().toString());

                // Dispatch custom event for real-time updates
                window.dispatchEvent(new CustomEvent('playerDisplayChanged', {
                    detail: { action: 'show', player: enhancedPlayerData }
                }));

                const message = `âœ… ØªÙ… Ø¹Ø±Ø¶ ${playerData.arabicName} ÙÙŠ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±`;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'success');
                } else {
                    console.log(message);
                }

                console.log('âœ… Player sent to stream:', playerData.arabicName);

            } catch (error) {
                console.error('âŒ Error showing player in stream:', error);
                const errorMsg = 'Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }
            }
        }

        function hidePlayerFromSimpleStream() {
            console.log('ðŸŽ¬ hidePlayerFromSimpleStream called');

            try {
                // Remove from localStorage
                localStorage.removeItem('currentStreamPlayer');
                localStorage.setItem('playerDisplayChanged', Date.now().toString());

                // Dispatch custom event for real-time updates
                window.dispatchEvent(new CustomEvent('playerDisplayChanged', {
                    detail: { action: 'hide', timestamp: Date.now() }
                }));

                const message = 'âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±';
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'success');
                } else {
                    console.log(message);
                }

                console.log('âœ… Player hidden from stream');

            } catch (error) {
                console.error('âŒ Error hiding player from stream:', error);
                const errorMsg = 'Ø®Ø·Ø£ ÙÙŠ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }
            }
        }

        function openSimpleStream() {
            console.log('ðŸŽ¬ openSimpleStream called');
            console.log('ðŸ”— Stream URL:', streamUrl);

            try {
                // Enhanced stream window opening with better settings
                const streamWindow = window.open(
                    streamUrl,
                    'UltimateStudioStream',
                    'width=1920,height=1080,scrollbars=yes,resizable=yes,location=no,menubar=no,toolbar=no,status=no,titlebar=no'
                );

                if (streamWindow) {
                    console.log('âœ… Stream window opened successfully');

                    // Store window reference for future use
                    window.streamWindowRef = streamWindow;

                    const message = 'âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ø¨Ø« ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© - Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ OBS';
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification(message, 'success');
                    } else {
                        console.log(message);
                        alert(message);
                    }

                    // Focus on new window and setup
                    setTimeout(() => {
                        try {
                            streamWindow.focus();

                            // Send current stream state to the new window
                            if (isStreamingActive) {
                                streamWindow.postMessage({
                                    type: 'streamState',
                                    active: true,
                                    timestamp: Date.now()
                                }, '*');
                            }

                            console.log('âœ… Stream window focused and configured');
                        } catch (e) {
                            console.log('âš ï¸ Could not configure stream window:', e);
                        }
                    }, 1000);

                    // Monitor window status
                    const checkWindow = setInterval(() => {
                        try {
                            if (streamWindow.closed) {
                                console.log('ðŸ“º Stream window was closed');
                                clearInterval(checkWindow);
                                window.streamWindowRef = null;
                            }
                        } catch (e) {
                            clearInterval(checkWindow);
                        }
                    }, 2000);

                } else {
                    console.error('âŒ Failed to open stream window - likely blocked by popup blocker');

                    // Try alternative method - create a link and click it
                    const link = document.createElement('a');
                    link.href = streamUrl;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    const message = 'ðŸ”— ØªÙ… ÙØªØ­ Ø§Ù„Ø¨Ø« ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯ (Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø©)';
                    if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                        window.ultimateStudio.showNotification(message, 'info');
                    } else {
                        alert(message);
                    }
                }

            } catch (error) {
                console.error('âŒ Error opening stream:', error);
                const errorMsg = 'âŒ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ø§Ù„Ø¨Ø«: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }

                // Fallback - show URL to user
                const fallbackMessage = `ÙŠÙ…ÙƒÙ†Ùƒ ÙØªØ­ Ø§Ù„Ø¨Ø« ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:\n${streamUrl}`;
                alert(fallbackMessage);
            }
        }

        function clearStream() {
            console.log('ðŸŽ¬ clearStream called');

            try {
                // Clear localStorage
                localStorage.removeItem('currentStreamPlayer');

                const message = 'ðŸ§¹ ØªÙ… Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø«';
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'info');
                } else {
                    console.log(message);
                }

                console.log('âœ… Stream data cleared');

            } catch (error) {
                console.error('âŒ Error clearing stream:', error);
                alert('Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨Ø«: ' + error.message);
            }
        }

        function getCurrentPlayerData() {
            try {
                console.log('ðŸ” Getting current player data...');

                // Try different possible input IDs
                const possibleIds = {
                    arabicName: ['arabicName', 'playerName', 'name'],
                    currentClub: ['currentClub', 'fromClub', 'club1'],
                    targetClub: ['targetClub', 'toClub', 'club2'],
                    probability: ['probability', 'transferProbability', 'prob'],
                    transferFee: ['transferFee', 'fee', 'price']
                };

                const playerData = {};

                // Try to find each field
                for (const [field, ids] of Object.entries(possibleIds)) {
                    let value = '';
                    for (const id of ids) {
                        const element = document.getElementById(id);
                        if (element && element.value && element.value.trim()) {
                            value = element.value.trim();
                            console.log(`âœ… Found ${field} in element ${id}:`, value);
                            break;
                        }
                    }
                    playerData[field] = value;
                }

                console.log('ðŸ” Collected player data:', playerData);

                // Check if we have minimum required data
                if (!playerData.arabicName && !playerData.currentClub && !playerData.targetClub) {
                    console.log('âš ï¸ No player data found in any input fields');

                    // Try to get data from visible card if exists
                    const visibleCard = document.querySelector('.fifa-card:not([style*="display: none"])');
                    if (visibleCard) {
                        console.log('ðŸ” Trying to extract data from visible card...');
                        const nameEl = visibleCard.querySelector('.player-name, h2, .name');
                        const clubsEl = visibleCard.querySelector('.clubs-info, .club-info');

                        if (nameEl) {
                            playerData.arabicName = nameEl.textContent.trim();
                            console.log('âœ… Extracted name from card:', playerData.arabicName);
                        }

                        if (clubsEl) {
                            const clubText = clubsEl.textContent;
                            const clubs = clubText.split('â†’').map(c => c.trim());
                            if (clubs.length >= 2) {
                                playerData.currentClub = clubs[0];
                                playerData.targetClub = clubs[1];
                                console.log('âœ… Extracted clubs from card:', clubs);
                            }
                        }
                    }
                }

                // Set defaults for missing data
                const finalData = {
                    arabicName: playerData.arabicName || 'Ù„Ø§Ø¹Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ',
                    currentClub: playerData.currentClub || 'Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ',
                    targetClub: playerData.targetClub || 'Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù',
                    probability: playerData.probability || '75',
                    transferFee: playerData.transferFee || '50 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ'
                };

                console.log('âœ… Final player data:', finalData);
                return finalData;

            } catch (error) {
                console.error('âŒ Error getting player data:', error);

                // Return default data as fallback
                return {
                    arabicName: 'Ù„Ø§Ø¹Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ',
                    currentClub: 'Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ',
                    targetClub: 'Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù',
                    probability: '75',
                    transferFee: '50 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ'
                };
            }
        }

        function copySimpleStreamUrl() {
            console.log('ðŸ“‹ copySimpleStreamUrl called');

            try {
                const url = streamUrl; // Use the global streamUrl variable
                console.log('ðŸ“‹ Copying URL:', url);

                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(url).then(() => {
                        console.log('âœ… URL copied via clipboard API');
                        const message = 'âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø«';
                        if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                            window.ultimateStudio.showNotification(message, 'success');
                        } else {
                            console.log(message);
                        }
                    }).catch((error) => {
                        console.log('âš ï¸ Clipboard API failed, using fallback:', error);
                        // Fallback method
                        copyToClipboardFallback(url);
                    });
                } else {
                    console.log('âš ï¸ Clipboard API not available, using fallback');
                    copyToClipboardFallback(url);
                }
            } catch (error) {
                console.error('âŒ Error copying URL:', error);
                const message = 'âŒ ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'error');
                } else {
                    alert(message);
                }
            }
        }

        function copyToClipboardFallback(text) {
            try {
                // Create temporary textarea
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                textarea.setSelectionRange(0, 99999);
                document.execCommand('copy');
                document.body.removeChild(textarea);

                const message = 'âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø«';
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'success');
                } else {
                    console.log(message);
                }
            } catch (error) {
                console.error('âŒ Fallback copy failed:', error);
                // Last resort - show the URL to user
                prompt('Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:', text);
            }
        }

        // ðŸŽ¯ Auto-stream functionality
        function checkAutoStreamPlayer() {
            console.log('ðŸŽ¯ checkAutoStreamPlayer called');

            try {
                const autoStream = document.getElementById('autoShowInStream');
                if (!autoStream) {
                    console.log('âš ï¸ Auto stream checkbox not found');
                    return;
                }

                if (autoStream.checked && isStreamingActive) {
                    console.log('âœ… Auto stream conditions met, showing player...');
                    setTimeout(() => {
                        showPlayerInSimpleStream();
                    }, 1000);
                } else {
                    console.log('âš ï¸ Auto stream conditions not met:', {
                        checked: autoStream.checked,
                        streaming: isStreamingActive
                    });
                }
            } catch (error) {
                console.error('âŒ Error in checkAutoStreamPlayer:', error);
            }
        }

        // ðŸŽ¯ Enhanced initialization system
        function initializeStreamSystem() {
            console.log('ðŸŽ¬ Initializing Enhanced Stream System...');

            try {
                // Initialize global variables with proper defaults
                if (typeof isStreamingActive === 'undefined') {
                    window.isStreamingActive = false;
                    console.log('ðŸ”§ Initialized isStreamingActive globally');
                }

                if (typeof streamUrl === 'undefined') {
                    window.streamUrl = 'http://localhost:8201/ultimate-stream-overlay';
                    console.log('ðŸ”§ Initialized streamUrl globally');
                }

                // Load previous stream state if exists
                const savedStreamState = localStorage.getItem('streamingActive');
                if (savedStreamState !== null) {
                    isStreamingActive = savedStreamState === 'true';
                    console.log('ðŸ”„ Restored stream state:', isStreamingActive);
                }

                // Wait for DOM to be fully ready
                setTimeout(() => {
                    // Update UI to current state
                    updateStreamUI();

                    // Set stream URL in input
                    const urlInput = document.getElementById('simpleStreamUrl');
                    if (urlInput) {
                        urlInput.value = streamUrl;
                        console.log('âœ… Stream URL set in input:', streamUrl);
                    } else {
                        console.log('âš ï¸ Stream URL input not found');
                    }

                    // Validate all required elements
                    const requiredElements = [
                        'simpleStreamStatus', 'simpleStreamText', 'simpleStreamBtn',
                        'simpleStreamUrl', 'autoShowInStream'
                    ];

                    const missingElements = [];
                    requiredElements.forEach(id => {
                        const el = document.getElementById(id);
                        if (el) {
                            console.log(`âœ… Element ${id}: found`);
                        } else {
                            console.log(`âŒ Element ${id}: NOT FOUND`);
                            missingElements.push(id);
                        }
                    });

                    if (missingElements.length > 0) {
                        console.warn('âš ï¸ Missing elements:', missingElements);
                    }

                    // Setup periodic state synchronization
                    setInterval(() => {
                        const currentState = localStorage.getItem('streamingActive') === 'true';
                        if (currentState !== isStreamingActive) {
                            console.log('ðŸ”„ Syncing stream state from storage');
                            isStreamingActive = currentState;
                            updateStreamUI();
                        }
                    }, 2000);

                    console.log('âœ… Enhanced Stream System initialized successfully');
                }, 500);

            } catch (error) {
                console.error('âŒ Error initializing stream system:', error);
                const errorMsg = 'Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø«: ' + error.message;
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(errorMsg, 'error');
                } else {
                    alert(errorMsg);
                }
            }
        }

        // ðŸŽ¯ Initialize when DOM is ready - multiple approaches
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeStreamSystem);
            console.log('ðŸ“… Waiting for DOMContentLoaded...');
        } else {
            console.log('ðŸ“… DOM already ready, initializing immediately...');
            initializeStreamSystem();
        }

        // Also try after a delay as backup
        setTimeout(() => {
            console.log('â° Backup initialization after 2 seconds...');
            initializeStreamSystem();
        }, 2000);

        // ðŸŽ¯ Debug functions
        window.debugStream = function() {
            console.log('ðŸ” Stream Debug Info:');
            console.log('- Is streaming:', isStreamingActive);
            console.log('- Stream URL:', streamUrl);

            // Check elements
            const elements = ['simpleStreamStatus', 'simpleStreamText', 'simpleStreamBtn', 'simpleStreamUrl'];
            elements.forEach(id => {
                const el = document.getElementById(id);
                console.log(`- Element ${id}:`, !!el);
                if (el) {
                    console.log(`  - Value/Text:`, el.value || el.textContent || 'N/A');
                }
            });

            // Check player data
            const playerData = getCurrentPlayerData();
            console.log('- Current player data:', playerData);
        };

        // ðŸŽ¯ Enhanced Test Functions
        window.testStreamSystem = function() {
            console.log('ðŸ§ª Testing stream system...');

            console.log('1. Testing variables...');
            console.log('- isStreamingActive:', typeof isStreamingActive, isStreamingActive);
            console.log('- streamUrl:', typeof streamUrl, streamUrl);

            console.log('2. Testing startSimpleStream...');
            try {
                startSimpleStream();
                console.log('âœ… startSimpleStream executed');
            } catch (error) {
                console.error('âŒ startSimpleStream failed:', error);
            }

            setTimeout(() => {
                console.log('3. Testing openSimpleStream...');
                try {
                    openSimpleStream();
                    console.log('âœ… openSimpleStream executed');
                } catch (error) {
                    console.error('âŒ openSimpleStream failed:', error);
                }
            }, 1000);

            setTimeout(() => {
                console.log('4. Testing copySimpleStreamUrl...');
                try {
                    copySimpleStreamUrl();
                    console.log('âœ… copySimpleStreamUrl executed');
                } catch (error) {
                    console.error('âŒ copySimpleStreamUrl failed:', error);
                }
            }, 2000);

            setTimeout(() => {
                console.log('5. Testing showPlayerInSimpleStream...');
                try {
                    showPlayerInSimpleStream();
                    console.log('âœ… showPlayerInSimpleStream executed');
                } catch (error) {
                    console.error('âŒ showPlayerInSimpleStream failed:', error);
                }
            }, 3000);
        };

        // ðŸŽ¯ Quick Fix Function
        window.fixStreamSystem = function() {
            console.log('ðŸ”§ Fixing stream system...');

            // Re-initialize variables
            window.isStreamingActive = false;
            window.streamUrl = 'http://localhost:8201/ultimate-stream-overlay';

            // Re-initialize UI
            initializeStreamSystem();

            console.log('âœ… Stream system fixed');
        };

        // ðŸŽ¯ Manual Test Function
        window.manualTest = function() {
            console.log('ðŸ§ª Manual test - creating test player data...');

            // Try to fill form if exists
            const nameInput = document.getElementById('arabicName');
            const currentClubInput = document.getElementById('currentClub');
            const targetClubInput = document.getElementById('targetClub');

            if (nameInput) nameInput.value = 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­';
            if (currentClubInput) currentClubInput.value = 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„';
            if (targetClubInput) targetClubInput.value = 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯';

            console.log('âœ… Test data filled');

            // Test showing player
            setTimeout(() => {
                showPlayerInSimpleStream();
            }, 500);
        };

        console.log('ðŸŽ¬ Ultimate Studio V4 Simple Streaming System loaded');
        console.log('ðŸ” Use window.debugStream() for debugging info');
        console.log('ðŸ§ª Use window.testStreamSystem() to test all functions');
        console.log('ðŸ”§ Use window.fixStreamSystem() if there are issues');
        console.log('ðŸ‘¤ Use window.manualTest() to test with sample player data');

        // ðŸ”§ Auto-fix system for stream issues
        function autoFixStreamSystem() {
            console.log('ðŸ”§ Auto-fixing stream system...');

            // Ensure global variables are defined
            if (typeof window.isStreamingActive === 'undefined') {
                window.isStreamingActive = false;
                console.log('âœ… Fixed: isStreamingActive defined');
            }

            if (typeof window.streamUrl === 'undefined') {
                window.streamUrl = 'http://localhost:8201/ultimate-stream-overlay';
                console.log('âœ… Fixed: streamUrl defined');
            }

            // Ensure functions are accessible globally
            if (typeof window.startSimpleStream === 'undefined') {
                window.startSimpleStream = startSimpleStream;
                console.log('âœ… Fixed: startSimpleStream made global');
            }

            if (typeof window.showPlayerInSimpleStream === 'undefined') {
                window.showPlayerInSimpleStream = showPlayerInSimpleStream;
                console.log('âœ… Fixed: showPlayerInSimpleStream made global');
            }

            if (typeof window.getCurrentPlayerData === 'undefined') {
                window.getCurrentPlayerData = getCurrentPlayerData;
                console.log('âœ… Fixed: getCurrentPlayerData made global');
            }

            if (typeof window.openSimpleStream === 'undefined') {
                window.openSimpleStream = openSimpleStream;
                console.log('âœ… Fixed: openSimpleStream made global');
            }

            if (typeof window.copySimpleStreamUrl === 'undefined') {
                window.copySimpleStreamUrl = copySimpleStreamUrl;
                console.log('âœ… Fixed: copySimpleStreamUrl made global');
            }

            // Update UI to current state
            setTimeout(() => {
                updateStreamUI();
                console.log('âœ… Fixed: UI updated');
            }, 500);

            console.log('ðŸŽ‰ Stream system auto-fix completed!');
        }

        // Run auto-fix
        autoFixStreamSystem();

        // Make auto-fix available globally
        window.autoFixStreamSystem = autoFixStreamSystem;

        console.log('ðŸ”§ Auto-fix system ready - use window.autoFixStreamSystem() if needed');

        // ðŸŽ¬ NEW INTEGRATED STREAMING SYSTEM - Professional & Simple
        console.log('ðŸš€ Loading New Integrated Streaming System...');

        // Global variables for new system - Auto-start enabled
        let newStreamActive = true; // Auto-start streaming
        const newStreamUrl = 'http://localhost:8201/stream-overlay-simple';

        // Toggle new stream
        function toggleNewStream() {
            console.log('ðŸŽ¬ toggleNewStream called');

            newStreamActive = !newStreamActive;

            // Store state in localStorage
            localStorage.setItem('streamActive', newStreamActive.toString());
            localStorage.setItem('streamStateChanged', Date.now().toString());

            // Update UI
            updateNewStreamUI();

            // Show notification
            const message = newStreamActive ? 'ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, newStreamActive ? 'success' : 'info');
            } else {
                alert(message);
            }

            console.log('âœ… New stream state:', newStreamActive);
        }

        // Show player in new stream - Auto-enabled
        function showPlayerInNewStream() {
            console.log('ðŸŽ¬ showPlayerInNewStream called - Auto-streaming enabled');

            // Auto-enable streaming if not active
            if (!newStreamActive) {
                newStreamActive = true;
                updateNewStreamUI();
                console.log('âœ… Auto-enabled streaming for player display');
            }

            // Get current player data
            const playerData = getNewPlayerData();

            if (!playerData.playerName || !playerData.playerName.trim()) {
                const message = 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£ÙˆÙ„Ø§Ù‹';
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'warning');
                } else {
                    alert(message);
                }
                return;
            }

            // Store player data for stream
            localStorage.setItem('currentPlayer', JSON.stringify(playerData));
            localStorage.setItem('playerChanged', Date.now().toString());

            const message = `âœ… ØªÙ… Ø¹Ø±Ø¶ ${playerData.playerName} ÙÙŠ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±`;
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, 'success');
            } else {
                alert(message);
            }

            console.log('âœ… Player shown in new stream:', playerData);
        }

        // Hide player from new stream
        function hidePlayerFromNewStream() {
            console.log('ðŸŽ¬ hidePlayerFromNewStream called');

            localStorage.removeItem('currentPlayer');
            localStorage.setItem('playerChanged', Date.now().toString());

            const message = 'âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„Ø¨Ø«';
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, 'info');
            } else {
                alert(message);
            }

            console.log('âœ… Player hidden from new stream');
        }

        // Get new player data
        function getNewPlayerData() {
            // Try to get from Ultimate Studio first
            if (window.ultimateStudio && window.ultimateStudio.currentPlayer) {
                const player = window.ultimateStudio.currentPlayer;
                return {
                    playerName: player.arabicName || player.name || '',
                    currentClub: player.currentClub || '',
                    targetClub: player.targetClub || '',
                    probability: player.probability || '75',
                    transferFee: player.transferFee || '',
                    timestamp: Date.now()
                };
            }

            // Fallback to form inputs
            const possibleIds = {
                playerName: ['arabicName', 'playerName', 'name'],
                currentClub: ['currentClub', 'fromClub', 'club1'],
                targetClub: ['targetClub', 'toClub', 'club2'],
                probability: ['probability', 'transferProbability', 'prob'],
                transferFee: ['transferFee', 'fee', 'price']
            };

            const playerData = { timestamp: Date.now() };

            for (const [field, ids] of Object.entries(possibleIds)) {
                let value = '';
                for (const id of ids) {
                    const element = document.getElementById(id);
                    if (element && element.value && element.value.trim()) {
                        value = element.value.trim();
                        break;
                    }
                }
                playerData[field] = value;
            }

            // Set defaults if empty
            if (!playerData.playerName) playerData.playerName = '';
            if (!playerData.currentClub) playerData.currentClub = '';
            if (!playerData.targetClub) playerData.targetClub = '';
            if (!playerData.probability) playerData.probability = '75';
            if (!playerData.transferFee) playerData.transferFee = '';

            return playerData;
        }

        // Update new stream UI
        function updateNewStreamUI() {
            const indicator = document.getElementById('newStreamStatus');
            const text = document.getElementById('newStreamText');
            const button = document.getElementById('newStreamBtn');

            if (indicator && text && button) {
                if (newStreamActive) {
                    indicator.classList.add('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± <span style="color: #ff0000;">ðŸ”´</span>';
                    button.innerHTML = '<i class="fas fa-stop"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-danger-ultimate';
                } else {
                    indicator.classList.remove('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…ØªÙˆÙ‚Ù <span style="color: #888;">âš«</span>';
                    button.innerHTML = '<i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-success-ultimate';
                }
            }
        }

        // Open new stream
        function openNewStream() {
            window.open(newStreamUrl, 'NewStreamOverlay', 'width=1920,height=1080,scrollbars=no,resizable=yes');
            console.log('âœ… New stream window opened');
        }

        // Open control panel
        function openControlPanel() {
            window.open('/stream-control-panel', 'StreamControlPanel', 'width=900,height=800,scrollbars=yes,resizable=yes');
            console.log('âœ… Control panel opened');
        }

        // Copy new stream URL
        function copyNewStreamUrl() {
            navigator.clipboard.writeText(newStreamUrl).then(() => {
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø«', 'success');
                } else {
                    alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø«');
                }
            }).catch(() => {
                prompt('Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:', newStreamUrl);
            });
        }

        // Clear new stream
        function clearNewStream() {
            localStorage.removeItem('currentPlayer');
            localStorage.removeItem('streamActive');
            localStorage.setItem('streamCleared', Date.now().toString());

            newStreamActive = false;
            updateNewStreamUI();

            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨Ø«', 'info');
            } else {
                alert('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨Ø«');
            }

            console.log('âœ… New stream cleared');
        }

        // Test new stream
        function testNewStream() {
            console.log('ðŸ§ª Testing new stream system...');

            // Fill test data
            const testData = {
                playerName: 'Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­',
                currentClub: 'Ù„ÙŠÙØ±Ø¨ÙˆÙ„',
                targetClub: 'Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯',
                probability: '85',
                transferFee: '100 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ',
                timestamp: Date.now()
            };

            // Store test data
            localStorage.setItem('currentPlayer', JSON.stringify(testData));
            localStorage.setItem('streamActive', 'true');
            localStorage.setItem('playerChanged', Date.now().toString());

            newStreamActive = true;
            updateNewStreamUI();

            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± - Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­', 'success');
            } else {
                alert('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± - Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­');
            }

            console.log('âœ… Test data loaded:', testData);
        }

        // Auto-show in stream when creating card
        function checkAutoShowInNewStream() {
            const autoShow = document.getElementById('autoShowInNewStream');
            if (autoShow && autoShow.checked && newStreamActive) {
                setTimeout(() => {
                    showPlayerInNewStream();
                }, 500);
            }
        }

        // Initialize new stream system
        function initNewStreamSystem() {
            // Load saved state
            const savedState = localStorage.getItem('streamActive') === 'true';
            if (savedState) {
                newStreamActive = savedState;
            }

            // Update UI
            updateNewStreamUI();

            console.log('âœ… New stream system initialized');
        }

        // Make functions globally available
        window.toggleNewStream = toggleNewStream;
        window.showPlayerInNewStream = showPlayerInNewStream;
        window.hidePlayerFromNewStream = hidePlayerFromNewStream;
        window.openNewStream = openNewStream;
        window.openControlPanel = openControlPanel;
        window.copyNewStreamUrl = copyNewStreamUrl;
        window.clearNewStream = clearNewStream;
        window.testNewStream = testNewStream;
        window.getNewPlayerData = getNewPlayerData;
        window.checkAutoShowInNewStream = checkAutoShowInNewStream;

        // Initialize new system with auto-start
        initNewStreamSystem();

        // Auto-start streaming after initialization
        setTimeout(() => {
            updateNewStreamUI();
            console.log('ðŸ”´ Auto-started streaming system - Professional Mode');

            // Show auto-start notification
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('ðŸ”´ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø¬Ø§Ù‡Ø² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Professional Mode', 'success');
            }
        }, 1500);

        console.log('ðŸŽ‰ New Integrated Streaming System Ready!');
        console.log('ðŸŽ® Use openControlPanel() for advanced control');
        console.log('ðŸŽ¬ Use testNewStream() for quick testing');

        // ðŸŽ¬ DIRECT STREAM SYSTEM - Same design as Ultimate Studio V4
        console.log('ðŸš€ Loading Direct Stream System...');

        // Global variables for direct stream - Auto-start enabled
        window.directStreamActive = true; // Auto-start streaming
        window.directStreamUrl = 'http://localhost:8201/stream-clean';

        // Toggle direct stream
        window.toggleDirectStream = function() {
            console.log('ðŸŽ¬ toggleDirectStream called');

            window.directStreamActive = !window.directStreamActive;

            // Store state in localStorage
            localStorage.setItem('directStreamActive', window.directStreamActive.toString());
            localStorage.setItem('directStreamStateChanged', Date.now().toString());

            // Update UI
            window.updateDirectStreamUI();

            // Show notification
            const message = window.directStreamActive ? 'ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±';
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, window.directStreamActive ? 'success' : 'info');
            } else {
                alert(message);
            }

            console.log('âœ… Direct stream state:', window.directStreamActive);
        };

        // Send current content to direct stream - Auto-enabled (ENHANCED VERSION 2)
        window.sendToDirectStreamV2 = function() {
            console.log('ðŸŽ¬ sendToDirectStreamV2 called - Auto-streaming enabled');

            // Auto-enable streaming if not active
            if (!window.directStreamActive) {
                window.directStreamActive = true;
                localStorage.setItem('directStreamActive', 'true');
                window.updateDirectStreamUI();
                console.log('âœ… Auto-enabled direct streaming for content display');
            }

            // Get current content from previewContent
            const previewContent = document.getElementById('previewContent');
            if (!previewContent || !previewContent.innerHTML.trim()) {
                const message = 'âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡. ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹';
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification(message, 'warning');
                } else {
                    alert(message);
                }
                return;
            }

            // Apply current size settings to content before sending
            let contentHtml = previewContent.innerHTML;
            contentHtml = window.applyCurrentSizesToContent(contentHtml);

            // Prepare content data with enhanced metadata
            const contentData = {
                html: contentHtml,
                timestamp: Date.now(),
                source: 'Ultimate Studio V4 - V2',
                id: 'content_v2_' + Date.now(),
                version: '2.1'
            };

            // Store content for direct stream (multiple methods)
            localStorage.setItem('directStreamActive', 'true');
            localStorage.setItem('directStreamContent', JSON.stringify(contentData));
            localStorage.setItem('directStreamContentChanged', Date.now().toString());
            localStorage.setItem('directStreamLastUpdate', Date.now().toString());

            // ðŸ“ NEW: Send to OBS File System as well
            window.sendToOBSFileSystem(contentData);

            // Send to server API as well
            fetch('/api/stream-data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Cache-Control': 'no-cache'
                },
                body: JSON.stringify({
                    active: true,
                    content: contentData
                })
            }).then(response => response.json())
              .then(data => {
                  console.log('ðŸ“¡ Content sent to server (V2):', data);
              })
              .catch(error => {
                  console.log('ðŸ“± Server unavailable, using localStorage only (V2)');
              });

            // Trigger events for cross-tab communication
            setTimeout(() => {
                window.dispatchEvent(new StorageEvent('storage', {
                    key: 'directStreamContent',
                    newValue: JSON.stringify(contentData),
                    storageArea: localStorage
                }));

                window.dispatchEvent(new CustomEvent('directStreamUpdate', {
                    detail: contentData
                }));
            }, 50);

            const message = 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±';
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, 'success');
            } else {
                alert(message);
            }

            console.log('âœ… Content sent to direct stream (V2):', contentData);
        };

        // Use the enhanced version as the main function
        if (typeof window.sendToDirectStream !== 'function') {
            window.sendToDirectStream = window.sendToDirectStreamV2;
        }

        // Hide content from direct stream
        window.hideFromDirectStream = function() {
            console.log('ðŸŽ¬ hideFromDirectStream called');

            localStorage.removeItem('directStreamContent');
            localStorage.setItem('directStreamContentChanged', Date.now().toString());

            const message = 'âœ… ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ù† Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±';
            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification(message, 'info');
            } else {
                alert(message);
            }

            console.log('âœ… Content hidden from direct stream');
        };

        // Open direct stream window
        window.openDirectStream = function() {
            window.open(window.directStreamUrl, 'DirectStreamView', 'width=1920,height=1080,scrollbars=no,resizable=yes');
            console.log('âœ… Direct stream window opened');
        };

        // Copy direct stream URL
        window.copyDirectStreamUrl = function() {
            navigator.clipboard.writeText(window.directStreamUrl).then(() => {
                if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                    window.ultimateStudio.showNotification('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'success');
                } else {
                    alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
                }
            }).catch(() => {
                prompt('Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·:', window.directStreamUrl);
            });
        };

        // Clear direct stream
        window.clearDirectStream = function() {
            localStorage.removeItem('directStreamContent');
            localStorage.removeItem('directStreamActive');
            localStorage.setItem('directStreamCleared', Date.now().toString());

            window.directStreamActive = false;
            window.updateDirectStreamUI();

            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'info');
            } else {
                alert('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            }

            console.log('âœ… Direct stream cleared');
        };

        // Test direct stream
        window.testDirectStream = function() {
            console.log('ðŸ§ª Testing direct stream system...');

            // Start stream
            window.directStreamActive = true;
            localStorage.setItem('directStreamActive', 'true');
            window.updateDirectStreamUI();

            // Send current content or create test content
            const previewContent = document.getElementById('previewContent');
            if (previewContent && previewContent.innerHTML.trim()) {
                // Send existing content
                window.sendToDirectStream();
            } else {
                // Create test content
                const testContent = {
                    html: `
                        <div class="fifa-card" style="
                            background: linear-gradient(135deg, #1e3c72, #2a5298);
                            border: 3px solid transparent;
                            border-radius: 25px;
                            padding: 40px;
                            color: white;
                            text-align: center;
                            width: 450px;
                            min-height: 550px;
                        ">
                            <h2 style="font-size: 36px; margin-bottom: 20px;">Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­</h2>
                            <div style="margin: 30px 0;">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">Ù„ÙŠÙØ±Ø¨ÙˆÙ„</div>
                                    <div style="font-size: 24px;">â†’</div>
                                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯</div>
                                </div>
                            </div>
                            <div style="margin: 40px 0;">
                                <div style="font-size: 48px; font-weight: bold; color: #10b981;">85%</div>
                                <div style="font-size: 18px; opacity: 0.8;">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</div>
                            </div>
                            <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin-top: 20px;">
                                Ø±Ø³ÙˆÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„: 100 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ
                            </div>
                        </div>
                    `,
                    timestamp: Date.now(),
                    source: 'Test Data'
                };

                localStorage.setItem('directStreamContent', JSON.stringify(testContent));
                localStorage.setItem('directStreamContentChanged', Date.now().toString());
            }

            if (window.ultimateStudio && window.ultimateStudio.showNotification) {
                window.ultimateStudio.showNotification('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', 'success');
            } else {
                alert('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
            }

            console.log('âœ… Direct stream test completed');
        };

        // Update direct stream UI - Fixed element IDs
        window.updateDirectStreamUI = function() {
            const indicator = document.getElementById('newStreamStatus');
            const text = document.getElementById('newStreamText');
            const button = document.getElementById('newStreamBtn');

            console.log('ðŸ”„ Updating UI - Elements found:', {
                indicator: !!indicator,
                text: !!text,
                button: !!button,
                active: window.directStreamActive
            });

            if (indicator && text && button) {
                if (window.directStreamActive) {
                    indicator.classList.add('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± <span style="color: #ff0000;">ðŸ”´</span>';
                    button.innerHTML = '<i class="fas fa-stop"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-danger-ultimate';
                    button.setAttribute('onclick', 'toggleDirectStream()');
                } else {
                    indicator.classList.remove('live');
                    text.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…ØªÙˆÙ‚Ù <span style="color: #888;">âš«</span>';
                    button.innerHTML = '<i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø«';
                    button.className = 'ultimate-btn btn-success-ultimate';
                    button.setAttribute('onclick', 'toggleDirectStream()');
                }
                console.log('âœ… UI updated successfully');
            } else {
                console.error('âŒ UI elements not found - trying alternative IDs...');

                // Try alternative element IDs as fallback
                const altIndicator = document.querySelector('.stream-indicator');
                const altText = document.querySelector('#newStreamText, .stream-info-display span');
                const altButton = document.querySelector('#newStreamBtn, .ultimate-btn');

                console.log('ðŸ”„ Alternative elements found:', {
                    altIndicator: !!altIndicator,
                    altText: !!altText,
                    altButton: !!altButton
                });

                if (altIndicator && altText && altButton) {
                    if (window.directStreamActive) {
                        altIndicator.classList.add('live');
                        altText.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± <span style="color: #ff0000;">ðŸ”´</span>';
                        altButton.innerHTML = '<i class="fas fa-stop"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø«';
                        altButton.className = 'ultimate-btn btn-danger-ultimate';
                        altButton.setAttribute('onclick', 'toggleDirectStream()');
                    } else {
                        altIndicator.classList.remove('live');
                        altText.innerHTML = 'Ø§Ù„Ø¨Ø« Ù…ØªÙˆÙ‚Ù <span style="color: #888;">âš«</span>';
                        altButton.innerHTML = '<i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø«';
                        altButton.className = 'ultimate-btn btn-success-ultimate';
                        altButton.setAttribute('onclick', 'toggleDirectStream()');
                    }
                    console.log('âœ… UI updated using alternative elements');
                } else {
                    console.error('âŒ No UI elements found at all');
                }
            }
        };

        // Auto-send to direct stream when creating card - ENHANCED VERSION (Duplicate removed, using main function above)

        // Initialize direct stream system with auto-start
        window.initDirectStreamSystem = function() {
            console.log('ðŸš€ Initializing direct stream system with auto-start...');

            // Auto-start streaming (override saved state)
            window.directStreamActive = true;
            localStorage.setItem('directStreamActive', 'true');
            console.log('ðŸ”´ Auto-started direct streaming system');

            // Wait for DOM to be ready
            setTimeout(() => {
                // Update UI
                window.updateDirectStreamUI();

                // Update button onclick to use direct stream
                const streamBtn = document.getElementById('newStreamBtn');
                if (streamBtn) {
                    streamBtn.setAttribute('onclick', 'toggleDirectStream()');
                    console.log('ðŸ”— Button onclick updated');
                } else {
                    console.error('âŒ Stream button not found');
                }

                console.log('âœ… Direct stream system initialized');
            }, 1000);
        };

        // Initialize direct stream system immediately
        window.initDirectStreamSystem();

        console.log('ðŸŽ‰ Direct Stream System Ready!');
        console.log('ðŸŽ¬ Use testDirectStream() for quick testing');
        console.log('ðŸ“º Stream URL: ' + directStreamUrl);

        // Additional initialization when DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸ“„ DOM loaded - reinitializing direct stream system');
            setTimeout(() => {
                window.initDirectStreamSystem();
            }, 500);
        });

        // Also initialize when window loads
        window.addEventListener('load', function() {
            console.log('ðŸŒ Window loaded - final initialization');
            setTimeout(() => {
                window.initDirectStreamSystem();

                // Test if functions are available
                console.log('ðŸ§ª Testing function availability:');
                console.log('- toggleDirectStream:', typeof window.toggleDirectStream);
                console.log('- sendToDirectStream:', typeof window.sendToDirectStream);
                console.log('- openDirectStream:', typeof window.openDirectStream);
                console.log('- testDirectStream:', typeof window.testDirectStream);

                // Show success message
                if (typeof window.toggleDirectStream === 'function') {
                    console.log('ðŸŽ‰ Ø¬Ù…ÙŠØ¹ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ø­Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!');
                } else {
                    console.error('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±');
                }
            }, 2000);
        });
    </script>
</body>
</html>
