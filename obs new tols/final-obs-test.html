<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</title>
    
    <!-- Ù…Ù†Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #94a3b8;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .test-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
        }

        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }

        .test-title {
            font-size: 1.5rem;
            color: #ffd700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status {
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-weight: bold;
            margin: 0.5rem 0;
            text-align: center;
        }

        .status.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid #10b981;
        }

        .status.warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }

        .status.error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid #ef4444;
        }

        .status.info {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            border: 1px solid #3b82f6;
        }

        .test-result {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border-left: 4px solid #ffd700;
            max-height: 200px;
            overflow-y: auto;
        }

        .button {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin: 0.5rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        .button.success {
            background: linear-gradient(45deg, #10b981, #34d399);
            color: white;
        }

        .button.danger {
            background: linear-gradient(45deg, #ef4444, #f87171);
            color: white;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            border: 2px solid rgba(255, 215, 0, 0.5);
            margin-top: 3rem;
        }

        .summary-title {
            font-size: 2rem;
            color: #ffd700;
            margin-bottom: 1rem;
        }

        .summary-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
            margin-left: 0.5rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .club-count {
            font-size: 3rem;
            font-weight: bold;
            color: #ffd700;
            margin: 1rem 0;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h1>
            <p class="subtitle">ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø¹Ø±Ø¶ 3 Ø£Ù†Ø¯ÙŠØ© ÙÙ‚Ø· ÙÙŠ OBS</p>
            <div class="live-indicator"></div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%"></div>
        </div>

        <!-- Ø´Ø¨ÙƒØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
        <div class="test-grid">
            <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ¦Ø© -->
            <div class="test-card">
                <h2 class="test-title">ğŸŒ ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ¦Ø©</h2>
                <div id="environmentResult" class="test-result">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...
                </div>
                <div id="environmentStatus" class="status info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ -->
            <div class="test-card">
                <h2 class="test-title">ğŸŒŸ Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h2>
                <div id="universalResult" class="test-result">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...
                </div>
                <div id="universalStatus" class="status info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
            <div class="test-card">
                <h2 class="test-title">ğŸ“Š ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                <div id="dataResult" class="test-result">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...
                </div>
                <div id="dataStatus" class="status info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø± OBS -->
            <div class="test-card">
                <h2 class="test-title">ğŸ¥ ÙØ­Øµ OBS</h2>
                <div id="obsResult" class="test-result">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...
                </div>
                <div id="obsStatus" class="status info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
            </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div style="text-align: center; margin: 2rem 0;">
            <button class="button" onclick="runAllTests()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            <button class="button success" onclick="applyFinalFix()">ğŸ”§ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
            <button class="button" onclick="openMainPage()">ğŸ“± ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <button class="button danger" onclick="resetEverything()">ğŸ—‘ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø©</button>
        </div>

        <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
        <div class="summary-card">
            <h2 class="summary-title">ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
            <div class="club-count" id="clubCount">0</div>
            <p class="summary-text" id="summaryText">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù…...</p>
            <div id="finalStatus" class="status info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
        </div>
    </div>

    <!-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© -->
    <script src="universal-obs-solution.js"></script>
    
    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        let testResults = {
            environment: false,
            universal: false,
            data: false,
            obs: false
        };

        let totalClubs = 0;

        // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ...');
            
            setTimeout(() => {
                runAllTests();
            }, 2000);
        });

        // ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
        async function runAllTests() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...');
            updateProgress(0);

            try {
                // 1. ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ¦Ø©
                await testEnvironment();
                updateProgress(25);

                // 2. ÙØ­Øµ Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
                await testUniversalSolution();
                updateProgress(50);

                // 3. ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                await testData();
                updateProgress(75);

                // 4. ÙØ­Øµ OBS
                await testOBS();
                updateProgress(100);

                // 5. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                analyzeResults();

                console.log('âœ… ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª');

            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:', error);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
        function updateProgress(percentage) {
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ¦Ø©
        async function testEnvironment() {
            const resultElement = document.getElementById('environmentResult');
            const statusElement = document.getElementById('environmentStatus');

            try {
                const userAgent = navigator.userAgent;
                const isOBS = userAgent.includes('obs') || userAgent.includes('OBS') || userAgent.includes('CEF');
                const isChrome = userAgent.includes('Chrome');

                let result = `<strong>User Agent:</strong><br>${userAgent}<br><br>`;
                result += `<strong>Ø§Ù„Ø¨ÙŠØ¦Ø©:</strong> ${isOBS ? 'OBS Browser Source' : 'Ù…ØªØµÙØ­ Ø¹Ø§Ø¯ÙŠ'}<br>`;
                result += `<strong>Ø§Ù„Ù…ØªØµÙØ­:</strong> ${isChrome ? 'Chrome' : 'Ø¢Ø®Ø±'}<br>`;

                // ÙØ­Øµ Ø§Ù„Ù…ÙŠØ²Ø§Øª
                const features = {
                    'localStorage': typeof Storage !== 'undefined',
                    'fetch': typeof fetch !== 'undefined',
                    'Promise': typeof Promise !== 'undefined'
                };

                result += '<br><strong>Ø§Ù„Ù…ÙŠØ²Ø§Øª:</strong><br>';
                for (const [feature, supported] of Object.entries(features)) {
                    result += `${supported ? 'âœ…' : 'âŒ'} ${feature}<br>`;
                }

                resultElement.innerHTML = result;

                if (Object.values(features).every(f => f)) {
                    statusElement.className = 'status success';
                    statusElement.textContent = 'âœ… Ø§Ù„Ø¨ÙŠØ¦Ø© Ù…ØªÙˆØ§ÙÙ‚Ø©';
                    testResults.environment = true;
                } else {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Ø§Ù„Ø¨ÙŠØ¦Ø© ØºÙŠØ± Ù…ØªÙˆØ§ÙÙ‚Ø©';
                    testResults.environment = false;
                }

            } catch (error) {
                resultElement.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                statusElement.className = 'status error';
                statusElement.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„ÙØ­Øµ';
                testResults.environment = false;
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
        async function testUniversalSolution() {
            const resultElement = document.getElementById('universalResult');
            const statusElement = document.getElementById('universalStatus');

            try {
                let result = '';

                // ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù†Ø¸Ø§Ù…
                if (window.universalOBSSolution) {
                    result += 'âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø­Ù…Ù„<br>';
                    
                    if (window.universalOBSSolution.isInitialized) {
                        result += 'âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØªÙ‡ÙŠØ£<br>';
                        
                        // ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                        const status = window.universalOBSSolution.getSystemStatus();
                        result += `<br><strong>Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:</strong><br>`;
                        result += `Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©: ${status.realDataCount} Ù†Ø§Ø¯ÙŠ<br>`;
                        result += `Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©: ${status.oldDataCount} Ù†Ø§Ø¯ÙŠ<br>`;
                        result += `Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ${status.fallbackDataCount} Ù†Ø§Ø¯ÙŠ<br>`;
                        result += `Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©: ${status.isHealthy ? 'âœ… Ø¬ÙŠØ¯' : 'âŒ Ø³ÙŠØ¡'}<br>`;

                        if (status.isHealthy) {
                            statusElement.className = 'status success';
                            statusElement.textContent = 'âœ… Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ ÙŠØ¹Ù…Ù„';
                            testResults.universal = true;
                        } else {
                            statusElement.className = 'status warning';
                            statusElement.textContent = 'âš ï¸ Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†';
                            testResults.universal = false;
                        }

                    } else {
                        result += 'âŒ Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…ØªÙ‡ÙŠØ£<br>';
                        statusElement.className = 'status error';
                        statusElement.textContent = 'âŒ Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…ØªÙ‡ÙŠØ£';
                        testResults.universal = false;
                    }
                } else {
                    result += 'âŒ Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…Ø­Ù…Ù„<br>';
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…Ø­Ù…Ù„';
                    testResults.universal = false;
                }

                resultElement.innerHTML = result;

            } catch (error) {
                resultElement.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                statusElement.className = 'status error';
                statusElement.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„ÙØ­Øµ';
                testResults.universal = false;
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function testData() {
            const resultElement = document.getElementById('dataResult');
            const statusElement = document.getElementById('dataStatus');

            try {
                let result = '';
                let maxClubs = 0;

                // ÙØ­Øµ transfermarktRealData
                const realData = localStorage.getItem('transfermarktRealData');
                if (realData) {
                    try {
                        const data = JSON.parse(realData);
                        const clubCount = data.clubs ? data.clubs.length : 0;
                        result += `âœ… transfermarktRealData: ${clubCount} Ù†Ø§Ø¯ÙŠ<br>`;
                        maxClubs = Math.max(maxClubs, clubCount);
                    } catch (e) {
                        result += 'âŒ transfermarktRealData: Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ©<br>';
                    }
                } else {
                    result += 'âŒ transfermarktRealData: ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯<br>';
                }

                // ÙØ­Øµ transfermarktData
                const oldData = localStorage.getItem('transfermarktData');
                if (oldData) {
                    try {
                        const data = JSON.parse(oldData);
                        const clubCount = Array.isArray(data) ? data.length : 0;
                        result += `âœ… transfermarktData: ${clubCount} Ù†Ø§Ø¯ÙŠ<br>`;
                        maxClubs = Math.max(maxClubs, clubCount);
                    } catch (e) {
                        result += 'âŒ transfermarktData: Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ©<br>';
                    }
                } else {
                    result += 'âŒ transfermarktData: ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯<br>';
                }

                result += `<br><strong>Ø£Ù‚ØµÙ‰ Ø¹Ø¯Ø¯ Ø£Ù†Ø¯ÙŠØ©:</strong> ${maxClubs}<br>`;
                totalClubs = maxClubs;

                resultElement.innerHTML = result;

                if (maxClubs > 3) {
                    statusElement.className = 'status success';
                    statusElement.textContent = `âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬ÙŠØ¯Ø© (${maxClubs} Ù†Ø§Ø¯ÙŠ)`;
                    testResults.data = true;
                } else {
                    statusElement.className = 'status error';
                    statusElement.textContent = `âŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ù„ÙŠÙ„Ø© (${maxClubs} Ù†Ø§Ø¯ÙŠ)`;
                    testResults.data = false;
                }

            } catch (error) {
                resultElement.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                statusElement.className = 'status error';
                statusElement.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„ÙØ­Øµ';
                testResults.data = false;
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± OBS
        async function testOBS() {
            const resultElement = document.getElementById('obsResult');
            const statusElement = document.getElementById('obsStatus');

            try {
                const userAgent = navigator.userAgent;
                const isOBS = userAgent.includes('obs') || userAgent.includes('OBS') || userAgent.includes('CEF');

                let result = `<strong>Ø§ÙƒØªØ´Ø§Ù OBS:</strong> ${isOBS ? 'âœ… Ù†Ø¹Ù…' : 'âŒ Ù„Ø§'}<br>`;
                
                if (isOBS) {
                    result += '<br><strong>Ø®ØµØ§Ø¦Øµ OBS:</strong><br>';
                    result += `Ø§Ù„Ø¹Ø±Ø¶: ${window.innerWidth}x${window.innerHeight}<br>`;
                    result += `Ù†Ø³Ø¨Ø© Ø§Ù„Ø¨ÙƒØ³Ù„: ${window.devicePixelRatio}<br>`;
                    
                    // ÙØ­Øµ Ø§Ù„ØªÙˆØ§ÙÙ‚
                    const compatibility = {
                        'Cache API': 'caches' in window,
                        'Visibility API': typeof document.visibilityState !== 'undefined',
                        'BroadcastChannel': typeof BroadcastChannel !== 'undefined'
                    };

                    result += '<br><strong>Ø§Ù„ØªÙˆØ§ÙÙ‚:</strong><br>';
                    for (const [feature, supported] of Object.entries(compatibility)) {
                        result += `${supported ? 'âœ…' : 'âŒ'} ${feature}<br>`;
                    }

                    const compatibilityScore = Object.values(compatibility).filter(Boolean).length;
                    if (compatibilityScore >= 2) {
                        statusElement.className = 'status success';
                        statusElement.textContent = 'âœ… Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ OBS';
                        testResults.obs = true;
                    } else {
                        statusElement.className = 'status warning';
                        statusElement.textContent = 'âš ï¸ ØªÙˆØ§ÙÙ‚ Ù…Ø­Ø¯ÙˆØ¯ Ù…Ø¹ OBS';
                        testResults.obs = false;
                    }

                } else {
                    result += '<br>â„¹ï¸ Ù…ØªØµÙØ­ Ø¹Ø§Ø¯ÙŠ (Ù„ÙŠØ³ OBS)<br>';
                    statusElement.className = 'status info';
                    statusElement.textContent = 'â„¹ï¸ Ù…ØªØµÙØ­ Ø¹Ø§Ø¯ÙŠ';
                    testResults.obs = true; // Ù…ØªØµÙØ­ Ø¹Ø§Ø¯ÙŠ ÙŠØ¹ØªØ¨Ø± Ù…ØªÙˆØ§ÙÙ‚
                }

                resultElement.innerHTML = result;

            } catch (error) {
                resultElement.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                statusElement.className = 'status error';
                statusElement.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„ÙØ­Øµ';
                testResults.obs = false;
            }
        }

        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function analyzeResults() {
            const clubCountElement = document.getElementById('clubCount');
            const summaryTextElement = document.getElementById('summaryText');
            const finalStatusElement = document.getElementById('finalStatus');

            clubCountElement.textContent = totalClubs;

            const passedTests = Object.values(testResults).filter(Boolean).length;
            const totalTests = Object.keys(testResults).length;

            let summaryText = '';
            let statusClass = '';
            let statusText = '';

            if (totalClubs > 10 && passedTests === totalTests) {
                summaryText = `ğŸ‰ Ù…Ù…ØªØ§Ø²! Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø«Ø§Ù„ÙŠ Ù…Ø¹ ${totalClubs} Ù†Ø§Ø¯ÙŠ. Ù…Ø´ÙƒÙ„Ø© OBS ØªÙ… Ø­Ù„Ù‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„!`;
                statusClass = 'status success';
                statusText = 'âœ… Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø«Ø§Ù„ÙŠ';
            } else if (totalClubs > 3 && passedTests >= 3) {
                summaryText = `âœ… Ø¬ÙŠØ¯! Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ù…Ø¹ ${totalClubs} Ù†Ø§Ø¯ÙŠ. ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.`;
                statusClass = 'status success';
                statusText = 'âœ… Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù…Ø­Ù„ÙˆÙ„Ø©';
            } else if (totalClubs > 3) {
                summaryText = `âš ï¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬ÙŠØ¯Ø© (${totalClubs} Ù†Ø§Ø¯ÙŠ) Ù„ÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù….`;
                statusClass = 'status warning';
                statusText = 'âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†';
            } else {
                summaryText = `âŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù„Ø§ ØªØ²Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯Ø©! ÙŠØ¸Ù‡Ø± ${totalClubs} Ø£Ù†Ø¯ÙŠØ© ÙÙ‚Ø·.`;
                statusClass = 'status error';
                statusText = 'âŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù„Ù… ØªØ­Ù„';
            }

            summaryTextElement.textContent = summaryText;
            finalStatusElement.className = statusClass;
            finalStatusElement.textContent = statusText;

            console.log(`ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${passedTests}/${totalTests} Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­ØªØŒ ${totalClubs} Ù†Ø§Ø¯ÙŠ`);
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
        async function applyFinalFix() {
            console.log('ğŸ”§ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ...');
            
            try {
                if (window.universalOBSSolution) {
                    await window.universalOBSSolution.forceUpdate();
                    console.log('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ');
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                    setTimeout(() => {
                        runAllTests();
                    }, 2000);
                    
                    alert('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ! Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...');
                } else {
                    alert('âŒ Ø§Ù„Ø­Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ ØºÙŠØ± Ù…ØªØ§Ø­');
                }
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„:', error);
                alert('âŒ ÙØ´Ù„ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù„: ' + error.message);
            }
        }

        // ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function openMainPage() {
            window.open('transfermarkt-ultimate-display-fixed.html', '_blank');
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø©
        function resetEverything() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø´ÙŠØ¡ØŸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.')) {
                console.log('ğŸ—‘ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø©...');
                
                // Ù…Ø³Ø­ localStorage
                const keysToRemove = [
                    'transfermarktRealData',
                    'transfermarktData',
                    'transfermarktLastUpdate',
                    'clubManagerData',
                    'verifiedClubs',
                    'lastDataCheck'
                ];

                keysToRemove.forEach(key => {
                    localStorage.removeItem(key);
                });

                alert('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©.');
                window.location.reload();
            }
        }

        console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ');
    </script>
</body>
</html>
